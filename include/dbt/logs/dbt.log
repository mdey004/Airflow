[0m23:57:16.994071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f147233c260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1473cf58e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f147233c800>]}


============================== 23:57:17.000841 | 1eb0e253-acf8-4ac4-83b0-244919f5768f ==============================
[0m23:57:17.000841 [info ] [MainThread]: Running with dbt=1.6.18
[0m23:57:17.004696 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'debug': 'False', 'fail_fast': 'False', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_experimental_parser': 'False', 'warn_error': 'None', 'log_format': 'default', 'introspect': 'True', 'printer_width': '80', 'version_check': 'True', 'write_json': 'True', 'quiet': 'False', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt', 'indirect_selection': 'eager', 'target_path': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'log_cache_events': 'False', 'use_colors': 'True', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True'}
[0m23:57:17.161548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1eb0e253-acf8-4ac4-83b0-244919f5768f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1471fb7500>]}
[0m23:57:17.173125 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-2b4_amte'
[0m23:57:17.175237 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m23:57:17.250210 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m23:57:17.252854 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m23:57:17.305946 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m23:57:17.329649 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m23:57:25.661234 [info ] [MainThread]: Installed from version 1.2.0
[0m23:57:25.662956 [info ] [MainThread]: Updated version available: 1.3.0
[0m23:57:25.664844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1eb0e253-acf8-4ac4-83b0-244919f5768f', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14725ce120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f147246ca70>]}
[0m23:57:25.666635 [info ] [MainThread]: 
[0m23:57:25.668464 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m23:57:25.671941 [debug] [MainThread]: Command `dbt deps` succeeded at 23:57:25.671532 after 9.23 seconds
[0m23:57:25.673747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14725a2960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1473fefcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1476871730>]}
[0m23:57:25.675541 [debug] [MainThread]: Flushing usage events
[0m23:58:12.849957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78d40e71a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78d6001670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78d45dcbf0>]}


============================== 23:58:12.855266 | 0cb3370c-a00c-4892-bb2e-812338b5eb27 ==============================
[0m23:58:12.855266 [info ] [MainThread]: Running with dbt=1.6.18
[0m23:58:12.857438 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'version_check': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'introspect': 'True', 'log_cache_events': 'False', 'quiet': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'static_parser': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'log_format': 'default', 'no_print': 'None', 'use_colors': 'True'}
[0m23:58:14.361988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0cb3370c-a00c-4892-bb2e-812338b5eb27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78d238e960>]}
[0m23:58:14.407300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0cb3370c-a00c-4892-bb2e-812338b5eb27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78d2220da0>]}
[0m23:58:14.409728 [info ] [MainThread]: Registered adapter: bigquery=1.6.0
[0m23:58:14.512148 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m23:58:14.527019 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:58:14.528755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0cb3370c-a00c-4892-bb2e-812338b5eb27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78d22bfa10>]}
[0m23:58:19.773204 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.retail
[0m23:58:19.790747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0cb3370c-a00c-4892-bb2e-812338b5eb27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78d0661fd0>]}
[0m23:58:19.860483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0cb3370c-a00c-4892-bb2e-812338b5eb27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78d0660fb0>]}
[0m23:58:19.862437 [info ] [MainThread]: Found 4 models, 1 source, 0 exposures, 0 metrics, 509 macros, 0 groups, 0 semantic models
[0m23:58:19.864113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cb3370c-a00c-4892-bb2e-812338b5eb27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78d1fb4800>]}
[0m23:58:19.869900 [info ] [MainThread]: 
[0m23:58:19.872854 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:58:19.877860 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflowcrtn'
[0m23:58:19.880019 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:58:20.429113 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflowcrtn, now list_airflowcrtn_credit)
[0m23:58:20.431064 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:58:20.864135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cb3370c-a00c-4892-bb2e-812338b5eb27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78d23f21e0>]}
[0m23:58:20.867419 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:58:20.869649 [info ] [MainThread]: 
[0m23:58:20.878574 [debug] [Thread-1 (]: Began running node model.credit.dim_customer
[0m23:58:20.880962 [info ] [Thread-1 (]: 1 of 4 START sql view model credit.dim_customer ................................ [RUN]
[0m23:58:20.884347 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflowcrtn_credit, now model.credit.dim_customer)
[0m23:58:20.886313 [debug] [Thread-1 (]: Began compiling node model.credit.dim_customer
[0m23:58:20.918372 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_customer"
[0m23:58:20.963407 [debug] [Thread-1 (]: Timing info for model.credit.dim_customer (compile): 23:58:20.887854 => 23:58:20.962150
[0m23:58:20.965738 [debug] [Thread-1 (]: Began executing node model.credit.dim_customer
[0m23:58:21.060691 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_customer"
[0m23:58:21.113053 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:58:21.126379 [debug] [Thread-1 (]: On model.credit.dim_customer: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_customer"} */


  create or replace view `airflowcrtn`.`credit`.`dim_customer`
  OPTIONS()
  as SELECT DISTINCT
	    'Customer ID' as CustomerID,
	    'Years in Current Job' as YearsinCurrentJob,
         'Home Ownership' as HomeOwnership
	FROM `airflowcrtn`.`credit`.`raw_invoices`
	WHERE 'Customer ID' IS NOT NULL;


[0m23:58:21.893496 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:c05e3e90-b45b-4b8b-a54d-59227f842c7a&page=queryresults
[0m23:58:22.405362 [debug] [Thread-1 (]: Timing info for model.credit.dim_customer (execute): 23:58:20.967530 => 23:58:22.404311
[0m23:58:22.408623 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cb3370c-a00c-4892-bb2e-812338b5eb27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78d1fdbd70>]}
[0m23:58:22.410827 [info ] [Thread-1 (]: 1 of 4 OK created sql view model credit.dim_customer ........................... [[32mCREATE VIEW (0 processed)[0m in 1.53s]
[0m23:58:22.416925 [debug] [Thread-1 (]: Finished running node model.credit.dim_customer
[0m23:58:22.419539 [debug] [Thread-1 (]: Began running node model.credit.dim_loanstatus
[0m23:58:22.421816 [info ] [Thread-1 (]: 2 of 4 START sql view model credit.dim_loanstatus .............................. [RUN]
[0m23:58:22.424687 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_customer, now model.credit.dim_loanstatus)
[0m23:58:22.426918 [debug] [Thread-1 (]: Began compiling node model.credit.dim_loanstatus
[0m23:58:22.442375 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_loanstatus"
[0m23:58:22.463622 [debug] [Thread-1 (]: Timing info for model.credit.dim_loanstatus (compile): 23:58:22.428420 => 23:58:22.462731
[0m23:58:22.465830 [debug] [Thread-1 (]: Began executing node model.credit.dim_loanstatus
[0m23:58:22.476071 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_loanstatus"
[0m23:58:22.495536 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:58:22.506756 [debug] [Thread-1 (]: On model.credit.dim_loanstatus: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_loanstatus"} */


  create or replace view `airflowcrtn`.`credit`.`dim_loanstatus`
  OPTIONS()
  as SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast(Loan Status as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Term as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as LoanStatusID,
		'Loan Status' AS LoanStatus,
    'Term' AS Term

FROM `airflowcrtn`.`credit`.`raw_invoices`
WHERE 'Loan Status' IS NOT NULL
AND Term IS NOT NULL;


[0m23:58:22.448968 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:211d9e00-8af0-4db3-ab03-921cf749371b&page=queryresults
[0m23:58:22.451718 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword AS but got identifier "Status" at [7:40]; reason: invalidQuery, location: query, message: Syntax error: Expected keyword AS but got identifier "Status" at [7:40]')
[0m23:58:23.617279 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:8f11ca62-8dd6-4fe6-8002-0cc30d928b73&page=queryresults
[0m23:58:23.619976 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:8f11ca62-8dd6-4fe6-8002-0cc30d928b73&page=queryresults
[0m23:58:23.623065 [debug] [Thread-1 (]: Timing info for model.credit.dim_loanstatus (execute): 23:58:22.467353 => 23:58:23.622194
[0m23:58:23.637318 [debug] [Thread-1 (]: Database Error in model dim_loanstatus (models/transform/dim_loanstatus.sql)
  Syntax error: Expected keyword AS but got identifier "Status" at [7:40]
  compiled Code at target/run/credit/models/transform/dim_loanstatus.sql
[0m23:58:23.639918 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cb3370c-a00c-4892-bb2e-812338b5eb27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78d20f8aa0>]}
[0m23:58:23.642534 [error] [Thread-1 (]: 2 of 4 ERROR creating sql view model credit.dim_loanstatus ..................... [[31mERROR[0m in 1.22s]
[0m23:58:23.646301 [debug] [Thread-1 (]: Finished running node model.credit.dim_loanstatus
[0m23:58:23.648720 [debug] [Thread-1 (]: Began running node model.credit.dim_purpose
[0m23:58:23.652218 [info ] [Thread-1 (]: 3 of 4 START sql view model credit.dim_purpose ................................. [RUN]
[0m23:58:23.655045 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_loanstatus, now model.credit.dim_purpose)
[0m23:58:23.656889 [debug] [Thread-1 (]: Began compiling node model.credit.dim_purpose
[0m23:58:23.673900 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_purpose"
[0m23:58:23.696787 [debug] [Thread-1 (]: Timing info for model.credit.dim_purpose (compile): 23:58:23.658586 => 23:58:23.695612
[0m23:58:23.699074 [debug] [Thread-1 (]: Began executing node model.credit.dim_purpose
[0m23:58:23.709395 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_purpose"
[0m23:58:23.733173 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:58:23.744750 [debug] [Thread-1 (]: On model.credit.dim_purpose: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_purpose"} */


  create or replace view `airflowcrtn`.`credit`.`dim_purpose`
  OPTIONS()
  as SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast(Purpose as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as PurposeID,
		'Purpose ' AS Purpose 
FROM `airflowcrtn`.`credit`.`raw_invoices`
WHERE Purpose  IS NOT NULL;


[0m23:58:24.389403 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:9607e0fa-a3af-4ea7-bf87-93fe94f7417b&page=queryresults
[0m23:58:24.847408 [debug] [Thread-1 (]: Timing info for model.credit.dim_purpose (execute): 23:58:23.700844 => 23:58:24.846663
[0m23:58:24.851037 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cb3370c-a00c-4892-bb2e-812338b5eb27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78d0660800>]}
[0m23:58:24.853066 [info ] [Thread-1 (]: 3 of 4 OK created sql view model credit.dim_purpose ............................ [[32mCREATE VIEW (0 processed)[0m in 1.20s]
[0m23:58:24.857508 [debug] [Thread-1 (]: Finished running node model.credit.dim_purpose
[0m23:58:24.861701 [debug] [Thread-1 (]: Began running node model.credit.fact_invoices
[0m23:58:24.863704 [info ] [Thread-1 (]: 4 of 4 SKIP relation credit.fact_invoices ...................................... [[33mSKIP[0m]
[0m23:58:24.866021 [debug] [Thread-1 (]: Finished running node model.credit.fact_invoices
[0m23:58:24.873375 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:58:24.875516 [debug] [MainThread]: Connection 'model.credit.dim_purpose' was properly closed.
[0m23:58:24.877325 [info ] [MainThread]: 
[0m23:58:24.879130 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 5.01 seconds (5.01s).
[0m23:58:24.886381 [debug] [MainThread]: Command end result
[0m23:58:24.952919 [info ] [MainThread]: 
[0m23:58:24.955035 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:58:24.957086 [info ] [MainThread]: 
[0m23:58:24.958945 [error] [MainThread]:   Database Error in model dim_loanstatus (models/transform/dim_loanstatus.sql)
  Syntax error: Expected keyword AS but got identifier "Status" at [7:40]
  compiled Code at target/run/credit/models/transform/dim_loanstatus.sql
[0m23:58:24.961303 [info ] [MainThread]: 
[0m23:58:24.963975 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m23:58:24.967845 [debug] [MainThread]: Command `dbt run` failed at 23:58:24.967251 after 13.19 seconds
[0m23:58:24.969884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78d443fdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78d1fbf530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78d20fbc20>]}
[0m23:58:24.971650 [debug] [MainThread]: Flushing usage events
[0m00:00:27.031918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cc8bcd9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cc906b7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cc8e24bf0>]}


============================== 00:00:27.038071 | b6b16e86-4253-4469-9e31-16b996015e0f ==============================
[0m00:00:27.038071 [info ] [MainThread]: Running with dbt=1.6.18
[0m00:00:27.041041 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'quiet': 'False', 'cache_selected_only': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'log_format': 'default', 'version_check': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'use_colors': 'True', 'partial_parse': 'True', 'warn_error': 'None', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'fail_fast': 'False', 'no_print': 'None', 'write_json': 'True', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'introspect': 'True', 'printer_width': '80'}
[0m00:00:27.988439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6b16e86-4253-4469-9e31-16b996015e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cc6d0a360>]}
[0m00:00:28.037501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6b16e86-4253-4469-9e31-16b996015e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cc6d0a570>]}
[0m00:00:28.040044 [info ] [MainThread]: Registered adapter: bigquery=1.6.0
[0m00:00:28.148890 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m00:00:30.127594 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:00:30.129775 [debug] [MainThread]: Partial parsing: updated file: credit://models/transform/dim_loanstatus.sql
[0m00:00:30.338502 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.retail
[0m00:00:30.358646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6b16e86-4253-4469-9e31-16b996015e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cc6add430>]}
[0m00:00:30.426852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6b16e86-4253-4469-9e31-16b996015e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cc6b8c8c0>]}
[0m00:00:30.428849 [info ] [MainThread]: Found 4 models, 1 source, 0 exposures, 0 metrics, 509 macros, 0 groups, 0 semantic models
[0m00:00:30.430531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6b16e86-4253-4469-9e31-16b996015e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cc6af1010>]}
[0m00:00:30.435767 [info ] [MainThread]: 
[0m00:00:30.439238 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:00:30.443335 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflowcrtn'
[0m00:00:30.445290 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:00:30.950436 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflowcrtn, now list_airflowcrtn_credit)
[0m00:00:30.952531 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:00:31.366970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6b16e86-4253-4469-9e31-16b996015e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cc6dd8e30>]}
[0m00:00:31.370667 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:00:31.372932 [info ] [MainThread]: 
[0m00:00:31.382007 [debug] [Thread-1 (]: Began running node model.credit.dim_customer
[0m00:00:31.384450 [info ] [Thread-1 (]: 1 of 4 START sql view model credit.dim_customer ................................ [RUN]
[0m00:00:31.387425 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflowcrtn_credit, now model.credit.dim_customer)
[0m00:00:31.389202 [debug] [Thread-1 (]: Began compiling node model.credit.dim_customer
[0m00:00:31.420993 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_customer"
[0m00:00:31.441554 [debug] [Thread-1 (]: Timing info for model.credit.dim_customer (compile): 00:00:31.390965 => 00:00:31.440423
[0m00:00:31.443726 [debug] [Thread-1 (]: Began executing node model.credit.dim_customer
[0m00:00:31.541381 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_customer"
[0m00:00:31.561774 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:00:31.571299 [debug] [Thread-1 (]: On model.credit.dim_customer: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_customer"} */


  create or replace view `airflowcrtn`.`credit`.`dim_customer`
  OPTIONS()
  as SELECT DISTINCT
	    'Customer ID' as CustomerID,
	    'Years in Current Job' as YearsinCurrentJob,
         'Home Ownership' as HomeOwnership
	FROM `airflowcrtn`.`credit`.`raw_invoices`
	WHERE 'Customer ID' IS NOT NULL;


[0m00:00:32.356843 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:16fd2459-a2db-436a-ba7c-96d37c53d349&page=queryresults
[0m00:00:32.400463 [debug] [Thread-1 (]: Timing info for model.credit.dim_customer (execute): 00:00:31.445609 => 00:00:32.399279
[0m00:00:32.403830 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6b16e86-4253-4469-9e31-16b996015e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cc6bdbe60>]}
[0m00:00:32.406391 [info ] [Thread-1 (]: 1 of 4 OK created sql view model credit.dim_customer ........................... [[32mCREATE VIEW (0 processed)[0m in 1.02s]
[0m00:00:32.409870 [debug] [Thread-1 (]: Finished running node model.credit.dim_customer
[0m00:00:32.412202 [debug] [Thread-1 (]: Began running node model.credit.dim_loanstatus
[0m00:00:32.414189 [info ] [Thread-1 (]: 2 of 4 START sql view model credit.dim_loanstatus .............................. [RUN]
[0m00:00:32.417636 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_customer, now model.credit.dim_loanstatus)
[0m00:00:32.419304 [debug] [Thread-1 (]: Began compiling node model.credit.dim_loanstatus
[0m00:00:32.436939 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_loanstatus"
[0m00:00:32.458993 [debug] [Thread-1 (]: Timing info for model.credit.dim_loanstatus (compile): 00:00:32.421040 => 00:00:32.458026
[0m00:00:32.461229 [debug] [Thread-1 (]: Began executing node model.credit.dim_loanstatus
[0m00:00:32.472478 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_loanstatus"
[0m00:00:32.495286 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:00:32.506964 [debug] [Thread-1 (]: On model.credit.dim_loanstatus: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_loanstatus"} */


  create or replace view `airflowcrtn`.`credit`.`dim_loanstatus`
  OPTIONS()
  as SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast(Loan Status as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Term as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as LoanStatusID,
	'Loan Status' AS LoanStatus,
    'Term' AS Term

FROM `airflowcrtn`.`credit`.`raw_invoices`
WHERE 'Loan Status' IS NOT NULL;


[0m00:00:32.949830 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:9bc03c81-0cb0-414e-94ea-47a049b78beb&page=queryresults
[0m00:00:32.953052 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword AS but got identifier "Status" at [7:40]; reason: invalidQuery, location: query, message: Syntax error: Expected keyword AS but got identifier "Status" at [7:40]')
[0m00:00:33.638601 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:b3cf5085-ebb3-4589-8ddd-4a0778131062&page=queryresults
[0m00:00:33.641195 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:b3cf5085-ebb3-4589-8ddd-4a0778131062&page=queryresults
[0m00:00:33.645223 [debug] [Thread-1 (]: Timing info for model.credit.dim_loanstatus (execute): 00:00:32.462758 => 00:00:33.644396
[0m00:00:33.660823 [debug] [Thread-1 (]: Database Error in model dim_loanstatus (models/transform/dim_loanstatus.sql)
  Syntax error: Expected keyword AS but got identifier "Status" at [7:40]
  compiled Code at target/run/credit/models/transform/dim_loanstatus.sql
[0m00:00:33.663216 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6b16e86-4253-4469-9e31-16b996015e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cc6bdbe60>]}
[0m00:00:33.665602 [error] [Thread-1 (]: 2 of 4 ERROR creating sql view model credit.dim_loanstatus ..................... [[31mERROR[0m in 1.25s]
[0m00:00:33.670212 [debug] [Thread-1 (]: Finished running node model.credit.dim_loanstatus
[0m00:00:33.674653 [debug] [Thread-1 (]: Began running node model.credit.dim_purpose
[0m00:00:33.679994 [info ] [Thread-1 (]: 3 of 4 START sql view model credit.dim_purpose ................................. [RUN]
[0m00:00:33.683182 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_loanstatus, now model.credit.dim_purpose)
[0m00:00:33.685434 [debug] [Thread-1 (]: Began compiling node model.credit.dim_purpose
[0m00:00:33.701591 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_purpose"
[0m00:00:33.724210 [debug] [Thread-1 (]: Timing info for model.credit.dim_purpose (compile): 00:00:33.687161 => 00:00:33.723205
[0m00:00:33.726154 [debug] [Thread-1 (]: Began executing node model.credit.dim_purpose
[0m00:00:33.737168 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_purpose"
[0m00:00:33.760645 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:00:33.774194 [debug] [Thread-1 (]: On model.credit.dim_purpose: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_purpose"} */


  create or replace view `airflowcrtn`.`credit`.`dim_purpose`
  OPTIONS()
  as SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast(Purpose as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as PurposeID,
		'Purpose ' AS Purpose 
FROM `airflowcrtn`.`credit`.`raw_invoices`
WHERE Purpose  IS NOT NULL;


[0m00:00:34.451981 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:a4315022-0d3d-4b22-9247-a65c27f3cd15&page=queryresults
[0m00:00:34.944444 [debug] [Thread-1 (]: Timing info for model.credit.dim_purpose (execute): 00:00:33.728464 => 00:00:34.943838
[0m00:00:34.947427 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6b16e86-4253-4469-9e31-16b996015e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cc6c301a0>]}
[0m00:00:34.949641 [info ] [Thread-1 (]: 3 of 4 OK created sql view model credit.dim_purpose ............................ [[32mCREATE VIEW (0 processed)[0m in 1.27s]
[0m00:00:34.954681 [debug] [Thread-1 (]: Finished running node model.credit.dim_purpose
[0m00:00:34.962831 [debug] [Thread-1 (]: Began running node model.credit.fact_invoices
[0m00:00:34.964615 [info ] [Thread-1 (]: 4 of 4 SKIP relation credit.fact_invoices ...................................... [[33mSKIP[0m]
[0m00:00:34.966721 [debug] [Thread-1 (]: Finished running node model.credit.fact_invoices
[0m00:00:34.973596 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:00:34.975541 [debug] [MainThread]: Connection 'model.credit.dim_purpose' was properly closed.
[0m00:00:34.977472 [info ] [MainThread]: 
[0m00:00:34.979285 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 4.54 seconds (4.54s).
[0m00:00:34.991235 [debug] [MainThread]: Command end result
[0m00:00:35.073266 [info ] [MainThread]: 
[0m00:00:35.075583 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:00:35.077899 [info ] [MainThread]: 
[0m00:00:35.080399 [error] [MainThread]:   Database Error in model dim_loanstatus (models/transform/dim_loanstatus.sql)
  Syntax error: Expected keyword AS but got identifier "Status" at [7:40]
  compiled Code at target/run/credit/models/transform/dim_loanstatus.sql
[0m00:00:35.082545 [info ] [MainThread]: 
[0m00:00:35.084830 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m00:00:35.088735 [debug] [MainThread]: Command `dbt run` failed at 00:00:35.088253 after 9.13 seconds
[0m00:00:35.090920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cc8e89190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cc72ae4b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cc8bcf500>]}
[0m00:00:35.093474 [debug] [MainThread]: Flushing usage events
[0m00:06:45.838241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcda97de210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdaa862060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcda9acc260>]}


============================== 00:06:45.844149 | feef27ea-7a22-4dd0-b7ae-1838689c09c7 ==============================
[0m00:06:45.844149 [info ] [MainThread]: Running with dbt=1.6.18
[0m00:06:45.846868 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'static_parser': 'True', 'warn_error': 'None', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'log_format': 'default', 'no_print': 'None', 'printer_width': '80', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'log_path': '/usr/local/airflow/include/dbt/logs', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'write_json': 'True', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'quiet': 'False', 'introspect': 'True', 'use_colors': 'True'}
[0m00:06:47.279181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'feef27ea-7a22-4dd0-b7ae-1838689c09c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcda97de9f0>]}
[0m00:06:47.327508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'feef27ea-7a22-4dd0-b7ae-1838689c09c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcda7a17ad0>]}
[0m00:06:47.330097 [info ] [MainThread]: Registered adapter: bigquery=1.6.0
[0m00:06:47.436111 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m00:06:49.315001 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:06:49.317216 [debug] [MainThread]: Partial parsing: updated file: credit://models/transform/dim_loanstatus.sql
[0m00:06:49.518955 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.retail
[0m00:06:49.538021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'feef27ea-7a22-4dd0-b7ae-1838689c09c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcda76f0ce0>]}
[0m00:06:49.607771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'feef27ea-7a22-4dd0-b7ae-1838689c09c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcda77a4c20>]}
[0m00:06:49.609840 [info ] [MainThread]: Found 4 models, 1 source, 0 exposures, 0 metrics, 509 macros, 0 groups, 0 semantic models
[0m00:06:49.611711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'feef27ea-7a22-4dd0-b7ae-1838689c09c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcda77a4650>]}
[0m00:06:49.617545 [info ] [MainThread]: 
[0m00:06:49.620980 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:06:49.625822 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflowcrtn'
[0m00:06:49.627484 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:06:50.172206 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflowcrtn, now list_airflowcrtn_credit)
[0m00:06:50.173914 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:06:50.595421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'feef27ea-7a22-4dd0-b7ae-1838689c09c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcda7852570>]}
[0m00:06:50.598553 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:06:50.600223 [info ] [MainThread]: 
[0m00:06:50.609545 [debug] [Thread-1 (]: Began running node model.credit.dim_customer
[0m00:06:50.611684 [info ] [Thread-1 (]: 1 of 4 START sql view model credit.dim_customer ................................ [RUN]
[0m00:06:50.614906 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflowcrtn_credit, now model.credit.dim_customer)
[0m00:06:50.616746 [debug] [Thread-1 (]: Began compiling node model.credit.dim_customer
[0m00:06:50.655618 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_customer"
[0m00:06:50.680042 [debug] [Thread-1 (]: Timing info for model.credit.dim_customer (compile): 00:06:50.618292 => 00:06:50.679039
[0m00:06:50.682143 [debug] [Thread-1 (]: Began executing node model.credit.dim_customer
[0m00:06:50.771676 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_customer"
[0m00:06:50.795162 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:06:50.807223 [debug] [Thread-1 (]: On model.credit.dim_customer: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_customer"} */


  create or replace view `airflowcrtn`.`credit`.`dim_customer`
  OPTIONS()
  as SELECT DISTINCT
	    'Customer ID' as CustomerID,
	    'Years in Current Job' as YearsinCurrentJob,
         'Home Ownership' as HomeOwnership
	FROM `airflowcrtn`.`credit`.`raw_invoices`
	WHERE 'Customer ID' IS NOT NULL;


[0m00:06:51.545683 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:e2a636bc-4364-4e75-b988-89092f5171a3&page=queryresults
[0m00:06:52.037321 [debug] [Thread-1 (]: Timing info for model.credit.dim_customer (execute): 00:06:50.683865 => 00:06:52.036640
[0m00:06:52.040505 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'feef27ea-7a22-4dd0-b7ae-1838689c09c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcda77f79b0>]}
[0m00:06:52.042858 [info ] [Thread-1 (]: 1 of 4 OK created sql view model credit.dim_customer ........................... [[32mCREATE VIEW (0 processed)[0m in 1.43s]
[0m00:06:52.046643 [debug] [Thread-1 (]: Finished running node model.credit.dim_customer
[0m00:06:52.048987 [debug] [Thread-1 (]: Began running node model.credit.dim_loanstatus
[0m00:06:52.051911 [info ] [Thread-1 (]: 2 of 4 START sql view model credit.dim_loanstatus .............................. [RUN]
[0m00:06:52.055321 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_customer, now model.credit.dim_loanstatus)
[0m00:06:52.056941 [debug] [Thread-1 (]: Began compiling node model.credit.dim_loanstatus
[0m00:06:52.072071 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_loanstatus"
[0m00:06:52.091700 [debug] [Thread-1 (]: Timing info for model.credit.dim_loanstatus (compile): 00:06:52.058683 => 00:06:52.090425
[0m00:06:52.093696 [debug] [Thread-1 (]: Began executing node model.credit.dim_loanstatus
[0m00:06:52.105627 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_loanstatus"
[0m00:06:52.125184 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:06:52.135444 [debug] [Thread-1 (]: On model.credit.dim_loanstatus: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_loanstatus"} */


  create or replace view `airflowcrtn`.`credit`.`dim_loanstatus`
  OPTIONS()
  as SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast("Loan Status" as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Term as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as LoanStatusID,
	    "Loan Status" AS LoanStatus,
        'Term' AS Term

FROM `airflowcrtn`.`credit`.`raw_invoices`
WHERE "Loan Status" IS NOT NULL;


[0m00:06:52.860439 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:3be14421-4097-4c0d-a36b-cbcb3fb757b2&page=queryresults
[0m00:06:53.321675 [debug] [Thread-1 (]: Timing info for model.credit.dim_loanstatus (execute): 00:06:52.095001 => 00:06:53.320944
[0m00:06:53.324993 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'feef27ea-7a22-4dd0-b7ae-1838689c09c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcda77f7860>]}
[0m00:06:53.326935 [info ] [Thread-1 (]: 2 of 4 OK created sql view model credit.dim_loanstatus ......................... [[32mCREATE VIEW (0 processed)[0m in 1.27s]
[0m00:06:53.331842 [debug] [Thread-1 (]: Finished running node model.credit.dim_loanstatus
[0m00:06:53.334580 [debug] [Thread-1 (]: Began running node model.credit.dim_purpose
[0m00:06:53.336792 [info ] [Thread-1 (]: 3 of 4 START sql view model credit.dim_purpose ................................. [RUN]
[0m00:06:53.339881 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_loanstatus, now model.credit.dim_purpose)
[0m00:06:53.341713 [debug] [Thread-1 (]: Began compiling node model.credit.dim_purpose
[0m00:06:53.358229 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_purpose"
[0m00:06:53.379090 [debug] [Thread-1 (]: Timing info for model.credit.dim_purpose (compile): 00:06:53.342988 => 00:06:53.377919
[0m00:06:53.381550 [debug] [Thread-1 (]: Began executing node model.credit.dim_purpose
[0m00:06:53.392053 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_purpose"
[0m00:06:52.906429 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:06:52.918496 [debug] [Thread-1 (]: On model.credit.dim_purpose: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_purpose"} */


  create or replace view `airflowcrtn`.`credit`.`dim_purpose`
  OPTIONS()
  as SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast(Purpose as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as PurposeID,
		'Purpose ' AS Purpose 
FROM `airflowcrtn`.`credit`.`raw_invoices`
WHERE Purpose  IS NOT NULL;


[0m00:06:53.642727 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:86a530c6-79ad-4459-9d0b-2b77b29ba7ae&page=queryresults
[0m00:06:54.401017 [debug] [Thread-1 (]: Timing info for model.credit.dim_purpose (execute): 00:06:53.383225 => 00:06:54.400425
[0m00:06:54.403963 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'feef27ea-7a22-4dd0-b7ae-1838689c09c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcda7738530>]}
[0m00:06:54.406184 [info ] [Thread-1 (]: 3 of 4 OK created sql view model credit.dim_purpose ............................ [[32mCREATE VIEW (0 processed)[0m in 1.07s]
[0m00:06:54.409654 [debug] [Thread-1 (]: Finished running node model.credit.dim_purpose
[0m00:06:54.413482 [debug] [Thread-1 (]: Began running node model.credit.fact_invoices
[0m00:06:54.415292 [info ] [Thread-1 (]: 4 of 4 START sql view model credit.fact_invoices ............................... [RUN]
[0m00:06:54.418532 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_purpose, now model.credit.fact_invoices)
[0m00:06:54.420369 [debug] [Thread-1 (]: Began compiling node model.credit.fact_invoices
[0m00:06:54.443375 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.fact_invoices"
[0m00:06:54.323428 [debug] [Thread-1 (]: Timing info for model.credit.fact_invoices (compile): 00:06:54.421822 => 00:06:54.321959
[0m00:06:54.325877 [debug] [Thread-1 (]: Began executing node model.credit.fact_invoices
[0m00:06:54.337802 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.fact_invoices"
[0m00:06:54.358503 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:06:54.368300 [debug] [Thread-1 (]: On model.credit.fact_invoices: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.fact_invoices"} */


  create or replace view `airflowcrtn`.`credit`.`fact_invoices`
  OPTIONS()
  as WITH fct_invoices_cte AS (
    SELECT DISTINCT
        'Loan ID' AS LoanID,
        'Customer ID' AS CustomerID,
        to_hex(md5(cast(coalesce(cast(Loan Status as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Term as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as LoanStatusID
        to_hex(md5(cast(coalesce(cast(Purpose as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as PurposeID,
        'Current Loan Amount' AS CurrentLoanAmount,
        'Credit Score' AS CreditScore,
        'Annual Income' AS AnnualIncome,
        'Monthly Debt' AS MonthlyDebt,
        'Years of Credit History' AS YearsofCreditHistory,
        'Months since last delinquent' AS Monthssincelastdelinquent,
        'Number of Open Accounts' AS NumberofOpenAccounts,
        'Number of Credit Problems' AS NumberofCreditProblems,
        'Current Credit Balance' AS CurrentCreditBalance,
        'Maximum Open Credit' AS MaximumOpenCredit,
        'Bankruptcies' AS Bankruptcies
        'Tax Liens' AS TaxLiens
        
       
    FROM `airflowcrtn`.`credit`.`raw_invoices`
    
)
SELECT
   fi.*
FROM fct_invoices_cte fi
INNER JOIN `airflowcrtn`.`credit`.`dim_purpose` dt ON fi.PurposeID = dt.PurposeID
INNER JOIN `airflowcrtn`.`credit`.`dim_loanstatus` dp ON fi.LoanStatusID = dp.LoanStatusID
INNER JOIN `airflowcrtn`.`credit`.`dim_customer` dc ON fi.CustomerID = dc.CustomerID;


[0m00:06:54.790132 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:9ec3517a-edb8-4306-8fbf-9a8182edad06&page=queryresults
[0m00:06:54.792934 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword AS but got identifier "Status" at [10:44]; reason: invalidQuery, location: query, message: Syntax error: Expected keyword AS but got identifier "Status" at [10:44]')
[0m00:06:55.266941 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:e5a831e7-82a6-43c9-9a68-fea8a9052c55&page=queryresults
[0m00:06:55.269306 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:e5a831e7-82a6-43c9-9a68-fea8a9052c55&page=queryresults
[0m00:06:55.272324 [debug] [Thread-1 (]: Timing info for model.credit.fact_invoices (execute): 00:06:54.327890 => 00:06:55.271435
[0m00:06:55.287445 [debug] [Thread-1 (]: Database Error in model fact_invoices (models/transform/fact_invoices.sql)
  Syntax error: Expected keyword AS but got identifier "Status" at [10:44]
  compiled Code at target/run/credit/models/transform/fact_invoices.sql
[0m00:06:55.289317 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'feef27ea-7a22-4dd0-b7ae-1838689c09c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcda7936d80>]}
[0m00:06:55.291489 [error] [Thread-1 (]: 4 of 4 ERROR creating sql view model credit.fact_invoices ...................... [[31mERROR[0m in 0.87s]
[0m00:06:55.301369 [debug] [Thread-1 (]: Finished running node model.credit.fact_invoices
[0m00:06:55.312409 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:06:55.314822 [debug] [MainThread]: Connection 'model.credit.fact_invoices' was properly closed.
[0m00:06:55.316774 [info ] [MainThread]: 
[0m00:06:55.318736 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 5.70 seconds (5.70s).
[0m00:06:55.326143 [debug] [MainThread]: Command end result
[0m00:06:55.399912 [info ] [MainThread]: 
[0m00:06:55.401974 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:06:55.404234 [info ] [MainThread]: 
[0m00:06:55.406136 [error] [MainThread]:   Database Error in model fact_invoices (models/transform/fact_invoices.sql)
  Syntax error: Expected keyword AS but got identifier "Status" at [10:44]
  compiled Code at target/run/credit/models/transform/fact_invoices.sql
[0m00:06:55.408172 [info ] [MainThread]: 
[0m00:06:55.410083 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m00:06:55.412729 [debug] [MainThread]: Command `dbt run` failed at 00:06:55.412260 after 10.79 seconds
[0m00:06:55.414409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdaaa4bec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcda79359a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcda75accb0>]}
[0m00:06:55.416610 [debug] [MainThread]: Flushing usage events
[0m00:07:52.078505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fe8ad2ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fe8da16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fe94b7950>]}


============================== 00:07:52.083630 | bdc7cbe1-f7ec-4ff5-8028-f81fd5877390 ==============================
[0m00:07:52.083630 [info ] [MainThread]: Running with dbt=1.6.18
[0m00:07:52.085881 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'indirect_selection': 'eager', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'printer_width': '80', 'cache_selected_only': 'False', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'version_check': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'fail_fast': 'False', 'log_cache_events': 'False', 'log_format': 'default', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'write_json': 'True', 'use_colors': 'True', 'introspect': 'True'}
[0m00:07:53.199036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bdc7cbe1-f7ec-4ff5-8028-f81fd5877390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fe6da5850>]}
[0m00:07:53.242334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bdc7cbe1-f7ec-4ff5-8028-f81fd5877390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fe6c0cef0>]}
[0m00:07:53.244428 [info ] [MainThread]: Registered adapter: bigquery=1.6.0
[0m00:07:53.326307 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m00:07:55.463185 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:07:55.465523 [debug] [MainThread]: Partial parsing: updated file: credit://models/transform/fact_invoices.sql
[0m00:07:55.665392 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.retail
[0m00:07:55.685669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bdc7cbe1-f7ec-4ff5-8028-f81fd5877390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fe69e2510>]}
[0m00:07:55.752922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bdc7cbe1-f7ec-4ff5-8028-f81fd5877390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fe6a8cc20>]}
[0m00:07:55.754927 [info ] [MainThread]: Found 4 models, 1 source, 0 exposures, 0 metrics, 509 macros, 0 groups, 0 semantic models
[0m00:07:55.757124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdc7cbe1-f7ec-4ff5-8028-f81fd5877390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fe6a8c800>]}
[0m00:07:55.764295 [info ] [MainThread]: 
[0m00:07:55.767674 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:07:55.772138 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflowcrtn'
[0m00:07:55.774020 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:07:56.265608 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflowcrtn, now list_airflowcrtn_credit)
[0m00:07:56.267510 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:07:56.700748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdc7cbe1-f7ec-4ff5-8028-f81fd5877390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fe69fcec0>]}
[0m00:07:56.704695 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:07:56.706623 [info ] [MainThread]: 
[0m00:07:56.716793 [debug] [Thread-1 (]: Began running node model.credit.dim_customer
[0m00:07:56.720513 [info ] [Thread-1 (]: 1 of 4 START sql view model credit.dim_customer ................................ [RUN]
[0m00:07:56.724193 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflowcrtn_credit, now model.credit.dim_customer)
[0m00:07:56.726106 [debug] [Thread-1 (]: Began compiling node model.credit.dim_customer
[0m00:07:56.756740 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_customer"
[0m00:07:56.780098 [debug] [Thread-1 (]: Timing info for model.credit.dim_customer (compile): 00:07:56.727456 => 00:07:56.779033
[0m00:07:56.781910 [debug] [Thread-1 (]: Began executing node model.credit.dim_customer
[0m00:07:56.870910 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_customer"
[0m00:07:56.895850 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:07:56.905667 [debug] [Thread-1 (]: On model.credit.dim_customer: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_customer"} */


  create or replace view `airflowcrtn`.`credit`.`dim_customer`
  OPTIONS()
  as SELECT DISTINCT
	    'Customer ID' as CustomerID,
	    'Years in Current Job' as YearsinCurrentJob,
         'Home Ownership' as HomeOwnership
	FROM `airflowcrtn`.`credit`.`raw_invoices`
	WHERE 'Customer ID' IS NOT NULL;


[0m00:07:57.659296 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:e21dbac9-4bdf-491e-98b3-619eee86ee4c&page=queryresults
[0m00:07:58.175364 [debug] [Thread-1 (]: Timing info for model.credit.dim_customer (execute): 00:07:56.783467 => 00:07:58.174680
[0m00:07:58.179243 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdc7cbe1-f7ec-4ff5-8028-f81fd5877390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fe6a0e060>]}
[0m00:07:58.181910 [info ] [Thread-1 (]: 1 of 4 OK created sql view model credit.dim_customer ........................... [[32mCREATE VIEW (0 processed)[0m in 1.46s]
[0m00:07:58.184891 [debug] [Thread-1 (]: Finished running node model.credit.dim_customer
[0m00:07:58.187471 [debug] [Thread-1 (]: Began running node model.credit.dim_loanstatus
[0m00:07:58.189270 [info ] [Thread-1 (]: 2 of 4 START sql view model credit.dim_loanstatus .............................. [RUN]
[0m00:07:58.192325 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_customer, now model.credit.dim_loanstatus)
[0m00:07:58.194300 [debug] [Thread-1 (]: Began compiling node model.credit.dim_loanstatus
[0m00:07:58.212034 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_loanstatus"
[0m00:07:58.235404 [debug] [Thread-1 (]: Timing info for model.credit.dim_loanstatus (compile): 00:07:58.195953 => 00:07:58.233875
[0m00:07:58.237512 [debug] [Thread-1 (]: Began executing node model.credit.dim_loanstatus
[0m00:07:58.248142 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_loanstatus"
[0m00:07:58.269952 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:07:58.280018 [debug] [Thread-1 (]: On model.credit.dim_loanstatus: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_loanstatus"} */


  create or replace view `airflowcrtn`.`credit`.`dim_loanstatus`
  OPTIONS()
  as SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast("Loan Status" as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Term as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as LoanStatusID,
	    "Loan Status" AS LoanStatus,
        'Term' AS Term

FROM `airflowcrtn`.`credit`.`raw_invoices`
WHERE "Loan Status" IS NOT NULL;


[0m00:07:58.646816 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:0da05fea-5ea3-478d-81be-37d8042ff1f9&page=queryresults
[0m00:07:59.116984 [debug] [Thread-1 (]: Timing info for model.credit.dim_loanstatus (execute): 00:07:58.239006 => 00:07:59.116305
[0m00:07:59.120160 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdc7cbe1-f7ec-4ff5-8028-f81fd5877390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fe6adfd10>]}
[0m00:07:59.122168 [info ] [Thread-1 (]: 2 of 4 OK created sql view model credit.dim_loanstatus ......................... [[32mCREATE VIEW (0 processed)[0m in 0.93s]
[0m00:07:59.128904 [debug] [Thread-1 (]: Finished running node model.credit.dim_loanstatus
[0m00:07:59.131606 [debug] [Thread-1 (]: Began running node model.credit.dim_purpose
[0m00:07:59.134108 [info ] [Thread-1 (]: 3 of 4 START sql view model credit.dim_purpose ................................. [RUN]
[0m00:07:59.137156 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_loanstatus, now model.credit.dim_purpose)
[0m00:07:59.138683 [debug] [Thread-1 (]: Began compiling node model.credit.dim_purpose
[0m00:07:59.156093 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_purpose"
[0m00:07:59.178828 [debug] [Thread-1 (]: Timing info for model.credit.dim_purpose (compile): 00:07:59.140380 => 00:07:59.177581
[0m00:07:59.180804 [debug] [Thread-1 (]: Began executing node model.credit.dim_purpose
[0m00:07:59.192026 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_purpose"
[0m00:07:59.214387 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:07:59.227251 [debug] [Thread-1 (]: On model.credit.dim_purpose: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_purpose"} */


  create or replace view `airflowcrtn`.`credit`.`dim_purpose`
  OPTIONS()
  as SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast(Purpose as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as PurposeID,
		'Purpose ' AS Purpose 
FROM `airflowcrtn`.`credit`.`raw_invoices`
WHERE Purpose  IS NOT NULL;


[0m00:08:00.006571 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:d2b6453b-da0c-48ad-8d0a-c0b759ffcf56&page=queryresults
[0m00:08:00.496335 [debug] [Thread-1 (]: Timing info for model.credit.dim_purpose (execute): 00:07:59.182252 => 00:08:00.495729
[0m00:08:00.499986 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdc7cbe1-f7ec-4ff5-8028-f81fd5877390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fe687f590>]}
[0m00:08:00.502805 [info ] [Thread-1 (]: 3 of 4 OK created sql view model credit.dim_purpose ............................ [[32mCREATE VIEW (0 processed)[0m in 1.36s]
[0m00:08:00.505955 [debug] [Thread-1 (]: Finished running node model.credit.dim_purpose
[0m00:08:00.510105 [debug] [Thread-1 (]: Began running node model.credit.fact_invoices
[0m00:08:00.512087 [info ] [Thread-1 (]: 4 of 4 START sql view model credit.fact_invoices ............................... [RUN]
[0m00:08:00.515014 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_purpose, now model.credit.fact_invoices)
[0m00:08:00.517279 [debug] [Thread-1 (]: Began compiling node model.credit.fact_invoices
[0m00:08:00.539714 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.fact_invoices"
[0m00:08:00.564337 [debug] [Thread-1 (]: Timing info for model.credit.fact_invoices (compile): 00:08:00.518730 => 00:08:00.563127
[0m00:08:00.566321 [debug] [Thread-1 (]: Began executing node model.credit.fact_invoices
[0m00:08:00.577467 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.fact_invoices"
[0m00:08:00.602234 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:08:00.615130 [debug] [Thread-1 (]: On model.credit.fact_invoices: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.fact_invoices"} */


  create or replace view `airflowcrtn`.`credit`.`fact_invoices`
  OPTIONS()
  as WITH fct_invoices_cte AS (
    SELECT DISTINCT
        'Loan ID' AS LoanID,
        'Customer ID' AS CustomerID,
        to_hex(md5(cast(coalesce(cast("Loan Status" as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Term as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as LoanStatusID
        to_hex(md5(cast(coalesce(cast(Purpose as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as PurposeID,
        'Current Loan Amount' AS CurrentLoanAmount,
        'Credit Score' AS CreditScore,
        'Annual Income' AS AnnualIncome,
        'Monthly Debt' AS MonthlyDebt,
        'Years of Credit History' AS YearsofCreditHistory,
        'Months since last delinquent' AS Monthssincelastdelinquent,
        'Number of Open Accounts' AS NumberofOpenAccounts,
        'Number of Credit Problems' AS NumberofCreditProblems,
        'Current Credit Balance' AS CurrentCreditBalance,
        'Maximum Open Credit' AS MaximumOpenCredit,
        'Bankruptcies' AS Bankruptcies
        'Tax Liens' AS TaxLiens
        
       
    FROM `airflowcrtn`.`credit`.`raw_invoices`
    
)
SELECT
   fi.*
FROM fct_invoices_cte fi
INNER JOIN `airflowcrtn`.`credit`.`dim_purpose` dt ON fi.PurposeID = dt.PurposeID
INNER JOIN `airflowcrtn`.`credit`.`dim_loanstatus` dp ON fi.LoanStatusID = dp.LoanStatusID
INNER JOIN `airflowcrtn`.`credit`.`dim_customer` dc ON fi.CustomerID = dc.CustomerID;


[0m00:08:01.079640 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:0ed3cf88-fa45-46cb-b11f-f53258855548&page=queryresults
[0m00:08:01.082930 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got identifier "to_hex" at [11:9]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got identifier "to_hex" at [11:9]')
[0m00:08:01.936451 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:130d4ae8-a6c5-4ef9-89ed-423b30b4a158&page=queryresults
[0m00:08:01.939263 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:130d4ae8-a6c5-4ef9-89ed-423b30b4a158&page=queryresults
[0m00:08:01.941987 [debug] [Thread-1 (]: Timing info for model.credit.fact_invoices (execute): 00:08:00.567739 => 00:08:01.941125
[0m00:08:01.957173 [debug] [Thread-1 (]: Database Error in model fact_invoices (models/transform/fact_invoices.sql)
  Syntax error: Expected ")" but got identifier "to_hex" at [11:9]
  compiled Code at target/run/credit/models/transform/fact_invoices.sql
[0m00:08:01.959482 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdc7cbe1-f7ec-4ff5-8028-f81fd5877390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fe8a17aa0>]}
[0m00:08:01.961681 [error] [Thread-1 (]: 4 of 4 ERROR creating sql view model credit.fact_invoices ...................... [[31mERROR[0m in 1.45s]
[0m00:08:01.966527 [debug] [Thread-1 (]: Finished running node model.credit.fact_invoices
[0m00:08:01.975315 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:08:01.976968 [debug] [MainThread]: Connection 'model.credit.fact_invoices' was properly closed.
[0m00:08:01.978557 [info ] [MainThread]: 
[0m00:08:01.980369 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 6.21 seconds (6.21s).
[0m00:08:01.986912 [debug] [MainThread]: Command end result
[0m00:08:02.049055 [info ] [MainThread]: 
[0m00:08:02.051551 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:08:02.053650 [info ] [MainThread]: 
[0m00:08:02.055639 [error] [MainThread]:   Database Error in model fact_invoices (models/transform/fact_invoices.sql)
  Syntax error: Expected ")" but got identifier "to_hex" at [11:9]
  compiled Code at target/run/credit/models/transform/fact_invoices.sql
[0m00:08:02.059296 [info ] [MainThread]: 
[0m00:08:02.061722 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m00:08:02.064452 [debug] [MainThread]: Command `dbt run` failed at 00:08:02.063911 after 10.97 seconds
[0m00:08:02.066512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fe8ad07a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fe695c110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fe695c050>]}
[0m00:08:02.068425 [debug] [MainThread]: Flushing usage events
[0m00:10:28.586720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefd50e2600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefd53d25a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefd55d9c70>]}


============================== 00:10:28.591701 | bb543f78-8444-4fdb-8c14-6e5ff93eb195 ==============================
[0m00:10:28.591701 [info ] [MainThread]: Running with dbt=1.6.18
[0m00:10:28.593898 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'write_json': 'True', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'static_parser': 'True', 'introspect': 'True', 'warn_error': 'None', 'quiet': 'False', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'printer_width': '80', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'partial_parse': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs'}
[0m00:10:30.000186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb543f78-8444-4fdb-8c14-6e5ff93eb195', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefd50e2360>]}
[0m00:10:30.044268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb543f78-8444-4fdb-8c14-6e5ff93eb195', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefd32304a0>]}
[0m00:10:30.046562 [info ] [MainThread]: Registered adapter: bigquery=1.6.0
[0m00:10:30.137645 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m00:10:32.152756 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:10:32.155076 [debug] [MainThread]: Partial parsing: updated file: credit://models/transform/fact_invoices.sql
[0m00:10:32.365466 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.retail
[0m00:10:32.383883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb543f78-8444-4fdb-8c14-6e5ff93eb195', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefd300ade0>]}
[0m00:10:32.461341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb543f78-8444-4fdb-8c14-6e5ff93eb195', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefd3089be0>]}
[0m00:10:32.463749 [info ] [MainThread]: Found 4 models, 1 source, 0 exposures, 0 metrics, 509 macros, 0 groups, 0 semantic models
[0m00:10:32.465403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb543f78-8444-4fdb-8c14-6e5ff93eb195', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefd30897c0>]}
[0m00:10:32.470885 [info ] [MainThread]: 
[0m00:10:32.474452 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:10:32.478843 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflowcrtn'
[0m00:10:32.480665 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:10:32.973343 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflowcrtn, now list_airflowcrtn_credit)
[0m00:10:32.975205 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:10:32.974616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb543f78-8444-4fdb-8c14-6e5ff93eb195', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefd3088980>]}
[0m00:10:32.978220 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:10:32.980253 [info ] [MainThread]: 
[0m00:10:32.988731 [debug] [Thread-1 (]: Began running node model.credit.dim_customer
[0m00:10:32.991032 [info ] [Thread-1 (]: 1 of 4 START sql view model credit.dim_customer ................................ [RUN]
[0m00:10:32.994124 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflowcrtn_credit, now model.credit.dim_customer)
[0m00:10:32.996101 [debug] [Thread-1 (]: Began compiling node model.credit.dim_customer
[0m00:10:33.025909 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_customer"
[0m00:10:33.049034 [debug] [Thread-1 (]: Timing info for model.credit.dim_customer (compile): 00:10:32.997605 => 00:10:33.047526
[0m00:10:33.052179 [debug] [Thread-1 (]: Began executing node model.credit.dim_customer
[0m00:10:33.145776 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_customer"
[0m00:10:33.167791 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:10:33.178929 [debug] [Thread-1 (]: On model.credit.dim_customer: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_customer"} */


  create or replace view `airflowcrtn`.`credit`.`dim_customer`
  OPTIONS()
  as SELECT DISTINCT
	    'Customer ID' as CustomerID,
	    'Years in Current Job' as YearsinCurrentJob,
         'Home Ownership' as HomeOwnership
	FROM `airflowcrtn`.`credit`.`raw_invoices`
	WHERE 'Customer ID' IS NOT NULL;


[0m00:10:33.977721 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:2ac5b339-28a2-4b63-be34-0c0e0da4c4a2&page=queryresults
[0m00:10:35.058238 [debug] [Thread-1 (]: Timing info for model.credit.dim_customer (execute): 00:10:33.054065 => 00:10:35.057587
[0m00:10:35.061481 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb543f78-8444-4fdb-8c14-6e5ff93eb195', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefd300d9d0>]}
[0m00:10:35.063889 [info ] [Thread-1 (]: 1 of 4 OK created sql view model credit.dim_customer ........................... [[32mCREATE VIEW (0 processed)[0m in 2.07s]
[0m00:10:35.067398 [debug] [Thread-1 (]: Finished running node model.credit.dim_customer
[0m00:10:35.069314 [debug] [Thread-1 (]: Began running node model.credit.dim_loanstatus
[0m00:10:35.071263 [info ] [Thread-1 (]: 2 of 4 START sql view model credit.dim_loanstatus .............................. [RUN]
[0m00:10:35.074381 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_customer, now model.credit.dim_loanstatus)
[0m00:10:35.076139 [debug] [Thread-1 (]: Began compiling node model.credit.dim_loanstatus
[0m00:10:35.092612 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_loanstatus"
[0m00:10:35.116048 [debug] [Thread-1 (]: Timing info for model.credit.dim_loanstatus (compile): 00:10:35.077606 => 00:10:35.115000
[0m00:10:35.117838 [debug] [Thread-1 (]: Began executing node model.credit.dim_loanstatus
[0m00:10:35.131142 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_loanstatus"
[0m00:10:35.151103 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:10:35.164097 [debug] [Thread-1 (]: On model.credit.dim_loanstatus: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_loanstatus"} */


  create or replace view `airflowcrtn`.`credit`.`dim_loanstatus`
  OPTIONS()
  as SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast("Loan Status" as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Term as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as LoanStatusID,
	    "Loan Status" AS LoanStatus,
        'Term' AS Term

FROM `airflowcrtn`.`credit`.`raw_invoices`
WHERE "Loan Status" IS NOT NULL;


[0m00:10:35.803120 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:2cac06d0-c21e-47cf-83ee-b1f9590d4e43&page=queryresults
[0m00:10:36.448047 [debug] [Thread-1 (]: Timing info for model.credit.dim_loanstatus (execute): 00:10:35.119291 => 00:10:36.447253
[0m00:10:36.451626 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb543f78-8444-4fdb-8c14-6e5ff93eb195', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefd2e6c3b0>]}
[0m00:10:36.453998 [info ] [Thread-1 (]: 2 of 4 OK created sql view model credit.dim_loanstatus ......................... [[32mCREATE VIEW (0 processed)[0m in 1.38s]
[0m00:10:36.456764 [debug] [Thread-1 (]: Finished running node model.credit.dim_loanstatus
[0m00:10:36.459027 [debug] [Thread-1 (]: Began running node model.credit.dim_purpose
[0m00:10:36.461002 [info ] [Thread-1 (]: 3 of 4 START sql view model credit.dim_purpose ................................. [RUN]
[0m00:10:36.463782 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_loanstatus, now model.credit.dim_purpose)
[0m00:10:36.465296 [debug] [Thread-1 (]: Began compiling node model.credit.dim_purpose
[0m00:10:36.480036 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_purpose"
[0m00:10:36.500493 [debug] [Thread-1 (]: Timing info for model.credit.dim_purpose (compile): 00:10:36.466675 => 00:10:36.499366
[0m00:10:36.502766 [debug] [Thread-1 (]: Began executing node model.credit.dim_purpose
[0m00:10:36.515202 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_purpose"
[0m00:10:36.540281 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:10:36.553066 [debug] [Thread-1 (]: On model.credit.dim_purpose: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_purpose"} */


  create or replace view `airflowcrtn`.`credit`.`dim_purpose`
  OPTIONS()
  as SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast(Purpose as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as PurposeID,
		'Purpose ' AS Purpose 
FROM `airflowcrtn`.`credit`.`raw_invoices`
WHERE Purpose  IS NOT NULL;


[0m00:10:37.247398 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:2cd78db4-0f81-4e32-8225-35d85801db86&page=queryresults
[0m00:10:37.684831 [debug] [Thread-1 (]: Timing info for model.credit.dim_purpose (execute): 00:10:36.504573 => 00:10:37.684198
[0m00:10:37.687738 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb543f78-8444-4fdb-8c14-6e5ff93eb195', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefd2e936b0>]}
[0m00:10:37.689835 [info ] [Thread-1 (]: 3 of 4 OK created sql view model credit.dim_purpose ............................ [[32mCREATE VIEW (0 processed)[0m in 1.22s]
[0m00:10:37.694614 [debug] [Thread-1 (]: Finished running node model.credit.dim_purpose
[0m00:10:37.698431 [debug] [Thread-1 (]: Began running node model.credit.fact_invoices
[0m00:10:37.700190 [info ] [Thread-1 (]: 4 of 4 START sql view model credit.fact_invoices ............................... [RUN]
[0m00:10:37.703331 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_purpose, now model.credit.fact_invoices)
[0m00:10:37.705514 [debug] [Thread-1 (]: Began compiling node model.credit.fact_invoices
[0m00:10:37.729007 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.fact_invoices"
[0m00:10:37.752019 [debug] [Thread-1 (]: Timing info for model.credit.fact_invoices (compile): 00:10:37.706907 => 00:10:37.750917
[0m00:10:37.753623 [debug] [Thread-1 (]: Began executing node model.credit.fact_invoices
[0m00:10:37.763342 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.fact_invoices"
[0m00:10:37.780666 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:10:37.792069 [debug] [Thread-1 (]: On model.credit.fact_invoices: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.fact_invoices"} */


  create or replace view `airflowcrtn`.`credit`.`fact_invoices`
  OPTIONS()
  as WITH fct_invoices_cte AS (
    SELECT DISTINCT
        "Loan ID" AS LoanID,
        "Customer ID" AS CustomerID,
        to_hex(md5(cast(coalesce(cast("Loan Status" as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Term as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as LoanStatusID
        to_hex(md5(cast(coalesce(cast(Purpose as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as PurposeID,
        "Current Loan Amount" AS CurrentLoanAmount,
        "Credit Score" AS CreditScore,
        "Annual Income" AS AnnualIncome,
        "Monthly Debt" AS MonthlyDebt,
        "Years of Credit History" AS YearsofCreditHistory,
        "Months since last delinquent" AS Monthssincelastdelinquent,
        "Number of Open Accounts" AS NumberofOpenAccounts,
        "Number of Credit Problems" AS NumberofCreditProblems,
        "Current Credit Balance" AS CurrentCreditBalance,
        "Maximum Open Credit" AS MaximumOpenCredit,
        Bankruptcies AS Bankruptcies
        "Tax Liens" AS TaxLiens
        
       
    FROM `airflowcrtn`.`credit`.`raw_invoices`
    
)
SELECT
   fi.*
FROM fct_invoices_cte fi
INNER JOIN `airflowcrtn`.`credit`.`dim_purpose` dt ON fi.PurposeID = dt.PurposeID
INNER JOIN `airflowcrtn`.`credit`.`dim_loanstatus` dp ON fi.LoanStatusID = dp.LoanStatusID
INNER JOIN `airflowcrtn`.`credit`.`dim_customer` dc ON fi.CustomerID = dc.CustomerID;


[0m00:10:38.520968 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:ef04bc2c-b1f5-47d4-be77-5c738816357f&page=queryresults
[0m00:10:38.523610 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got identifier "to_hex" at [11:9]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got identifier "to_hex" at [11:9]')
[0m00:10:38.437112 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:85e5be86-9edc-4ded-a119-8fade8295abb&page=queryresults
[0m00:10:38.439298 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:85e5be86-9edc-4ded-a119-8fade8295abb&page=queryresults
[0m00:10:38.442263 [debug] [Thread-1 (]: Timing info for model.credit.fact_invoices (execute): 00:10:37.754832 => 00:10:38.441198
[0m00:10:38.458450 [debug] [Thread-1 (]: Database Error in model fact_invoices (models/transform/fact_invoices.sql)
  Syntax error: Expected ")" but got identifier "to_hex" at [11:9]
  compiled Code at target/run/credit/models/transform/fact_invoices.sql
[0m00:10:38.461274 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb543f78-8444-4fdb-8c14-6e5ff93eb195', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefd300da60>]}
[0m00:10:38.463846 [error] [Thread-1 (]: 4 of 4 ERROR creating sql view model credit.fact_invoices ...................... [[31mERROR[0m in 0.76s]
[0m00:10:38.466686 [debug] [Thread-1 (]: Finished running node model.credit.fact_invoices
[0m00:10:38.476100 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:10:38.478119 [debug] [MainThread]: Connection 'model.credit.fact_invoices' was properly closed.
[0m00:10:38.479657 [info ] [MainThread]: 
[0m00:10:38.481421 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 6.01 seconds (6.01s).
[0m00:10:38.491152 [debug] [MainThread]: Command end result
[0m00:10:38.555585 [info ] [MainThread]: 
[0m00:10:38.557672 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:10:38.559452 [info ] [MainThread]: 
[0m00:10:38.561515 [error] [MainThread]:   Database Error in model fact_invoices (models/transform/fact_invoices.sql)
  Syntax error: Expected ")" but got identifier "to_hex" at [11:9]
  compiled Code at target/run/credit/models/transform/fact_invoices.sql
[0m00:10:38.563462 [info ] [MainThread]: 
[0m00:10:38.565720 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m00:10:38.569345 [debug] [MainThread]: Command `dbt run` failed at 00:10:38.568340 after 11.05 seconds
[0m00:10:38.571585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefd5583d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefd33c14f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefd2eb86e0>]}
[0m00:10:38.573717 [debug] [MainThread]: Flushing usage events
[0m00:12:06.335796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65587a1f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6558bfc7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65587a21e0>]}


============================== 00:12:06.341503 | 28963853-7aa1-4232-bc53-2abf1b0fbe52 ==============================
[0m00:12:06.341503 [info ] [MainThread]: Running with dbt=1.6.18
[0m00:12:06.344826 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'log_format': 'default', 'printer_width': '80', 'write_json': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'warn_error': 'None', 'static_parser': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'introspect': 'True', 'no_print': 'None', 'partial_parse': 'True'}
[0m00:12:07.735693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '28963853-7aa1-4232-bc53-2abf1b0fbe52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6556aacfe0>]}
[0m00:12:07.782624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '28963853-7aa1-4232-bc53-2abf1b0fbe52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65587a3e30>]}
[0m00:12:07.784811 [info ] [MainThread]: Registered adapter: bigquery=1.6.0
[0m00:12:07.874114 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m00:12:09.525824 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:12:09.528006 [debug] [MainThread]: Partial parsing: updated file: credit://models/transform/fact_invoices.sql
[0m00:12:09.739096 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.retail
[0m00:12:09.760046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '28963853-7aa1-4232-bc53-2abf1b0fbe52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6556793470>]}
[0m00:12:09.828829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '28963853-7aa1-4232-bc53-2abf1b0fbe52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6556764a70>]}
[0m00:12:09.830838 [info ] [MainThread]: Found 4 models, 1 source, 0 exposures, 0 metrics, 509 macros, 0 groups, 0 semantic models
[0m00:12:09.832851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28963853-7aa1-4232-bc53-2abf1b0fbe52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6556764350>]}
[0m00:12:09.838995 [info ] [MainThread]: 
[0m00:12:09.842204 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:12:09.846265 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflowcrtn'
[0m00:12:09.847812 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:12:10.380276 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflowcrtn, now list_airflowcrtn_credit)
[0m00:12:10.382144 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:12:10.803640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28963853-7aa1-4232-bc53-2abf1b0fbe52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6556a794f0>]}
[0m00:12:10.806827 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:12:10.808816 [info ] [MainThread]: 
[0m00:12:10.817930 [debug] [Thread-1 (]: Began running node model.credit.dim_customer
[0m00:12:10.819791 [info ] [Thread-1 (]: 1 of 4 START sql view model credit.dim_customer ................................ [RUN]
[0m00:12:10.822692 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflowcrtn_credit, now model.credit.dim_customer)
[0m00:12:10.824529 [debug] [Thread-1 (]: Began compiling node model.credit.dim_customer
[0m00:12:10.856785 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_customer"
[0m00:12:10.879170 [debug] [Thread-1 (]: Timing info for model.credit.dim_customer (compile): 00:12:10.826409 => 00:12:10.878208
[0m00:12:10.881242 [debug] [Thread-1 (]: Began executing node model.credit.dim_customer
[0m00:12:10.970343 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_customer"
[0m00:12:10.992789 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:12:11.003416 [debug] [Thread-1 (]: On model.credit.dim_customer: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_customer"} */


  create or replace view `airflowcrtn`.`credit`.`dim_customer`
  OPTIONS()
  as SELECT DISTINCT
	    'Customer ID' as CustomerID,
	    'Years in Current Job' as YearsinCurrentJob,
         'Home Ownership' as HomeOwnership
	FROM `airflowcrtn`.`credit`.`raw_invoices`
	WHERE 'Customer ID' IS NOT NULL;


[0m00:12:11.790021 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:30f588fc-6ac1-4002-b167-ebb2eeb5cc60&page=queryresults
[0m00:12:12.305107 [debug] [Thread-1 (]: Timing info for model.credit.dim_customer (execute): 00:12:10.882925 => 00:12:12.304434
[0m00:12:12.308390 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28963853-7aa1-4232-bc53-2abf1b0fbe52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65566e53a0>]}
[0m00:12:12.310645 [info ] [Thread-1 (]: 1 of 4 OK created sql view model credit.dim_customer ........................... [[32mCREATE VIEW (0 processed)[0m in 1.49s]
[0m00:12:12.314646 [debug] [Thread-1 (]: Finished running node model.credit.dim_customer
[0m00:12:12.317055 [debug] [Thread-1 (]: Began running node model.credit.dim_loanstatus
[0m00:12:12.318942 [info ] [Thread-1 (]: 2 of 4 START sql view model credit.dim_loanstatus .............................. [RUN]
[0m00:12:12.321873 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_customer, now model.credit.dim_loanstatus)
[0m00:12:12.323698 [debug] [Thread-1 (]: Began compiling node model.credit.dim_loanstatus
[0m00:12:12.342108 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_loanstatus"
[0m00:12:12.363030 [debug] [Thread-1 (]: Timing info for model.credit.dim_loanstatus (compile): 00:12:12.325159 => 00:12:12.361802
[0m00:12:12.365100 [debug] [Thread-1 (]: Began executing node model.credit.dim_loanstatus
[0m00:12:12.383126 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_loanstatus"
[0m00:12:12.401312 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:12:12.413647 [debug] [Thread-1 (]: On model.credit.dim_loanstatus: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_loanstatus"} */


  create or replace view `airflowcrtn`.`credit`.`dim_loanstatus`
  OPTIONS()
  as SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast("Loan Status" as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Term as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as LoanStatusID,
	    "Loan Status" AS LoanStatus,
        'Term' AS Term

FROM `airflowcrtn`.`credit`.`raw_invoices`
WHERE "Loan Status" IS NOT NULL;


[0m00:12:13.405134 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:f2ae771d-5f0d-4481-bf33-ae960309fec6&page=queryresults
[0m00:12:13.791903 [debug] [Thread-1 (]: Timing info for model.credit.dim_loanstatus (execute): 00:12:12.366698 => 00:12:13.791310
[0m00:12:13.795091 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28963853-7aa1-4232-bc53-2abf1b0fbe52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65567b92e0>]}
[0m00:12:13.797244 [info ] [Thread-1 (]: 2 of 4 OK created sql view model credit.dim_loanstatus ......................... [[32mCREATE VIEW (0 processed)[0m in 1.47s]
[0m00:12:13.800058 [debug] [Thread-1 (]: Finished running node model.credit.dim_loanstatus
[0m00:12:13.802484 [debug] [Thread-1 (]: Began running node model.credit.dim_purpose
[0m00:12:13.804954 [info ] [Thread-1 (]: 3 of 4 START sql view model credit.dim_purpose ................................. [RUN]
[0m00:12:13.807767 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_loanstatus, now model.credit.dim_purpose)
[0m00:12:13.809389 [debug] [Thread-1 (]: Began compiling node model.credit.dim_purpose
[0m00:12:13.824676 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_purpose"
[0m00:12:13.848390 [debug] [Thread-1 (]: Timing info for model.credit.dim_purpose (compile): 00:12:13.810579 => 00:12:13.847174
[0m00:12:13.850305 [debug] [Thread-1 (]: Began executing node model.credit.dim_purpose
[0m00:12:13.860969 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_purpose"
[0m00:12:13.883978 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:12:13.895504 [debug] [Thread-1 (]: On model.credit.dim_purpose: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_purpose"} */


  create or replace view `airflowcrtn`.`credit`.`dim_purpose`
  OPTIONS()
  as SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast(Purpose as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as PurposeID,
		'Purpose ' AS Purpose 
FROM `airflowcrtn`.`credit`.`raw_invoices`
WHERE Purpose  IS NOT NULL;


[0m00:12:14.796159 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:7bb4f2cd-0e00-4b27-92db-5ef289e043f5&page=queryresults
[0m00:12:15.242592 [debug] [Thread-1 (]: Timing info for model.credit.dim_purpose (execute): 00:12:13.851870 => 00:12:15.241994
[0m00:12:15.245587 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28963853-7aa1-4232-bc53-2abf1b0fbe52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f655656a540>]}
[0m00:12:15.247701 [info ] [Thread-1 (]: 3 of 4 OK created sql view model credit.dim_purpose ............................ [[32mCREATE VIEW (0 processed)[0m in 1.44s]
[0m00:12:15.252008 [debug] [Thread-1 (]: Finished running node model.credit.dim_purpose
[0m00:12:15.255892 [debug] [Thread-1 (]: Began running node model.credit.fact_invoices
[0m00:12:15.257816 [info ] [Thread-1 (]: 4 of 4 START sql view model credit.fact_invoices ............................... [RUN]
[0m00:12:15.260765 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_purpose, now model.credit.fact_invoices)
[0m00:12:15.262641 [debug] [Thread-1 (]: Began compiling node model.credit.fact_invoices
[0m00:12:15.292582 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.fact_invoices"
[0m00:12:15.314814 [debug] [Thread-1 (]: Timing info for model.credit.fact_invoices (compile): 00:12:15.264187 => 00:12:15.313793
[0m00:12:15.316708 [debug] [Thread-1 (]: Began executing node model.credit.fact_invoices
[0m00:12:15.327851 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.fact_invoices"
[0m00:12:15.349627 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:12:15.361275 [debug] [Thread-1 (]: On model.credit.fact_invoices: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.fact_invoices"} */


  create or replace view `airflowcrtn`.`credit`.`fact_invoices`
  OPTIONS()
  as WITH fct_invoices_cte AS (
    SELECT DISTINCT
        "Loan ID" AS LoanID,
        "Customer ID" AS CustomerID,
        to_hex(md5(cast(coalesce(cast("Loan Status" as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Term as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as LoanStatusID
        to_hex(md5(cast(coalesce(cast(Purpose as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as PurposeID,
        "Current Loan Amount" AS CurrentLoanAmount,
        "Credit Score" AS CreditScore,
        "Annual Income" AS AnnualIncome,
        "Monthly Debt" AS MonthlyDebt,
        "Years of Credit History" AS YearsofCreditHistory,
        "Months since last delinquent" AS Monthssincelastdelinquent,
        "Number of Open Accounts" AS NumberofOpenAccounts,
        "Number of Credit Problems" AS NumberofCreditProblems,
        "Current Credit Balance" AS CurrentCreditBalance,
        "Maximum Open Credit" AS MaximumOpenCredit,
        "Bankruptcies" AS Bankruptcies,
        "Tax Liens" AS TaxLiens       
      
    FROM `airflowcrtn`.`credit`.`raw_invoices`
    
)
SELECT
   fi.*
FROM fct_invoices_cte fi
INNER JOIN `airflowcrtn`.`credit`.`dim_purpose` dt ON fi.PurposeID = dt.PurposeID
INNER JOIN `airflowcrtn`.`credit`.`dim_loanstatus` dp ON fi.LoanStatusID = dp.LoanStatusID
INNER JOIN `airflowcrtn`.`credit`.`dim_customer` dc ON fi.CustomerID = dc.CustomerID;


[0m00:12:15.826038 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:1399e505-54ab-4b2e-94fd-99b8eb1d8f20&page=queryresults
[0m00:12:15.828629 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got identifier "to_hex" at [11:9]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got identifier "to_hex" at [11:9]')
[0m00:12:16.379280 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:de7d002e-3fea-414f-87db-cbcf60bf7f0d&page=queryresults
[0m00:12:16.382030 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:de7d002e-3fea-414f-87db-cbcf60bf7f0d&page=queryresults
[0m00:12:16.384978 [debug] [Thread-1 (]: Timing info for model.credit.fact_invoices (execute): 00:12:15.318047 => 00:12:16.384043
[0m00:12:16.400141 [debug] [Thread-1 (]: Database Error in model fact_invoices (models/transform/fact_invoices.sql)
  Syntax error: Expected ")" but got identifier "to_hex" at [11:9]
  compiled Code at target/run/credit/models/transform/fact_invoices.sql
[0m00:12:16.402216 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28963853-7aa1-4232-bc53-2abf1b0fbe52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6556584ce0>]}
[0m00:12:16.404792 [error] [Thread-1 (]: 4 of 4 ERROR creating sql view model credit.fact_invoices ...................... [[31mERROR[0m in 1.14s]
[0m00:12:16.409673 [debug] [Thread-1 (]: Finished running node model.credit.fact_invoices
[0m00:12:16.418185 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:12:16.419982 [debug] [MainThread]: Connection 'model.credit.fact_invoices' was properly closed.
[0m00:12:16.421933 [info ] [MainThread]: 
[0m00:12:16.424336 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 6.58 seconds (6.58s).
[0m00:12:16.433935 [debug] [MainThread]: Command end result
[0m00:12:16.500900 [info ] [MainThread]: 
[0m00:12:16.502940 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:12:16.504726 [info ] [MainThread]: 
[0m00:12:16.506489 [error] [MainThread]:   Database Error in model fact_invoices (models/transform/fact_invoices.sql)
  Syntax error: Expected ")" but got identifier "to_hex" at [11:9]
  compiled Code at target/run/credit/models/transform/fact_invoices.sql
[0m00:12:16.508178 [info ] [MainThread]: 
[0m00:12:16.510297 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m00:12:16.513408 [debug] [MainThread]: Command `dbt run` failed at 00:12:16.512834 after 11.25 seconds
[0m00:12:16.515280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6558cd4980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6556793da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65568341a0>]}
[0m00:12:16.517243 [debug] [MainThread]: Flushing usage events
[0m00:13:38.997767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3945997dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3946ac4b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39459963f0>]}


============================== 00:13:39.002937 | b9b7f5cd-1795-4e33-a9c5-83cfee7880b5 ==============================
[0m00:13:39.002937 [info ] [MainThread]: Running with dbt=1.6.18
[0m00:13:39.004967 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'introspect': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'debug': 'False', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'write_json': 'True', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'no_print': 'None', 'target_path': 'None', 'log_cache_events': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'printer_width': '80'}
[0m00:13:40.409638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b9b7f5cd-1795-4e33-a9c5-83cfee7880b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3943cc7620>]}
[0m00:13:40.457031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b9b7f5cd-1795-4e33-a9c5-83cfee7880b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3943ad0d40>]}
[0m00:13:40.459424 [info ] [MainThread]: Registered adapter: bigquery=1.6.0
[0m00:13:40.547664 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m00:13:42.957080 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:13:42.959451 [debug] [MainThread]: Partial parsing: updated file: credit://models/transform/fact_invoices.sql
[0m00:13:43.176235 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.retail
[0m00:13:43.194226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9b7f5cd-1795-4e33-a9c5-83cfee7880b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3943c9e420>]}
[0m00:13:43.268082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9b7f5cd-1795-4e33-a9c5-83cfee7880b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39439588f0>]}
[0m00:13:43.270048 [info ] [MainThread]: Found 4 models, 1 source, 0 exposures, 0 metrics, 509 macros, 0 groups, 0 semantic models
[0m00:13:43.272043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9b7f5cd-1795-4e33-a9c5-83cfee7880b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3943bc8530>]}
[0m00:13:43.278076 [info ] [MainThread]: 
[0m00:13:43.281377 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:13:43.286131 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflowcrtn'
[0m00:13:43.287915 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:13:43.824741 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflowcrtn, now list_airflowcrtn_credit)
[0m00:13:43.826591 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:13:43.733758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9b7f5cd-1795-4e33-a9c5-83cfee7880b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39438b9e20>]}
[0m00:13:43.737083 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:13:43.739030 [info ] [MainThread]: 
[0m00:13:43.748267 [debug] [Thread-1 (]: Began running node model.credit.dim_customer
[0m00:13:43.750769 [info ] [Thread-1 (]: 1 of 4 START sql view model credit.dim_customer ................................ [RUN]
[0m00:13:43.753932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflowcrtn_credit, now model.credit.dim_customer)
[0m00:13:43.755855 [debug] [Thread-1 (]: Began compiling node model.credit.dim_customer
[0m00:13:43.788319 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_customer"
[0m00:13:43.814040 [debug] [Thread-1 (]: Timing info for model.credit.dim_customer (compile): 00:13:43.758410 => 00:13:43.812787
[0m00:13:43.816099 [debug] [Thread-1 (]: Began executing node model.credit.dim_customer
[0m00:13:43.905728 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_customer"
[0m00:13:43.934138 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:13:43.946068 [debug] [Thread-1 (]: On model.credit.dim_customer: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_customer"} */


  create or replace view `airflowcrtn`.`credit`.`dim_customer`
  OPTIONS()
  as SELECT DISTINCT
	    'Customer ID' as CustomerID,
	    'Years in Current Job' as YearsinCurrentJob,
         'Home Ownership' as HomeOwnership
	FROM `airflowcrtn`.`credit`.`raw_invoices`
	WHERE 'Customer ID' IS NOT NULL;


[0m00:13:44.698629 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:bd3a238d-a07c-40a4-adbd-6eedd9f7b261&page=queryresults
[0m00:13:45.204532 [debug] [Thread-1 (]: Timing info for model.credit.dim_customer (execute): 00:13:43.817656 => 00:13:45.203603
[0m00:13:45.208241 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9b7f5cd-1795-4e33-a9c5-83cfee7880b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3943c69550>]}
[0m00:13:45.210951 [info ] [Thread-1 (]: 1 of 4 OK created sql view model credit.dim_customer ........................... [[32mCREATE VIEW (0 processed)[0m in 1.46s]
[0m00:13:45.214463 [debug] [Thread-1 (]: Finished running node model.credit.dim_customer
[0m00:13:45.217060 [debug] [Thread-1 (]: Began running node model.credit.dim_loanstatus
[0m00:13:45.219166 [info ] [Thread-1 (]: 2 of 4 START sql view model credit.dim_loanstatus .............................. [RUN]
[0m00:13:45.224703 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_customer, now model.credit.dim_loanstatus)
[0m00:13:45.227061 [debug] [Thread-1 (]: Began compiling node model.credit.dim_loanstatus
[0m00:13:45.246139 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_loanstatus"
[0m00:13:45.267346 [debug] [Thread-1 (]: Timing info for model.credit.dim_loanstatus (compile): 00:13:45.228562 => 00:13:45.266169
[0m00:13:45.269295 [debug] [Thread-1 (]: Began executing node model.credit.dim_loanstatus
[0m00:13:45.281365 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_loanstatus"
[0m00:13:45.300866 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:13:45.311456 [debug] [Thread-1 (]: On model.credit.dim_loanstatus: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_loanstatus"} */


  create or replace view `airflowcrtn`.`credit`.`dim_loanstatus`
  OPTIONS()
  as SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast("Loan Status" as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Term as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as LoanStatusID,
	    "Loan Status" AS LoanStatus,
        'Term' AS Term

FROM `airflowcrtn`.`credit`.`raw_invoices`
WHERE "Loan Status" IS NOT NULL;


[0m00:13:46.037920 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:cd35608d-7d4d-4046-8b6d-e9e4753bdcd1&page=queryresults
[0m00:13:46.589180 [debug] [Thread-1 (]: Timing info for model.credit.dim_loanstatus (execute): 00:13:45.270842 => 00:13:46.588594
[0m00:13:46.592535 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9b7f5cd-1795-4e33-a9c5-83cfee7880b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39439234a0>]}
[0m00:13:46.594874 [info ] [Thread-1 (]: 2 of 4 OK created sql view model credit.dim_loanstatus ......................... [[32mCREATE VIEW (0 processed)[0m in 1.37s]
[0m00:13:46.597840 [debug] [Thread-1 (]: Finished running node model.credit.dim_loanstatus
[0m00:13:46.600274 [debug] [Thread-1 (]: Began running node model.credit.dim_purpose
[0m00:13:46.602214 [info ] [Thread-1 (]: 3 of 4 START sql view model credit.dim_purpose ................................. [RUN]
[0m00:13:46.605243 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_loanstatus, now model.credit.dim_purpose)
[0m00:13:46.606806 [debug] [Thread-1 (]: Began compiling node model.credit.dim_purpose
[0m00:13:46.621905 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_purpose"
[0m00:13:46.645073 [debug] [Thread-1 (]: Timing info for model.credit.dim_purpose (compile): 00:13:46.607945 => 00:13:46.644047
[0m00:13:46.647139 [debug] [Thread-1 (]: Began executing node model.credit.dim_purpose
[0m00:13:46.658588 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_purpose"
[0m00:13:46.678188 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:13:46.689152 [debug] [Thread-1 (]: On model.credit.dim_purpose: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_purpose"} */


  create or replace view `airflowcrtn`.`credit`.`dim_purpose`
  OPTIONS()
  as SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast(Purpose as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as PurposeID,
		'Purpose ' AS Purpose 
FROM `airflowcrtn`.`credit`.`raw_invoices`
WHERE Purpose  IS NOT NULL;


[0m00:13:47.606330 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:5a15c497-8148-428a-9d2f-704efef290aa&page=queryresults
[0m00:13:49.265330 [debug] [Thread-1 (]: Timing info for model.credit.dim_purpose (execute): 00:13:46.648664 => 00:13:49.264484
[0m00:13:49.268021 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9b7f5cd-1795-4e33-a9c5-83cfee7880b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39439a8e60>]}
[0m00:13:49.270297 [info ] [Thread-1 (]: 3 of 4 OK created sql view model credit.dim_purpose ............................ [[32mCREATE VIEW (0 processed)[0m in 2.66s]
[0m00:13:49.273481 [debug] [Thread-1 (]: Finished running node model.credit.dim_purpose
[0m00:13:49.277061 [debug] [Thread-1 (]: Began running node model.credit.fact_invoices
[0m00:13:49.278806 [info ] [Thread-1 (]: 4 of 4 START sql view model credit.fact_invoices ............................... [RUN]
[0m00:13:49.282826 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_purpose, now model.credit.fact_invoices)
[0m00:13:49.284895 [debug] [Thread-1 (]: Began compiling node model.credit.fact_invoices
[0m00:13:49.310694 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.fact_invoices"
[0m00:13:49.333332 [debug] [Thread-1 (]: Timing info for model.credit.fact_invoices (compile): 00:13:49.286631 => 00:13:49.332228
[0m00:13:49.335186 [debug] [Thread-1 (]: Began executing node model.credit.fact_invoices
[0m00:13:49.346342 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.fact_invoices"
[0m00:13:49.370627 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:13:49.383316 [debug] [Thread-1 (]: On model.credit.fact_invoices: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.fact_invoices"} */


  create or replace view `airflowcrtn`.`credit`.`fact_invoices`
  OPTIONS()
  as WITH fct_invoices_cte AS (
    SELECT DISTINCT
        "Loan ID" AS LoanID,
        "Customer ID" AS CustomerID,
        to_hex(md5(cast(coalesce(cast("Loan Status" as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Term as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as LoanStatusID,
        to_hex(md5(cast(coalesce(cast(Purpose as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as PurposeID,
        "Current Loan Amount" AS CurrentLoanAmount,
        "Credit Score" AS CreditScore,
        "Annual Income" AS AnnualIncome,
        "Monthly Debt" AS MonthlyDebt,
        "Years of Credit History" AS YearsofCreditHistory,
        "Months since last delinquent" AS Monthssincelastdelinquent,
        "Number of Open Accounts" AS NumberofOpenAccounts,
        "Number of Credit Problems" AS NumberofCreditProblems,
        "Current Credit Balance" AS CurrentCreditBalance,
        "Maximum Open Credit" AS MaximumOpenCredit,
        "Bankruptcies" AS Bankruptcies,
        "Tax Liens" AS TaxLiens       
      
    FROM `airflowcrtn`.`credit`.`raw_invoices`
    
)
SELECT
   fi.*
FROM fct_invoices_cte fi
INNER JOIN `airflowcrtn`.`credit`.`dim_purpose` dt ON fi.PurposeID = dt.PurposeID
INNER JOIN `airflowcrtn`.`credit`.`dim_loanstatus` dp ON fi.LoanStatusID = dp.LoanStatusID
INNER JOIN `airflowcrtn`.`credit`.`dim_customer` dc ON fi.CustomerID = dc.CustomerID;


[0m00:13:50.384316 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:495c9388-40df-4e5c-994b-eb162cf2aaff&page=queryresults
[0m00:13:50.830217 [debug] [Thread-1 (]: Timing info for model.credit.fact_invoices (execute): 00:13:49.336623 => 00:13:50.829435
[0m00:13:50.834102 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9b7f5cd-1795-4e33-a9c5-83cfee7880b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3941761190>]}
[0m00:13:50.838447 [info ] [Thread-1 (]: 4 of 4 OK created sql view model credit.fact_invoices .......................... [[32mCREATE VIEW (0 processed)[0m in 1.55s]
[0m00:13:50.843744 [debug] [Thread-1 (]: Finished running node model.credit.fact_invoices
[0m00:13:50.852649 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:13:50.856896 [debug] [MainThread]: Connection 'model.credit.fact_invoices' was properly closed.
[0m00:13:50.859003 [info ] [MainThread]: 
[0m00:13:50.860931 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 7.58 seconds (7.58s).
[0m00:13:50.869100 [debug] [MainThread]: Command end result
[0m00:13:50.925962 [info ] [MainThread]: 
[0m00:13:50.928033 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:13:50.929659 [info ] [MainThread]: 
[0m00:13:50.931740 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m00:13:50.934448 [debug] [MainThread]: Command `dbt run` succeeded at 00:13:50.933905 after 13.01 seconds
[0m00:13:50.936271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3945eefce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3943bc9eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39438c0530>]}
[0m00:13:50.937949 [debug] [MainThread]: Flushing usage events
[0m00:23:09.538833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1f3593dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1f39ed970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1f3a60bf0>]}


============================== 00:23:09.544384 | e466e191-9bbc-4b91-9907-805fb68fca1e ==============================
[0m00:23:09.544384 [info ] [MainThread]: Running with dbt=1.6.18
[0m00:23:09.546614 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'introspect': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'use_experimental_parser': 'False', 'static_parser': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'version_check': 'True', 'write_json': 'True', 'use_colors': 'True', 'warn_error': 'None', 'printer_width': '80', 'indirect_selection': 'eager', 'log_format': 'default', 'fail_fast': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'no_print': 'None'}
[0m00:23:10.493119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e466e191-9bbc-4b91-9907-805fb68fca1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1f17a47d0>]}
[0m00:23:10.540787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e466e191-9bbc-4b91-9907-805fb68fca1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1f16d6570>]}
[0m00:23:10.543375 [info ] [MainThread]: Registered adapter: bigquery=1.6.0
[0m00:23:10.631520 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m00:23:12.686453 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m00:23:12.688833 [debug] [MainThread]: Partial parsing: updated file: credit://models/transform/dim_customer.sql
[0m00:23:12.690730 [debug] [MainThread]: Partial parsing: updated file: credit://models/transform/dim_loanstatus.sql
[0m00:23:12.692621 [debug] [MainThread]: Partial parsing: updated file: credit://models/transform/fact_invoices.sql
[0m00:23:12.694574 [debug] [MainThread]: Partial parsing: updated file: credit://models/transform/dim_purpose.sql
[0m00:23:12.952448 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.retail
[0m00:23:12.971758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e466e191-9bbc-4b91-9907-805fb68fca1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1f14d9f40>]}
[0m00:23:13.041673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e466e191-9bbc-4b91-9907-805fb68fca1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1f14d0620>]}
[0m00:23:13.043896 [info ] [MainThread]: Found 4 models, 1 source, 0 exposures, 0 metrics, 509 macros, 0 groups, 0 semantic models
[0m00:23:13.046596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e466e191-9bbc-4b91-9907-805fb68fca1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1f35934a0>]}
[0m00:23:13.054792 [info ] [MainThread]: 
[0m00:23:13.061225 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:23:13.067663 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflowcrtn'
[0m00:23:13.069747 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:23:13.654978 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflowcrtn, now list_airflowcrtn_credit)
[0m00:23:13.656690 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:23:14.114366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e466e191-9bbc-4b91-9907-805fb68fca1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1f14be5a0>]}
[0m00:23:14.117879 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:23:14.119924 [info ] [MainThread]: 
[0m00:23:14.129912 [debug] [Thread-1 (]: Began running node model.credit.dim_customer
[0m00:23:14.132752 [info ] [Thread-1 (]: 1 of 4 START sql table model credit.dim_customer ............................... [RUN]
[0m00:23:14.136605 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflowcrtn_credit, now model.credit.dim_customer)
[0m00:23:14.139603 [debug] [Thread-1 (]: Began compiling node model.credit.dim_customer
[0m00:23:14.169807 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_customer"
[0m00:23:14.195283 [debug] [Thread-1 (]: Timing info for model.credit.dim_customer (compile): 00:23:14.140966 => 00:23:14.194222
[0m00:23:14.197210 [debug] [Thread-1 (]: Began executing node model.credit.dim_customer
[0m00:23:14.244850 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:23:14.944151 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_customer"
[0m00:23:14.963533 [debug] [Thread-1 (]: On model.credit.dim_customer: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_customer"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`dim_customer`
      
    
    

    OPTIONS()
    as (
      


SELECT DISTINCT
	    'Customer ID' as CustomerID,
	    'Years in Current Job' as YearsinCurrentJob,
         'Home Ownership' as HomeOwnership
	FROM `airflowcrtn`.`credit`.`raw_invoices`
	WHERE 'Customer ID' IS NOT NULL
    );
  
[0m00:23:15.137167 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:bbdafbda-1926-4484-ad57-90523d31bfbe&page=queryresults
[0m00:23:17.703550 [debug] [Thread-1 (]: Timing info for model.credit.dim_customer (execute): 00:23:14.199429 => 00:23:17.702883
[0m00:23:17.706672 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e466e191-9bbc-4b91-9907-805fb68fca1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1f14d2630>]}
[0m00:23:17.708851 [info ] [Thread-1 (]: 1 of 4 OK created sql table model credit.dim_customer .......................... [[32mCREATE TABLE (1.0 rows, 0 processed)[0m in 3.57s]
[0m00:23:17.713151 [debug] [Thread-1 (]: Finished running node model.credit.dim_customer
[0m00:23:17.715625 [debug] [Thread-1 (]: Began running node model.credit.dim_loanstatus
[0m00:23:17.717639 [info ] [Thread-1 (]: 2 of 4 START sql table model credit.dim_loanstatus ............................. [RUN]
[0m00:23:17.722644 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_customer, now model.credit.dim_loanstatus)
[0m00:23:17.724347 [debug] [Thread-1 (]: Began compiling node model.credit.dim_loanstatus
[0m00:23:17.741613 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_loanstatus"
[0m00:23:17.762636 [debug] [Thread-1 (]: Timing info for model.credit.dim_loanstatus (compile): 00:23:17.725993 => 00:23:17.761454
[0m00:23:17.765276 [debug] [Thread-1 (]: Began executing node model.credit.dim_loanstatus
[0m00:23:17.774800 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:23:18.424536 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_loanstatus"
[0m00:23:18.444553 [debug] [Thread-1 (]: On model.credit.dim_loanstatus: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_loanstatus"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`dim_loanstatus`
      
    
    

    OPTIONS()
    as (
      


SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast("Loan Status" as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Term as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as LoanStatusID,
	    "Loan Status" AS LoanStatus,
        'Term' AS Term

FROM `airflowcrtn`.`credit`.`raw_invoices`
WHERE "Loan Status" IS NOT NULL
    );
  
[0m00:23:19.310115 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:413da24f-ecd4-4f52-8910-c04dda2f145b&page=queryresults
[0m00:23:21.746531 [debug] [Thread-1 (]: Timing info for model.credit.dim_loanstatus (execute): 00:23:17.766746 => 00:23:21.745784
[0m00:23:21.749975 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e466e191-9bbc-4b91-9907-805fb68fca1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1e3b5a990>]}
[0m00:23:21.752257 [info ] [Thread-1 (]: 2 of 4 OK created sql table model credit.dim_loanstatus ........................ [[32mCREATE TABLE (2.0 rows, 1.1 MiB processed)[0m in 4.03s]
[0m00:23:21.756453 [debug] [Thread-1 (]: Finished running node model.credit.dim_loanstatus
[0m00:23:21.758643 [debug] [Thread-1 (]: Began running node model.credit.dim_purpose
[0m00:23:21.760441 [info ] [Thread-1 (]: 3 of 4 START sql table model credit.dim_purpose ................................ [RUN]
[0m00:23:21.763788 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_loanstatus, now model.credit.dim_purpose)
[0m00:23:21.765708 [debug] [Thread-1 (]: Began compiling node model.credit.dim_purpose
[0m00:23:21.783070 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_purpose"
[0m00:23:21.805768 [debug] [Thread-1 (]: Timing info for model.credit.dim_purpose (compile): 00:23:21.766915 => 00:23:21.804022
[0m00:23:21.808493 [debug] [Thread-1 (]: Began executing node model.credit.dim_purpose
[0m00:23:21.817685 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:23:22.466223 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_purpose"
[0m00:23:22.484597 [debug] [Thread-1 (]: On model.credit.dim_purpose: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_purpose"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`dim_purpose`
      
    
    

    OPTIONS()
    as (
      

SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast(Purpose as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as PurposeID,
		'Purpose ' AS Purpose 
FROM `airflowcrtn`.`credit`.`raw_invoices`
WHERE Purpose  IS NOT NULL
    );
  
[0m00:23:22.985519 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:6fd606d9-3e22-46dc-a15d-2ec1826fccf8&page=queryresults
[0m00:23:32.326088 [debug] [Thread-1 (]: Timing info for model.credit.dim_purpose (execute): 00:23:21.810088 => 00:23:32.325470
[0m00:23:32.329263 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e466e191-9bbc-4b91-9907-805fb68fca1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1e3b42720>]}
[0m00:23:32.331464 [info ] [Thread-1 (]: 3 of 4 OK created sql table model credit.dim_purpose ........................... [[32mCREATE TABLE (16.0 rows, 1.7 MiB processed)[0m in 10.57s]
[0m00:23:32.334282 [debug] [Thread-1 (]: Finished running node model.credit.dim_purpose
[0m00:23:32.338883 [debug] [Thread-1 (]: Began running node model.credit.fact_invoices
[0m00:23:32.340910 [info ] [Thread-1 (]: 4 of 4 START sql table model credit.fact_invoices .............................. [RUN]
[0m00:23:32.344507 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_purpose, now model.credit.fact_invoices)
[0m00:23:32.346296 [debug] [Thread-1 (]: Began compiling node model.credit.fact_invoices
[0m00:23:32.375999 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.fact_invoices"
[0m00:23:32.397112 [debug] [Thread-1 (]: Timing info for model.credit.fact_invoices (compile): 00:23:32.347711 => 00:23:32.395586
[0m00:23:32.399488 [debug] [Thread-1 (]: Began executing node model.credit.fact_invoices
[0m00:23:32.411063 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:23:33.051092 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.fact_invoices"
[0m00:23:33.075018 [debug] [Thread-1 (]: On model.credit.fact_invoices: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.fact_invoices"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`fact_invoices`
      
    
    

    OPTIONS()
    as (
      


WITH fct_invoices_cte AS (
    SELECT DISTINCT
        "Loan ID" AS LoanID,
        "Customer ID" AS CustomerID,
        to_hex(md5(cast(coalesce(cast("Loan Status" as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Term as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as LoanStatusID,
        to_hex(md5(cast(coalesce(cast(Purpose as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as PurposeID,
        "Current Loan Amount" AS CurrentLoanAmount,
        "Credit Score" AS CreditScore,
        "Annual Income" AS AnnualIncome,
        "Monthly Debt" AS MonthlyDebt,
        "Years of Credit History" AS YearsofCreditHistory,
        "Months since last delinquent" AS Monthssincelastdelinquent,
        "Number of Open Accounts" AS NumberofOpenAccounts,
        "Number of Credit Problems" AS NumberofCreditProblems,
        "Current Credit Balance" AS CurrentCreditBalance,
        "Maximum Open Credit" AS MaximumOpenCredit,
        "Bankruptcies" AS Bankruptcies,
        "Tax Liens" AS TaxLiens       
      
    FROM `airflowcrtn`.`credit`.`raw_invoices`
    
)
SELECT
   fi.*
FROM fct_invoices_cte fi
INNER JOIN `airflowcrtn`.`credit`.`dim_purpose` dt ON fi.PurposeID = dt.PurposeID
INNER JOIN `airflowcrtn`.`credit`.`dim_loanstatus` dp ON fi.LoanStatusID = dp.LoanStatusID
INNER JOIN `airflowcrtn`.`credit`.`dim_customer` dc ON fi.CustomerID = dc.CustomerID
    );
  
[0m00:23:33.605566 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:7fa668f6-b42e-4f81-8ead-f711c3f23c5b&page=queryresults
[0m00:23:36.770336 [debug] [Thread-1 (]: Timing info for model.credit.fact_invoices (execute): 00:23:32.401098 => 00:23:36.769445
[0m00:23:36.773748 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e466e191-9bbc-4b91-9907-805fb68fca1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1e3b41400>]}
[0m00:23:36.775819 [info ] [Thread-1 (]: 4 of 4 OK created sql table model credit.fact_invoices ......................... [[32mCREATE TABLE (32.0 rows, 2.9 MiB processed)[0m in 4.43s]
[0m00:23:36.780435 [debug] [Thread-1 (]: Finished running node model.credit.fact_invoices
[0m00:23:36.787966 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:23:36.789880 [debug] [MainThread]: Connection 'model.credit.fact_invoices' was properly closed.
[0m00:23:36.791849 [info ] [MainThread]: 
[0m00:23:36.793894 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 23.73 seconds (23.73s).
[0m00:23:36.803143 [debug] [MainThread]: Command end result
[0m00:23:36.869454 [info ] [MainThread]: 
[0m00:23:36.871728 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:23:36.873999 [info ] [MainThread]: 
[0m00:23:36.875963 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m00:23:36.878801 [debug] [MainThread]: Command `dbt run` succeeded at 00:23:36.878299 after 30.42 seconds
[0m00:23:36.880512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1f46420f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1f14d86b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1f22317f0>]}
[0m00:23:36.882001 [debug] [MainThread]: Flushing usage events
[0m00:29:34.381367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f932e9cd9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f932f377620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f932e9ccfe0>]}


============================== 00:29:34.386884 | a82749a6-14ad-4052-9285-336f8b0a8790 ==============================
[0m00:29:34.386884 [info ] [MainThread]: Running with dbt=1.6.18
[0m00:29:34.389509 [debug] [MainThread]: running dbt with arguments {'log_path': '/usr/local/airflow/include/dbt/logs', 'partial_parse': 'True', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'warn_error': 'None', 'cache_selected_only': 'False', 'no_print': 'None', 'debug': 'False', 'write_json': 'True', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'static_parser': 'True', 'use_colors': 'True', 'printer_width': '80', 'introspect': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'target_path': 'None'}
[0m00:29:35.393501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a82749a6-14ad-4052-9285-336f8b0a8790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f932e9cf350>]}
[0m00:29:35.439794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a82749a6-14ad-4052-9285-336f8b0a8790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f932cb08560>]}
[0m00:29:35.441995 [info ] [MainThread]: Registered adapter: bigquery=1.6.0
[0m00:29:35.537191 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m00:29:37.649438 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:29:37.652335 [debug] [MainThread]: Partial parsing: updated file: credit://models/sources/sources.yml
[0m00:29:37.982516 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.retail
[0m00:29:38.002127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a82749a6-14ad-4052-9285-336f8b0a8790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f931ef0ba10>]}
[0m00:29:38.076731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a82749a6-14ad-4052-9285-336f8b0a8790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f932c94d4f0>]}
[0m00:29:38.078769 [info ] [MainThread]: Found 4 models, 1 source, 0 exposures, 0 metrics, 509 macros, 0 groups, 0 semantic models
[0m00:29:38.080587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a82749a6-14ad-4052-9285-336f8b0a8790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f931ef32c30>]}
[0m00:29:38.087416 [info ] [MainThread]: 
[0m00:29:38.090674 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:29:38.095325 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflowcrtn'
[0m00:29:38.096875 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:29:38.920452 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflowcrtn, now list_airflowcrtn_credit)
[0m00:29:38.922943 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:29:39.016952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a82749a6-14ad-4052-9285-336f8b0a8790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f932d3b8fb0>]}
[0m00:29:39.020035 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:29:39.021662 [info ] [MainThread]: 
[0m00:29:39.030785 [debug] [Thread-1 (]: Began running node model.credit.dim_customer
[0m00:29:39.032866 [info ] [Thread-1 (]: 1 of 4 START sql table model credit.dim_customer ............................... [RUN]
[0m00:29:39.036062 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflowcrtn_credit, now model.credit.dim_customer)
[0m00:29:39.037764 [debug] [Thread-1 (]: Began compiling node model.credit.dim_customer
[0m00:29:39.074037 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_customer"
[0m00:29:39.096700 [debug] [Thread-1 (]: Timing info for model.credit.dim_customer (compile): 00:29:39.039051 => 00:29:39.095548
[0m00:29:39.098852 [debug] [Thread-1 (]: Began executing node model.credit.dim_customer
[0m00:29:39.141129 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:29:39.660143 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_customer"
[0m00:29:39.678978 [debug] [Thread-1 (]: On model.credit.dim_customer: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_customer"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`dim_customer`
      
    
    

    OPTIONS()
    as (
      


SELECT DISTINCT
	    'Customer ID' as CustomerID,
	    'Years in Current Job' as YearsinCurrentJob,
         'Home Ownership' as HomeOwnership
	FROM `airflowcrtn`.`credit`.`raw_invoices`
	WHERE 'Customer ID' IS NOT NULL
    );
  
[0m00:29:40.246479 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:5d2af0f7-d48c-4dc9-b8b9-c2235b523a5f&page=queryresults
[0m00:29:42.503958 [debug] [Thread-1 (]: Timing info for model.credit.dim_customer (execute): 00:29:39.100290 => 00:29:42.503351
[0m00:29:42.507280 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a82749a6-14ad-4052-9285-336f8b0a8790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f932c944500>]}
[0m00:29:42.509899 [info ] [Thread-1 (]: 1 of 4 OK created sql table model credit.dim_customer .......................... [[32mCREATE TABLE (1.0 rows, 0 processed)[0m in 3.47s]
[0m00:29:42.514025 [debug] [Thread-1 (]: Finished running node model.credit.dim_customer
[0m00:29:42.522453 [debug] [Thread-1 (]: Began running node model.credit.dim_loanstatus
[0m00:29:42.524257 [info ] [Thread-1 (]: 2 of 4 START sql table model credit.dim_loanstatus ............................. [RUN]
[0m00:29:42.528309 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_customer, now model.credit.dim_loanstatus)
[0m00:29:42.530424 [debug] [Thread-1 (]: Began compiling node model.credit.dim_loanstatus
[0m00:29:42.549844 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_loanstatus"
[0m00:29:42.574113 [debug] [Thread-1 (]: Timing info for model.credit.dim_loanstatus (compile): 00:29:42.532492 => 00:29:42.573082
[0m00:29:42.576169 [debug] [Thread-1 (]: Began executing node model.credit.dim_loanstatus
[0m00:29:42.584326 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:29:43.003429 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_loanstatus"
[0m00:29:43.019850 [debug] [Thread-1 (]: On model.credit.dim_loanstatus: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_loanstatus"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`dim_loanstatus`
      
    
    

    OPTIONS()
    as (
      


SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast("Loan Status" as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Term as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as LoanStatusID,
	    "Loan Status" AS LoanStatus,
        'Term' AS Term

FROM `airflowcrtn`.`credit`.`raw_invoices`
WHERE "Loan Status" IS NOT NULL
    );
  
[0m00:29:43.522475 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:a7008604-8b60-4c31-ba9a-daf06b462a3d&page=queryresults
[0m00:29:45.665139 [debug] [Thread-1 (]: Timing info for model.credit.dim_loanstatus (execute): 00:29:42.577678 => 00:29:45.664499
[0m00:29:45.668085 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a82749a6-14ad-4052-9285-336f8b0a8790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f932c93a090>]}
[0m00:29:45.670279 [info ] [Thread-1 (]: 2 of 4 OK created sql table model credit.dim_loanstatus ........................ [[32mCREATE TABLE (2.0 rows, 1.1 MiB processed)[0m in 3.14s]
[0m00:29:45.673446 [debug] [Thread-1 (]: Finished running node model.credit.dim_loanstatus
[0m00:29:45.676092 [debug] [Thread-1 (]: Began running node model.credit.dim_purpose
[0m00:29:45.678085 [info ] [Thread-1 (]: 3 of 4 START sql table model credit.dim_purpose ................................ [RUN]
[0m00:29:45.681328 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_loanstatus, now model.credit.dim_purpose)
[0m00:29:45.683415 [debug] [Thread-1 (]: Began compiling node model.credit.dim_purpose
[0m00:29:45.698991 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_purpose"
[0m00:29:45.718698 [debug] [Thread-1 (]: Timing info for model.credit.dim_purpose (compile): 00:29:45.684828 => 00:29:45.717631
[0m00:29:45.720756 [debug] [Thread-1 (]: Began executing node model.credit.dim_purpose
[0m00:29:45.728429 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:29:46.163144 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_purpose"
[0m00:29:46.185895 [debug] [Thread-1 (]: On model.credit.dim_purpose: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_purpose"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`dim_purpose`
      
    
    

    OPTIONS()
    as (
      

SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast(Purpose as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as PurposeID,
		'Purpose ' AS Purpose 
FROM `airflowcrtn`.`credit`.`raw_invoices`
WHERE Purpose  IS NOT NULL
    );
  
[0m00:29:46.924707 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:81e3eefd-bfba-4e96-835a-e603329f2d6f&page=queryresults
[0m00:29:49.261469 [debug] [Thread-1 (]: Timing info for model.credit.dim_purpose (execute): 00:29:45.722108 => 00:29:49.260325
[0m00:29:49.265735 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a82749a6-14ad-4052-9285-336f8b0a8790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f932c93a270>]}
[0m00:29:49.268939 [info ] [Thread-1 (]: 3 of 4 OK created sql table model credit.dim_purpose ........................... [[32mCREATE TABLE (16.0 rows, 1.7 MiB processed)[0m in 3.59s]
[0m00:29:49.272594 [debug] [Thread-1 (]: Finished running node model.credit.dim_purpose
[0m00:29:49.278304 [debug] [Thread-1 (]: Began running node model.credit.fact_invoices
[0m00:29:49.280744 [info ] [Thread-1 (]: 4 of 4 START sql table model credit.fact_invoices .............................. [RUN]
[0m00:29:49.286711 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_purpose, now model.credit.fact_invoices)
[0m00:29:49.289578 [debug] [Thread-1 (]: Began compiling node model.credit.fact_invoices
[0m00:29:49.342983 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.fact_invoices"
[0m00:29:49.366904 [debug] [Thread-1 (]: Timing info for model.credit.fact_invoices (compile): 00:29:49.292540 => 00:29:49.364421
[0m00:29:49.370190 [debug] [Thread-1 (]: Began executing node model.credit.fact_invoices
[0m00:29:49.382221 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:29:49.864743 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.fact_invoices"
[0m00:29:49.884440 [debug] [Thread-1 (]: On model.credit.fact_invoices: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.fact_invoices"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`fact_invoices`
      
    
    

    OPTIONS()
    as (
      


WITH fct_invoices_cte AS (
    SELECT DISTINCT
        "Loan ID" AS LoanID,
        "Customer ID" AS CustomerID,
        to_hex(md5(cast(coalesce(cast("Loan Status" as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Term as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as LoanStatusID,
        to_hex(md5(cast(coalesce(cast(Purpose as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as PurposeID,
        "Current Loan Amount" AS CurrentLoanAmount,
        "Credit Score" AS CreditScore,
        "Annual Income" AS AnnualIncome,
        "Monthly Debt" AS MonthlyDebt,
        "Years of Credit History" AS YearsofCreditHistory,
        "Months since last delinquent" AS Monthssincelastdelinquent,
        "Number of Open Accounts" AS NumberofOpenAccounts,
        "Number of Credit Problems" AS NumberofCreditProblems,
        "Current Credit Balance" AS CurrentCreditBalance,
        "Maximum Open Credit" AS MaximumOpenCredit,
        "Bankruptcies" AS Bankruptcies,
        "Tax Liens" AS TaxLiens       
      
    FROM `airflowcrtn`.`credit`.`raw_invoices`
    
)
SELECT
   fi.*
FROM fct_invoices_cte fi
INNER JOIN `airflowcrtn`.`credit`.`dim_purpose` dt ON fi.PurposeID = dt.PurposeID
INNER JOIN `airflowcrtn`.`credit`.`dim_loanstatus` dp ON fi.LoanStatusID = dp.LoanStatusID
INNER JOIN `airflowcrtn`.`credit`.`dim_customer` dc ON fi.CustomerID = dc.CustomerID
    );
  
[0m00:29:50.418057 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:526f1169-90d9-43e0-bb5c-92bbc6ee1075&page=queryresults
[0m00:29:53.060017 [debug] [Thread-1 (]: Timing info for model.credit.fact_invoices (execute): 00:29:49.372252 => 00:29:53.058675
[0m00:29:53.064224 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a82749a6-14ad-4052-9285-336f8b0a8790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f931efb4200>]}
[0m00:29:53.068731 [info ] [Thread-1 (]: 4 of 4 OK created sql table model credit.fact_invoices ......................... [[32mCREATE TABLE (32.0 rows, 2.9 MiB processed)[0m in 3.78s]
[0m00:29:53.072938 [debug] [Thread-1 (]: Finished running node model.credit.fact_invoices
[0m00:29:53.091942 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:29:53.095433 [debug] [MainThread]: Connection 'model.credit.fact_invoices' was properly closed.
[0m00:29:53.098319 [info ] [MainThread]: 
[0m00:29:53.107288 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 15.01 seconds (15.01s).
[0m00:29:53.128636 [debug] [MainThread]: Command end result
[0m00:29:53.247177 [info ] [MainThread]: 
[0m00:29:53.249615 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:29:53.252120 [info ] [MainThread]: 
[0m00:29:53.254298 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m00:29:53.257755 [debug] [MainThread]: Command `dbt run` succeeded at 00:29:53.256990 after 20.96 seconds
[0m00:29:53.260170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f932ec51160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f932cc5ab40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f932ca6c680>]}
[0m00:29:53.261992 [debug] [MainThread]: Flushing usage events
[0m00:30:48.613690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc95d393dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc95deeac60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc95ebe8ad0>]}


============================== 00:30:48.619543 | 5f5e1e74-9949-4859-ac0c-da9e963bd0af ==============================
[0m00:30:48.619543 [info ] [MainThread]: Running with dbt=1.6.18
[0m00:30:48.621673 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'no_print': 'None', 'static_parser': 'True', 'quiet': 'False', 'target_path': 'None', 'use_experimental_parser': 'False', 'use_colors': 'True', 'cache_selected_only': 'False', 'version_check': 'True', 'log_format': 'default', 'write_json': 'True', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'debug': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': '/usr/local/airflow/include/dbt/logs', 'partial_parse': 'True', 'printer_width': '80'}
[0m00:30:50.071145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f5e1e74-9949-4859-ac0c-da9e963bd0af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc95b6cfd70>]}
[0m00:30:50.115976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f5e1e74-9949-4859-ac0c-da9e963bd0af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc95b4d5e50>]}
[0m00:30:50.119368 [info ] [MainThread]: Registered adapter: bigquery=1.6.0
[0m00:30:50.211231 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m00:30:52.298581 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:30:52.300524 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:30:52.303218 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.retail
[0m00:30:52.320525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f5e1e74-9949-4859-ac0c-da9e963bd0af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc95b4f8170>]}
[0m00:30:52.395405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f5e1e74-9949-4859-ac0c-da9e963bd0af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc95b51a060>]}
[0m00:30:52.397270 [info ] [MainThread]: Found 4 models, 1 source, 0 exposures, 0 metrics, 509 macros, 0 groups, 0 semantic models
[0m00:30:52.399166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f5e1e74-9949-4859-ac0c-da9e963bd0af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc95b6a0890>]}
[0m00:30:52.404760 [info ] [MainThread]: 
[0m00:30:52.408672 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:30:52.413992 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflowcrtn'
[0m00:30:52.415640 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:30:52.939383 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflowcrtn, now list_airflowcrtn_credit)
[0m00:30:52.941295 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:30:53.374949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f5e1e74-9949-4859-ac0c-da9e963bd0af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc95b4724b0>]}
[0m00:30:53.379571 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:30:53.382717 [info ] [MainThread]: 
[0m00:30:53.401711 [debug] [Thread-1 (]: Began running node model.credit.dim_customer
[0m00:30:53.404725 [info ] [Thread-1 (]: 1 of 4 START sql table model credit.dim_customer ............................... [RUN]
[0m00:30:53.408604 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflowcrtn_credit, now model.credit.dim_customer)
[0m00:30:53.411086 [debug] [Thread-1 (]: Began compiling node model.credit.dim_customer
[0m00:30:53.455312 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_customer"
[0m00:30:53.472675 [debug] [Thread-1 (]: Timing info for model.credit.dim_customer (compile): 00:30:53.413168 => 00:30:53.471505
[0m00:30:53.474775 [debug] [Thread-1 (]: Began executing node model.credit.dim_customer
[0m00:30:53.550172 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:30:54.053926 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_customer"
[0m00:30:54.067911 [debug] [Thread-1 (]: On model.credit.dim_customer: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_customer"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`dim_customer`
      
    
    

    OPTIONS()
    as (
      


SELECT DISTINCT
	    'Customer ID' as CustomerID,
	    'Years in Current Job' as YearsinCurrentJob,
         'Home Ownership' as HomeOwnership
	FROM `airflowcrtn`.`credit`.`raw_invoices`
	WHERE 'Customer ID' IS NOT NULL
    );
  
[0m00:30:54.835496 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:1d7bef5b-ff30-45c1-a267-c54195c5f692&page=queryresults
[0m00:30:58.292970 [debug] [Thread-1 (]: Timing info for model.credit.dim_customer (execute): 00:30:53.476154 => 00:30:58.292011
[0m00:30:58.296719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f5e1e74-9949-4859-ac0c-da9e963bd0af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc95b36a1b0>]}
[0m00:30:58.299053 [info ] [Thread-1 (]: 1 of 4 OK created sql table model credit.dim_customer .......................... [[32mCREATE TABLE (1.0 rows, 0 processed)[0m in 4.89s]
[0m00:30:58.302240 [debug] [Thread-1 (]: Finished running node model.credit.dim_customer
[0m00:30:58.304678 [debug] [Thread-1 (]: Began running node model.credit.dim_loanstatus
[0m00:30:58.307534 [info ] [Thread-1 (]: 2 of 4 START sql table model credit.dim_loanstatus ............................. [RUN]
[0m00:30:58.312993 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_customer, now model.credit.dim_loanstatus)
[0m00:30:58.314878 [debug] [Thread-1 (]: Began compiling node model.credit.dim_loanstatus
[0m00:30:58.383421 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_loanstatus"
[0m00:30:58.407478 [debug] [Thread-1 (]: Timing info for model.credit.dim_loanstatus (compile): 00:30:58.316246 => 00:30:58.406535
[0m00:30:58.409537 [debug] [Thread-1 (]: Began executing node model.credit.dim_loanstatus
[0m00:30:58.417581 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:30:58.876225 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_loanstatus"
[0m00:30:58.897747 [debug] [Thread-1 (]: On model.credit.dim_loanstatus: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_loanstatus"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`dim_loanstatus`
      
    
    

    OPTIONS()
    as (
      


SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast("Loan Status" as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Term as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as LoanStatusID,
	    "Loan Status" AS LoanStatus,
        'Term' AS Term

FROM `airflowcrtn`.`credit`.`raw_invoices`
WHERE "Loan Status" IS NOT NULL
    );
  
[0m00:30:59.461234 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:096cbf93-8b4e-4f7b-bc64-e517c07b558c&page=queryresults
[0m00:31:01.869692 [debug] [Thread-1 (]: Timing info for model.credit.dim_loanstatus (execute): 00:30:58.411106 => 00:31:01.869070
[0m00:31:01.872561 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f5e1e74-9949-4859-ac0c-da9e963bd0af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc95b2f7860>]}
[0m00:31:01.874740 [info ] [Thread-1 (]: 2 of 4 OK created sql table model credit.dim_loanstatus ........................ [[32mCREATE TABLE (2.0 rows, 1.1 MiB processed)[0m in 3.56s]
[0m00:31:01.877583 [debug] [Thread-1 (]: Finished running node model.credit.dim_loanstatus
[0m00:31:01.880063 [debug] [Thread-1 (]: Began running node model.credit.dim_purpose
[0m00:31:01.881793 [info ] [Thread-1 (]: 3 of 4 START sql table model credit.dim_purpose ................................ [RUN]
[0m00:31:01.884670 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_loanstatus, now model.credit.dim_purpose)
[0m00:31:01.886358 [debug] [Thread-1 (]: Began compiling node model.credit.dim_purpose
[0m00:31:01.904816 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_purpose"
[0m00:31:01.928490 [debug] [Thread-1 (]: Timing info for model.credit.dim_purpose (compile): 00:31:01.887630 => 00:31:01.927262
[0m00:31:01.930600 [debug] [Thread-1 (]: Began executing node model.credit.dim_purpose
[0m00:31:01.937950 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:02.381075 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_purpose"
[0m00:31:02.400581 [debug] [Thread-1 (]: On model.credit.dim_purpose: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_purpose"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`dim_purpose`
      
    
    

    OPTIONS()
    as (
      

SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast(Purpose as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as PurposeID,
		'Purpose ' AS Purpose 
FROM `airflowcrtn`.`credit`.`raw_invoices`
WHERE Purpose  IS NOT NULL
    );
  
[0m00:30:51.803311 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:0554fd27-9057-4dfe-92f2-c7a3e3c36169&page=queryresults
[0m00:30:54.276092 [debug] [Thread-1 (]: Timing info for model.credit.dim_purpose (execute): 00:31:01.931988 => 00:30:54.275475
[0m00:30:54.279274 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f5e1e74-9949-4859-ac0c-da9e963bd0af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc95dfdec90>]}
[0m00:30:54.281738 [info ] [Thread-1 (]: 3 of 4 OK created sql table model credit.dim_purpose ........................... [[32mCREATE TABLE (16.0 rows, 1.7 MiB processed)[0m in -7.60s]
[0m00:30:54.284937 [debug] [Thread-1 (]: Finished running node model.credit.dim_purpose
[0m00:30:54.288747 [debug] [Thread-1 (]: Began running node model.credit.fact_invoices
[0m00:30:54.290727 [info ] [Thread-1 (]: 4 of 4 START sql table model credit.fact_invoices .............................. [RUN]
[0m00:30:54.294401 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_purpose, now model.credit.fact_invoices)
[0m00:30:54.296697 [debug] [Thread-1 (]: Began compiling node model.credit.fact_invoices
[0m00:30:54.334949 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.fact_invoices"
[0m00:30:54.394298 [debug] [Thread-1 (]: Timing info for model.credit.fact_invoices (compile): 00:30:54.298161 => 00:30:54.392927
[0m00:30:54.396745 [debug] [Thread-1 (]: Began executing node model.credit.fact_invoices
[0m00:30:54.407256 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:30:54.891771 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.fact_invoices"
[0m00:30:54.919668 [debug] [Thread-1 (]: On model.credit.fact_invoices: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.fact_invoices"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`fact_invoices`
      
    
    

    OPTIONS()
    as (
      


WITH fct_invoices_cte AS (
    SELECT DISTINCT
        "Loan ID" AS LoanID,
        "Customer ID" AS CustomerID,
        to_hex(md5(cast(coalesce(cast("Loan Status" as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Term as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as LoanStatusID,
        to_hex(md5(cast(coalesce(cast(Purpose as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as PurposeID,
        "Current Loan Amount" AS CurrentLoanAmount,
        "Credit Score" AS CreditScore,
        "Annual Income" AS AnnualIncome,
        "Monthly Debt" AS MonthlyDebt,
        "Years of Credit History" AS YearsofCreditHistory,
        "Months since last delinquent" AS Monthssincelastdelinquent,
        "Number of Open Accounts" AS NumberofOpenAccounts,
        "Number of Credit Problems" AS NumberofCreditProblems,
        "Current Credit Balance" AS CurrentCreditBalance,
        "Maximum Open Credit" AS MaximumOpenCredit,
        "Bankruptcies" AS Bankruptcies,
        "Tax Liens" AS TaxLiens       
      
    FROM `airflowcrtn`.`credit`.`raw_invoices`
    
)
SELECT
   fi.*
FROM fct_invoices_cte fi
INNER JOIN `airflowcrtn`.`credit`.`dim_purpose` dt ON fi.PurposeID = dt.PurposeID
INNER JOIN `airflowcrtn`.`credit`.`dim_loanstatus` dp ON fi.LoanStatusID = dp.LoanStatusID
INNER JOIN `airflowcrtn`.`credit`.`dim_customer` dc ON fi.CustomerID = dc.CustomerID
    );
  
[0m00:30:55.518652 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:4763f160-588a-4e2c-a12c-618cd7bdcf83&page=queryresults
[0m00:30:58.085114 [debug] [Thread-1 (]: Timing info for model.credit.fact_invoices (execute): 00:30:54.398361 => 00:30:58.084409
[0m00:30:58.088313 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f5e1e74-9949-4859-ac0c-da9e963bd0af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc959148530>]}
[0m00:30:58.090547 [info ] [Thread-1 (]: 4 of 4 OK created sql table model credit.fact_invoices ......................... [[32mCREATE TABLE (32.0 rows, 2.9 MiB processed)[0m in 3.80s]
[0m00:30:58.093754 [debug] [Thread-1 (]: Finished running node model.credit.fact_invoices
[0m00:30:58.100739 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:30:58.102595 [debug] [MainThread]: Connection 'model.credit.fact_invoices' was properly closed.
[0m00:30:58.104232 [info ] [MainThread]: 
[0m00:30:58.105977 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 5.70 seconds (5.70s).
[0m00:30:58.117436 [debug] [MainThread]: Command end result
[0m00:30:58.196179 [info ] [MainThread]: 
[0m00:30:58.198312 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:30:58.200243 [info ] [MainThread]: 
[0m00:30:58.202170 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m00:30:58.204765 [debug] [MainThread]: Command `dbt run` succeeded at 00:30:58.204175 after 21.28 seconds
[0m00:30:58.209530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc961faae40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc95b543fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc95b708b00>]}
[0m00:30:58.211660 [debug] [MainThread]: Flushing usage events
[0m00:33:12.286615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff650be2600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff652b0d3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6510ae8a0>]}


============================== 00:33:12.291626 | 1d633429-bce3-4c71-af1b-c94a02e78dd6 ==============================
[0m00:33:12.291626 [info ] [MainThread]: Running with dbt=1.6.18
[0m00:33:12.293761 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'warn_error': 'None', 'cache_selected_only': 'False', 'invocation_command': 'dbt source freshness', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'use_colors': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'static_parser': 'True', 'write_json': 'True', 'printer_width': '80', 'log_format': 'default', 'quiet': 'False', 'introspect': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt', 'debug': 'False'}
[0m00:33:13.736433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1d633429-bce3-4c71-af1b-c94a02e78dd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff650be2b70>]}
[0m00:33:13.783530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1d633429-bce3-4c71-af1b-c94a02e78dd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff64ed36990>]}
[0m00:33:13.786130 [info ] [MainThread]: Registered adapter: bigquery=1.6.0
[0m00:33:13.881113 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m00:33:15.879408 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:33:15.881249 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:33:15.883670 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.retail
[0m00:33:15.902577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1d633429-bce3-4c71-af1b-c94a02e78dd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff64eb44bc0>]}
[0m00:33:15.973431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1d633429-bce3-4c71-af1b-c94a02e78dd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff64eb80110>]}
[0m00:33:15.975566 [info ] [MainThread]: Found 4 models, 1 source, 0 exposures, 0 metrics, 509 macros, 0 groups, 0 semantic models
[0m00:33:15.977550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d633429-bce3-4c71-af1b-c94a02e78dd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff64eb81700>]}
[0m00:33:15.982827 [info ] [MainThread]: 
[0m00:33:15.984477 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m00:33:16.039773 [info ] [MainThread]: Done.
[0m00:33:16.042866 [debug] [MainThread]: Command `dbt source freshness` succeeded at 00:33:16.042269 after 4.31 seconds
[0m00:33:16.044673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff652ae41d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff64ed8e540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff64edbf6e0>]}
[0m00:33:16.046424 [debug] [MainThread]: Flushing usage events
[0m00:40:42.373879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb79ebde600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7a360b320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb79f024620>]}


============================== 00:40:42.379374 | f1d8c2a0-2988-4f42-b61e-401a0b250b1a ==============================
[0m00:40:42.379374 [info ] [MainThread]: Running with dbt=1.6.18
[0m00:40:42.381424 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'write_json': 'True', 'target_path': 'None', 'cache_selected_only': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'no_print': 'None', 'debug': 'False', 'version_check': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'printer_width': '80', 'fail_fast': 'False', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_format': 'default', 'use_experimental_parser': 'False'}
[0m00:40:43.827825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f1d8c2a0-2988-4f42-b61e-401a0b250b1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb79cd587a0>]}
[0m00:40:43.870465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f1d8c2a0-2988-4f42-b61e-401a0b250b1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb79cd2c4a0>]}
[0m00:40:43.872795 [info ] [MainThread]: Registered adapter: bigquery=1.6.0
[0m00:40:43.968167 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m00:40:44.032650 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m00:40:44.034491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f1d8c2a0-2988-4f42-b61e-401a0b250b1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb79cf1ba10>]}
[0m00:40:49.099539 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.retail
- sources.Airflowcrtn.credit
[0m00:40:49.120186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f1d8c2a0-2988-4f42-b61e-401a0b250b1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb79ca9bbc0>]}
[0m00:40:49.184161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f1d8c2a0-2988-4f42-b61e-401a0b250b1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb79cad70b0>]}
[0m00:40:49.186116 [info ] [MainThread]: Found 4 models, 1 source, 0 exposures, 0 metrics, 509 macros, 0 groups, 0 semantic models
[0m00:40:49.187849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1d8c2a0-2988-4f42-b61e-401a0b250b1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb79cb4a7e0>]}
[0m00:40:49.194085 [info ] [MainThread]: 
[0m00:40:49.198281 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:40:49.202912 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflowcrtn'
[0m00:40:49.204413 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:40:49.742352 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflowcrtn, now list_airflowcrtn_credit)
[0m00:40:49.744452 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:40:50.237847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1d8c2a0-2988-4f42-b61e-401a0b250b1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb79cb896a0>]}
[0m00:40:50.240863 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:40:50.242548 [info ] [MainThread]: 
[0m00:40:50.249756 [debug] [Thread-1 (]: Began running node model.credit.dim_customer
[0m00:40:50.251830 [info ] [Thread-1 (]: 1 of 4 START sql table model credit.dim_customer ............................... [RUN]
[0m00:40:50.254750 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflowcrtn_credit, now model.credit.dim_customer)
[0m00:40:50.256715 [debug] [Thread-1 (]: Began compiling node model.credit.dim_customer
[0m00:40:50.286301 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_customer"
[0m00:40:50.310463 [debug] [Thread-1 (]: Timing info for model.credit.dim_customer (compile): 00:40:50.258610 => 00:40:50.309273
[0m00:40:50.312521 [debug] [Thread-1 (]: Began executing node model.credit.dim_customer
[0m00:40:50.355566 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:40:50.896022 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_customer"
[0m00:40:50.917717 [debug] [Thread-1 (]: On model.credit.dim_customer: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_customer"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`dim_customer`
      
    
    

    OPTIONS()
    as (
      


SELECT DISTINCT
	    'Customer ID' as CustomerID,
	    'Years in Current Job' as YearsinCurrentJob,
         'Home Ownership' as HomeOwnership
	FROM `airflowcrtn`.`credit`.`raw_invoices`
	WHERE 'Customer ID' IS NOT NULL
    );
  
[0m00:40:51.625601 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:f250aa88-9b20-4fc8-ae19-eac482fe7494&page=queryresults
[0m00:40:54.022479 [debug] [Thread-1 (]: Timing info for model.credit.dim_customer (execute): 00:40:50.313903 => 00:40:54.021748
[0m00:40:54.025623 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1d8c2a0-2988-4f42-b61e-401a0b250b1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb79cba4680>]}
[0m00:40:54.027972 [info ] [Thread-1 (]: 1 of 4 OK created sql table model credit.dim_customer .......................... [[32mCREATE TABLE (1.0 rows, 0 processed)[0m in 3.77s]
[0m00:40:54.031641 [debug] [Thread-1 (]: Finished running node model.credit.dim_customer
[0m00:40:54.034699 [debug] [Thread-1 (]: Began running node model.credit.dim_loanstatus
[0m00:40:54.036516 [info ] [Thread-1 (]: 2 of 4 START sql table model credit.dim_loanstatus ............................. [RUN]
[0m00:40:54.039589 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_customer, now model.credit.dim_loanstatus)
[0m00:40:54.041571 [debug] [Thread-1 (]: Began compiling node model.credit.dim_loanstatus
[0m00:40:54.060200 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_loanstatus"
[0m00:40:54.083197 [debug] [Thread-1 (]: Timing info for model.credit.dim_loanstatus (compile): 00:40:54.042862 => 00:40:54.082194
[0m00:40:54.085249 [debug] [Thread-1 (]: Began executing node model.credit.dim_loanstatus
[0m00:40:54.093967 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:40:54.522939 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_loanstatus"
[0m00:40:54.538411 [debug] [Thread-1 (]: On model.credit.dim_loanstatus: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_loanstatus"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`dim_loanstatus`
      
    
    

    OPTIONS()
    as (
      


SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast("Loan Status" as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Term as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as LoanStatusID,
	    "Loan Status" AS LoanStatus,
        'Term' AS Term

FROM `airflowcrtn`.`credit`.`raw_invoices`
WHERE "Loan Status" IS NOT NULL
    );
  
[0m00:40:55.398188 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:46e063d6-2c7b-44c7-8e12-814326c53d2a&page=queryresults
[0m00:40:57.401807 [debug] [Thread-1 (]: Timing info for model.credit.dim_loanstatus (execute): 00:40:54.086698 => 00:40:57.401177
[0m00:40:57.404699 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1d8c2a0-2988-4f42-b61e-401a0b250b1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb78f10ffb0>]}
[0m00:40:57.406743 [info ] [Thread-1 (]: 2 of 4 OK created sql table model credit.dim_loanstatus ........................ [[32mCREATE TABLE (2.0 rows, 1.1 MiB processed)[0m in 3.37s]
[0m00:40:57.410689 [debug] [Thread-1 (]: Finished running node model.credit.dim_loanstatus
[0m00:40:57.412680 [debug] [Thread-1 (]: Began running node model.credit.dim_purpose
[0m00:40:57.414404 [info ] [Thread-1 (]: 3 of 4 START sql table model credit.dim_purpose ................................ [RUN]
[0m00:40:57.417892 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_loanstatus, now model.credit.dim_purpose)
[0m00:40:57.419893 [debug] [Thread-1 (]: Began compiling node model.credit.dim_purpose
[0m00:40:57.436771 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_purpose"
[0m00:40:57.459280 [debug] [Thread-1 (]: Timing info for model.credit.dim_purpose (compile): 00:40:57.421303 => 00:40:57.458251
[0m00:40:57.461230 [debug] [Thread-1 (]: Began executing node model.credit.dim_purpose
[0m00:40:57.477312 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:40:57.935828 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_purpose"
[0m00:40:57.953200 [debug] [Thread-1 (]: On model.credit.dim_purpose: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_purpose"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`dim_purpose`
      
    
    

    OPTIONS()
    as (
      

SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast(Purpose as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as PurposeID,
		'Purpose' AS Purpose 
FROM `airflowcrtn`.`credit`.`raw_invoices`
WHERE Purpose  IS NOT NULL
    );
  
[0m00:40:58.517802 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:a3205949-ccbe-4965-8649-bc11cdc6cb3c&page=queryresults
[0m00:41:00.918531 [debug] [Thread-1 (]: Timing info for model.credit.dim_purpose (execute): 00:40:57.462836 => 00:41:00.917043
[0m00:41:00.923938 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1d8c2a0-2988-4f42-b61e-401a0b250b1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb78f19a600>]}
[0m00:41:00.927065 [info ] [Thread-1 (]: 3 of 4 OK created sql table model credit.dim_purpose ........................... [[32mCREATE TABLE (16.0 rows, 1.7 MiB processed)[0m in 3.51s]
[0m00:41:00.930778 [debug] [Thread-1 (]: Finished running node model.credit.dim_purpose
[0m00:41:00.936515 [debug] [Thread-1 (]: Began running node model.credit.fact_invoices
[0m00:41:00.938859 [info ] [Thread-1 (]: 4 of 4 START sql table model credit.fact_invoices .............................. [RUN]
[0m00:41:00.942592 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_purpose, now model.credit.fact_invoices)
[0m00:41:00.944701 [debug] [Thread-1 (]: Began compiling node model.credit.fact_invoices
[0m00:41:00.983722 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.fact_invoices"
[0m00:41:01.005587 [debug] [Thread-1 (]: Timing info for model.credit.fact_invoices (compile): 00:41:00.946169 => 00:41:01.003947
[0m00:41:01.008218 [debug] [Thread-1 (]: Began executing node model.credit.fact_invoices
[0m00:41:01.019419 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:41:01.461137 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.fact_invoices"
[0m00:41:01.484710 [debug] [Thread-1 (]: On model.credit.fact_invoices: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.fact_invoices"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`fact_invoices`
      
    
    

    OPTIONS()
    as (
      


WITH fct_invoices_cte AS (
    SELECT DISTINCT
        "Loan ID" AS LoanID,
        "Customer ID" AS CustomerID,
        to_hex(md5(cast(coalesce(cast("Loan Status" as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Term as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as LoanStatusID,
        to_hex(md5(cast(coalesce(cast(Purpose as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as PurposeID,
        "Current Loan Amount" AS CurrentLoanAmount,
        "Credit Score" AS CreditScore,
        "Annual Income" AS AnnualIncome,
        "Monthly Debt" AS MonthlyDebt,
        "Years of Credit History" AS YearsofCreditHistory,
        "Months since last delinquent" AS Monthssincelastdelinquent,
        "Number of Open Accounts" AS NumberofOpenAccounts,
        "Number of Credit Problems" AS NumberofCreditProblems,
        "Current Credit Balance" AS CurrentCreditBalance,
        "Maximum Open Credit" AS MaximumOpenCredit,
        "Bankruptcies" AS Bankruptcies,
        "Tax Liens" AS TaxLiens       
      
    FROM `airflowcrtn`.`credit`.`raw_invoices`
    
)
SELECT
   fi.*
FROM fct_invoices_cte fi
INNER JOIN `airflowcrtn`.`credit`.`dim_purpose` dt ON fi.PurposeID = dt.PurposeID
INNER JOIN `airflowcrtn`.`credit`.`dim_loanstatus` dp ON fi.LoanStatusID = dp.LoanStatusID
INNER JOIN `airflowcrtn`.`credit`.`dim_customer` dc ON fi.CustomerID = dc.CustomerID
    );
  
[0m00:41:02.012423 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:f697892d-043d-4598-9901-1c7a214916e9&page=queryresults
[0m00:41:05.357782 [debug] [Thread-1 (]: Timing info for model.credit.fact_invoices (execute): 00:41:01.009854 => 00:41:05.356831
[0m00:41:05.361020 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1d8c2a0-2988-4f42-b61e-401a0b250b1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb78f1987a0>]}
[0m00:41:05.363420 [info ] [Thread-1 (]: 4 of 4 OK created sql table model credit.fact_invoices ......................... [[32mCREATE TABLE (32.0 rows, 2.9 MiB processed)[0m in 4.42s]
[0m00:41:05.366597 [debug] [Thread-1 (]: Finished running node model.credit.fact_invoices
[0m00:41:05.377964 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:41:05.379622 [debug] [MainThread]: Connection 'model.credit.fact_invoices' was properly closed.
[0m00:41:05.381638 [info ] [MainThread]: 
[0m00:41:05.383777 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 16.19 seconds (16.19s).
[0m00:41:05.391659 [debug] [MainThread]: Command end result
[0m00:41:05.454536 [info ] [MainThread]: 
[0m00:41:05.456847 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:41:05.459263 [info ] [MainThread]: 
[0m00:41:05.461454 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m00:41:05.465429 [debug] [MainThread]: Command `dbt run` succeeded at 00:41:05.464571 after 25.16 seconds
[0m00:41:05.467457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb79fc3b2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb79cbdd3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb78f118380>]}
[0m00:41:05.469727 [debug] [MainThread]: Flushing usage events
[0m00:52:13.894172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1239fcf590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f123a5f6270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f123a29f950>]}


============================== 00:52:13.899324 | 2444621c-53ce-4ebc-b392-d9b9ae2cc528 ==============================
[0m00:52:13.899324 [info ] [MainThread]: Running with dbt=1.6.18
[0m00:52:13.901649 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'log_path': '/usr/local/airflow/include/dbt/logs', 'partial_parse': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'quiet': 'False', 'cache_selected_only': 'False', 'write_json': 'True', 'log_format': 'default', 'log_cache_events': 'False', 'target_path': 'None', 'debug': 'False'}
[0m00:52:15.440954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2444621c-53ce-4ebc-b392-d9b9ae2cc528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12381ddf10>]}
[0m00:52:15.484098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2444621c-53ce-4ebc-b392-d9b9ae2cc528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1238a6e060>]}
[0m00:52:15.487009 [info ] [MainThread]: Registered adapter: bigquery=1.6.0
[0m00:52:15.587543 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m00:52:15.653522 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m00:52:15.655459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2444621c-53ce-4ebc-b392-d9b9ae2cc528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1237e7c320>]}
[0m00:52:21.333119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2444621c-53ce-4ebc-b392-d9b9ae2cc528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1237e99b50>]}
[0m00:52:21.406689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2444621c-53ce-4ebc-b392-d9b9ae2cc528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1237e99ee0>]}
[0m00:52:21.408695 [info ] [MainThread]: Found 4 models, 1 source, 0 exposures, 0 metrics, 509 macros, 0 groups, 0 semantic models
[0m00:52:21.410650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2444621c-53ce-4ebc-b392-d9b9ae2cc528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1237e90320>]}
[0m00:52:21.418029 [info ] [MainThread]: 
[0m00:52:21.421627 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:52:21.427241 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflowcrtn'
[0m00:52:21.428878 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:52:21.987720 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflowcrtn, now list_airflowcrtn_credit)
[0m00:52:21.989734 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:52:22.535211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2444621c-53ce-4ebc-b392-d9b9ae2cc528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12381dfe60>]}
[0m00:52:22.538602 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:52:22.540588 [info ] [MainThread]: 
[0m00:52:22.550576 [debug] [Thread-1 (]: Began running node model.credit.dim_customer
[0m00:52:22.553248 [info ] [Thread-1 (]: 1 of 4 START sql table model credit.dim_customer ............................... [RUN]
[0m00:52:22.556797 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflowcrtn_credit, now model.credit.dim_customer)
[0m00:52:22.558708 [debug] [Thread-1 (]: Began compiling node model.credit.dim_customer
[0m00:52:22.587518 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_customer"
[0m00:52:22.613655 [debug] [Thread-1 (]: Timing info for model.credit.dim_customer (compile): 00:52:22.560510 => 00:52:22.612553
[0m00:52:22.615802 [debug] [Thread-1 (]: Began executing node model.credit.dim_customer
[0m00:52:22.663887 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:52:22.727746 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_customer"
[0m00:52:22.752063 [debug] [Thread-1 (]: On model.credit.dim_customer: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_customer"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`dim_customer`
      
    
    

    OPTIONS()
    as (
      


SELECT DISTINCT
	    'Customer ID' as CustomerID,
	    'Years in Current Job' as YearsinCurrentJob,
         'Home Ownership' as HomeOwnership
	FROM `airflowcrtn`.`credit`.`raw_invoices`
	WHERE 'Customer ID' IS NOT NULL
    );
  
[0m00:52:23.266089 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:a504d522-c4b9-4617-9440-6a9b6ce61c92&page=queryresults
[0m00:52:25.755738 [debug] [Thread-1 (]: Timing info for model.credit.dim_customer (execute): 00:52:22.617348 => 00:52:25.755081
[0m00:52:25.758997 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2444621c-53ce-4ebc-b392-d9b9ae2cc528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1237f09430>]}
[0m00:52:25.761417 [info ] [Thread-1 (]: 1 of 4 OK created sql table model credit.dim_customer .......................... [[32mCREATE TABLE (1.0 rows, 0 processed)[0m in 3.20s]
[0m00:52:25.764509 [debug] [Thread-1 (]: Finished running node model.credit.dim_customer
[0m00:52:25.766702 [debug] [Thread-1 (]: Began running node model.credit.dim_loanstatus
[0m00:52:25.775817 [info ] [Thread-1 (]: 2 of 4 START sql table model credit.dim_loanstatus ............................. [RUN]
[0m00:52:25.778629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_customer, now model.credit.dim_loanstatus)
[0m00:52:25.780315 [debug] [Thread-1 (]: Began compiling node model.credit.dim_loanstatus
[0m00:52:25.796654 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_loanstatus"
[0m00:52:25.819255 [debug] [Thread-1 (]: Timing info for model.credit.dim_loanstatus (compile): 00:52:25.781547 => 00:52:25.817840
[0m00:52:25.821385 [debug] [Thread-1 (]: Began executing node model.credit.dim_loanstatus
[0m00:52:25.829379 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:52:26.298206 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_loanstatus"
[0m00:52:26.316532 [debug] [Thread-1 (]: On model.credit.dim_loanstatus: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_loanstatus"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`dim_loanstatus`
      
    
    

    OPTIONS()
    as (
      


SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast("Loan Status" as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Term as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as LoanStatusID,
	    "Loan Status" AS LoanStatus,
        'Term' AS Term

FROM `airflowcrtn`.`credit`.`raw_invoices`
WHERE "Loan Status" IS NOT NULL
    );
  
[0m00:52:27.123547 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:5d120565-f845-47f2-a7f1-0028ed86da37&page=queryresults
[0m00:52:29.069668 [debug] [Thread-1 (]: Timing info for model.credit.dim_loanstatus (execute): 00:52:25.822705 => 00:52:29.069031
[0m00:52:29.073118 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2444621c-53ce-4ebc-b392-d9b9ae2cc528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f123653a420>]}
[0m00:52:29.075266 [info ] [Thread-1 (]: 2 of 4 OK created sql table model credit.dim_loanstatus ........................ [[32mCREATE TABLE (2.0 rows, 1.1 MiB processed)[0m in 3.30s]
[0m00:52:29.078002 [debug] [Thread-1 (]: Finished running node model.credit.dim_loanstatus
[0m00:52:29.080217 [debug] [Thread-1 (]: Began running node model.credit.dim_purpose
[0m00:52:29.082111 [info ] [Thread-1 (]: 3 of 4 START sql table model credit.dim_purpose ................................ [RUN]
[0m00:52:29.085007 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_loanstatus, now model.credit.dim_purpose)
[0m00:52:29.087123 [debug] [Thread-1 (]: Began compiling node model.credit.dim_purpose
[0m00:52:29.104820 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_purpose"
[0m00:52:29.127468 [debug] [Thread-1 (]: Timing info for model.credit.dim_purpose (compile): 00:52:29.088514 => 00:52:29.126341
[0m00:52:29.129443 [debug] [Thread-1 (]: Began executing node model.credit.dim_purpose
[0m00:52:29.149670 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:52:29.623334 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_purpose"
[0m00:52:29.643268 [debug] [Thread-1 (]: On model.credit.dim_purpose: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_purpose"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`dim_purpose`
      
    
    

    OPTIONS()
    as (
      

SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast(Purpose as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as PurposeID,
		'Purpose' AS Purpose 
FROM `airflowcrtn`.`credit`.`raw_invoices`
WHERE Purpose  IS NOT NULL
    );
  
[0m00:52:30.171092 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:d0cecee0-fa94-4bfd-acb0-c910cb0dfc78&page=queryresults
[0m00:52:32.570606 [debug] [Thread-1 (]: Timing info for model.credit.dim_purpose (execute): 00:52:29.131104 => 00:52:32.569224
[0m00:52:32.575381 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2444621c-53ce-4ebc-b392-d9b9ae2cc528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f123653e3c0>]}
[0m00:52:32.578467 [info ] [Thread-1 (]: 3 of 4 OK created sql table model credit.dim_purpose ........................... [[32mCREATE TABLE (16.0 rows, 1.7 MiB processed)[0m in 3.49s]
[0m00:52:32.581770 [debug] [Thread-1 (]: Finished running node model.credit.dim_purpose
[0m00:52:32.586897 [debug] [Thread-1 (]: Began running node model.credit.fact_invoices
[0m00:52:32.589350 [info ] [Thread-1 (]: 4 of 4 START sql table model credit.fact_invoices .............................. [RUN]
[0m00:52:32.592681 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_purpose, now model.credit.fact_invoices)
[0m00:52:32.594609 [debug] [Thread-1 (]: Began compiling node model.credit.fact_invoices
[0m00:52:32.628104 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.fact_invoices"
[0m00:52:32.650992 [debug] [Thread-1 (]: Timing info for model.credit.fact_invoices (compile): 00:52:32.596345 => 00:52:32.649787
[0m00:52:32.653206 [debug] [Thread-1 (]: Began executing node model.credit.fact_invoices
[0m00:52:32.664848 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:52:32.625288 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.fact_invoices"
[0m00:52:32.647215 [debug] [Thread-1 (]: On model.credit.fact_invoices: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.fact_invoices"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`fact_invoices`
      
    
    

    OPTIONS()
    as (
      


WITH fct_invoices_cte AS (
    SELECT DISTINCT
        "Loan ID" AS LoanID,
        "Customer ID" AS CustomerID,
        to_hex(md5(cast(coalesce(cast("Loan Status" as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Term as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as LoanStatusID,
        to_hex(md5(cast(coalesce(cast(Purpose as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as PurposeID,
        "Current Loan Amount" AS CurrentLoanAmount,
        "Credit Score" AS CreditScore,
        "Annual Income" AS AnnualIncome,
        "Monthly Debt" AS MonthlyDebt,
        "Years of Credit History" AS YearsofCreditHistory,
        "Months since last delinquent" AS Monthssincelastdelinquent,
        "Number of Open Accounts" AS NumberofOpenAccounts,
        "Number of Credit Problems" AS NumberofCreditProblems,
        "Current Credit Balance" AS CurrentCreditBalance,
        "Maximum Open Credit" AS MaximumOpenCredit,
        "Bankruptcies" AS Bankruptcies,
        "Tax Liens" AS TaxLiens       
      
    FROM `airflowcrtn`.`credit`.`raw_invoices`
    
)
SELECT
   fi.*
FROM fct_invoices_cte fi
INNER JOIN `airflowcrtn`.`credit`.`dim_purpose` dt ON fi.PurposeID = dt.PurposeID
INNER JOIN `airflowcrtn`.`credit`.`dim_loanstatus` dp ON fi.LoanStatusID = dp.LoanStatusID
INNER JOIN `airflowcrtn`.`credit`.`dim_customer` dc ON fi.CustomerID = dc.CustomerID
    );
  
[0m00:52:33.174945 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:1ef2a793-808e-443a-a944-728c0233b23c&page=queryresults
[0m00:52:36.474798 [debug] [Thread-1 (]: Timing info for model.credit.fact_invoices (execute): 00:52:32.654729 => 00:52:36.474036
[0m00:52:36.477784 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2444621c-53ce-4ebc-b392-d9b9ae2cc528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f123653c230>]}
[0m00:52:36.479906 [info ] [Thread-1 (]: 4 of 4 OK created sql table model credit.fact_invoices ......................... [[32mCREATE TABLE (32.0 rows, 2.9 MiB processed)[0m in 3.89s]
[0m00:52:36.482401 [debug] [Thread-1 (]: Finished running node model.credit.fact_invoices
[0m00:52:36.489058 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:52:36.490817 [debug] [MainThread]: Connection 'model.credit.fact_invoices' was properly closed.
[0m00:52:36.492727 [info ] [MainThread]: 
[0m00:52:36.494892 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 15.07 seconds (15.07s).
[0m00:52:36.499809 [debug] [MainThread]: Command end result
[0m00:52:36.570106 [info ] [MainThread]: 
[0m00:52:36.572806 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:52:36.575052 [info ] [MainThread]: 
[0m00:52:36.576899 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m00:52:36.579336 [debug] [MainThread]: Command `dbt run` succeeded at 00:52:36.578967 after 24.75 seconds
[0m00:52:36.580885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f123a28cd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1237f93530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1237e902c0>]}
[0m00:52:36.583344 [debug] [MainThread]: Flushing usage events
[0m00:55:34.190329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52a4aa76b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52a4fa7620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52a4aa62a0>]}


============================== 00:55:34.195406 | 2445b1d0-5845-4897-ba01-e2a2b4434751 ==============================
[0m00:55:34.195406 [info ] [MainThread]: Running with dbt=1.6.18
[0m00:55:34.197274 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'debug': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'warn_error': 'None', 'indirect_selection': 'eager', 'introspect': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'quiet': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'version_check': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'write_json': 'True'}
[0m00:55:35.681349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2445b1d0-5845-4897-ba01-e2a2b4434751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52a34664e0>]}
[0m00:55:35.731342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2445b1d0-5845-4897-ba01-e2a2b4434751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52a4aa6720>]}
[0m00:55:35.734301 [info ] [MainThread]: Registered adapter: bigquery=1.6.0
[0m00:55:35.829192 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m00:55:35.884497 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m00:55:35.889060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2445b1d0-5845-4897-ba01-e2a2b4434751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52a2d81280>]}
[0m00:55:41.456750 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.Airflowcrtn
[0m00:55:41.474061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2445b1d0-5845-4897-ba01-e2a2b4434751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52a2a384a0>]}
[0m00:55:41.542340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2445b1d0-5845-4897-ba01-e2a2b4434751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52a104df70>]}
[0m00:55:41.544324 [info ] [MainThread]: Found 4 models, 1 source, 0 exposures, 0 metrics, 509 macros, 0 groups, 0 semantic models
[0m00:55:41.545899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2445b1d0-5845-4897-ba01-e2a2b4434751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52a2bfe990>]}
[0m00:55:41.556978 [info ] [MainThread]: 
[0m00:55:41.565207 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:55:41.573178 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflowcrtn'
[0m00:55:41.579335 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:55:42.218499 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflowcrtn, now list_airflowcrtn_credit)
[0m00:55:42.220740 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:55:42.665932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2445b1d0-5845-4897-ba01-e2a2b4434751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52a2bff920>]}
[0m00:55:42.669398 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:55:42.671772 [info ] [MainThread]: 
[0m00:55:42.679782 [debug] [Thread-1 (]: Began running node model.credit.dim_customer
[0m00:55:42.682412 [info ] [Thread-1 (]: 1 of 4 START sql table model credit.dim_customer ............................... [RUN]
[0m00:55:42.685428 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflowcrtn_credit, now model.credit.dim_customer)
[0m00:55:42.687234 [debug] [Thread-1 (]: Began compiling node model.credit.dim_customer
[0m00:55:42.717753 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_customer"
[0m00:55:42.738109 [debug] [Thread-1 (]: Timing info for model.credit.dim_customer (compile): 00:55:42.688687 => 00:55:42.737246
[0m00:55:42.739962 [debug] [Thread-1 (]: Began executing node model.credit.dim_customer
[0m00:55:42.785513 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:55:42.838034 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_customer"
[0m00:55:42.854593 [debug] [Thread-1 (]: On model.credit.dim_customer: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_customer"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`dim_customer`
      
    
    

    OPTIONS()
    as (
      


SELECT DISTINCT
	    'Customer ID' as CustomerID,
	    'Years in Current Job' as YearsinCurrentJob,
         'Home Ownership' as HomeOwnership
	FROM `airflowcrtn`.`credit`.`raw_invoices`
	WHERE 'Customer ID' IS NOT NULL
    );
  
[0m00:55:43.398182 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:b37c8c91-b8af-4b19-b43a-8afefb8f9a11&page=queryresults
[0m00:55:46.519052 [debug] [Thread-1 (]: Timing info for model.credit.dim_customer (execute): 00:55:42.741293 => 00:55:46.518401
[0m00:55:46.522538 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2445b1d0-5845-4897-ba01-e2a2b4434751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52a29e50a0>]}
[0m00:55:46.525937 [info ] [Thread-1 (]: 1 of 4 OK created sql table model credit.dim_customer .......................... [[32mCREATE TABLE (1.0 rows, 0 processed)[0m in 3.84s]
[0m00:55:46.530144 [debug] [Thread-1 (]: Finished running node model.credit.dim_customer
[0m00:55:46.533585 [debug] [Thread-1 (]: Began running node model.credit.dim_loanstatus
[0m00:55:46.536249 [info ] [Thread-1 (]: 2 of 4 START sql table model credit.dim_loanstatus ............................. [RUN]
[0m00:55:46.539653 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_customer, now model.credit.dim_loanstatus)
[0m00:55:46.542109 [debug] [Thread-1 (]: Began compiling node model.credit.dim_loanstatus
[0m00:55:46.565248 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_loanstatus"
[0m00:55:46.588386 [debug] [Thread-1 (]: Timing info for model.credit.dim_loanstatus (compile): 00:55:46.543918 => 00:55:46.586898
[0m00:55:46.591060 [debug] [Thread-1 (]: Began executing node model.credit.dim_loanstatus
[0m00:55:46.600401 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:55:47.103209 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_loanstatus"
[0m00:55:47.124455 [debug] [Thread-1 (]: On model.credit.dim_loanstatus: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_loanstatus"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`dim_loanstatus`
      
    
    

    OPTIONS()
    as (
      


SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast("Loan Status" as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Term as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as LoanStatusID,
	    "Loan Status" AS LoanStatus,
        'Term' AS Term

FROM `airflowcrtn`.`credit`.`raw_invoices`
WHERE "Loan Status" IS NOT NULL
    );
  
[0m00:55:47.712824 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:6411cf6c-fd39-47e8-8ad7-234a9fb9cde6&page=queryresults
[0m00:56:02.298020 [debug] [Thread-1 (]: Timing info for model.credit.dim_loanstatus (execute): 00:55:46.592671 => 00:56:02.297017
[0m00:56:02.302192 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2445b1d0-5845-4897-ba01-e2a2b4434751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52a2c36720>]}
[0m00:56:02.304660 [info ] [Thread-1 (]: 2 of 4 OK created sql table model credit.dim_loanstatus ........................ [[32mCREATE TABLE (2.0 rows, 1.1 MiB processed)[0m in 15.76s]
[0m00:56:02.308020 [debug] [Thread-1 (]: Finished running node model.credit.dim_loanstatus
[0m00:56:02.310425 [debug] [Thread-1 (]: Began running node model.credit.dim_purpose
[0m00:56:02.312333 [info ] [Thread-1 (]: 3 of 4 START sql table model credit.dim_purpose ................................ [RUN]
[0m00:56:02.315673 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_loanstatus, now model.credit.dim_purpose)
[0m00:56:02.317819 [debug] [Thread-1 (]: Began compiling node model.credit.dim_purpose
[0m00:56:02.336810 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_purpose"
[0m00:56:02.357134 [debug] [Thread-1 (]: Timing info for model.credit.dim_purpose (compile): 00:56:02.319233 => 00:56:02.356075
[0m00:56:02.359141 [debug] [Thread-1 (]: Began executing node model.credit.dim_purpose
[0m00:56:02.377124 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:56:02.817686 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_purpose"
[0m00:56:02.841852 [debug] [Thread-1 (]: On model.credit.dim_purpose: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_purpose"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`dim_purpose`
      
    
    

    OPTIONS()
    as (
      

SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast(Purpose as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as PurposeID,
		'Purpose' AS Purpose 
FROM `airflowcrtn`.`credit`.`raw_invoices`
WHERE Purpose  IS NOT NULL
    );
  
[0m00:56:03.264605 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:708d6ddf-6540-4f18-88df-720bd69ab4ce&page=queryresults
[0m00:56:06.259526 [debug] [Thread-1 (]: Timing info for model.credit.dim_purpose (execute): 00:56:02.361036 => 00:56:06.258866
[0m00:56:06.262626 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2445b1d0-5845-4897-ba01-e2a2b4434751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52a10574a0>]}
[0m00:56:06.264567 [info ] [Thread-1 (]: 3 of 4 OK created sql table model credit.dim_purpose ........................... [[32mCREATE TABLE (16.0 rows, 1.7 MiB processed)[0m in 3.95s]
[0m00:56:06.268122 [debug] [Thread-1 (]: Finished running node model.credit.dim_purpose
[0m00:56:06.271932 [debug] [Thread-1 (]: Began running node model.credit.fact_invoices
[0m00:56:06.273641 [info ] [Thread-1 (]: 4 of 4 START sql table model credit.fact_invoices .............................. [RUN]
[0m00:56:06.276557 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_purpose, now model.credit.fact_invoices)
[0m00:56:06.278475 [debug] [Thread-1 (]: Began compiling node model.credit.fact_invoices
[0m00:56:06.305644 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.fact_invoices"
[0m00:56:06.329356 [debug] [Thread-1 (]: Timing info for model.credit.fact_invoices (compile): 00:56:06.279852 => 00:56:06.327969
[0m00:56:06.331428 [debug] [Thread-1 (]: Began executing node model.credit.fact_invoices
[0m00:56:06.339855 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:56:06.799457 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.fact_invoices"
[0m00:56:06.813531 [debug] [Thread-1 (]: On model.credit.fact_invoices: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.fact_invoices"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`fact_invoices`
      
    
    

    OPTIONS()
    as (
      


WITH fct_invoices_cte AS (
    SELECT DISTINCT
        "Loan ID" AS LoanID,
        "Customer ID" AS CustomerID,
        to_hex(md5(cast(coalesce(cast("Loan Status" as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Term as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as LoanStatusID,
        to_hex(md5(cast(coalesce(cast(Purpose as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as PurposeID,
        "Current Loan Amount" AS CurrentLoanAmount,
        "Credit Score" AS CreditScore,
        "Annual Income" AS AnnualIncome,
        "Monthly Debt" AS MonthlyDebt,
        "Years of Credit History" AS YearsofCreditHistory,
        "Months since last delinquent" AS Monthssincelastdelinquent,
        "Number of Open Accounts" AS NumberofOpenAccounts,
        "Number of Credit Problems" AS NumberofCreditProblems,
        "Current Credit Balance" AS CurrentCreditBalance,
        "Maximum Open Credit" AS MaximumOpenCredit,
        "Bankruptcies" AS Bankruptcies,
        "Tax Liens" AS TaxLiens       
      
    FROM `airflowcrtn`.`credit`.`raw_invoices`
    
)
SELECT
   fi.*
FROM fct_invoices_cte fi
INNER JOIN `airflowcrtn`.`credit`.`dim_purpose` dt ON fi.PurposeID = dt.PurposeID
INNER JOIN `airflowcrtn`.`credit`.`dim_loanstatus` dp ON fi.LoanStatusID = dp.LoanStatusID
INNER JOIN `airflowcrtn`.`credit`.`dim_customer` dc ON fi.CustomerID = dc.CustomerID
    );
  
[0m00:56:07.306828 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:f8c99d6f-89a8-44c0-a2dd-4b2d94a3d920&page=queryresults
[0m00:56:09.754415 [debug] [Thread-1 (]: Timing info for model.credit.fact_invoices (execute): 00:56:06.332811 => 00:56:09.753811
[0m00:56:09.757204 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2445b1d0-5845-4897-ba01-e2a2b4434751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52a1057350>]}
[0m00:56:09.759496 [info ] [Thread-1 (]: 4 of 4 OK created sql table model credit.fact_invoices ......................... [[32mCREATE TABLE (32.0 rows, 2.9 MiB processed)[0m in 3.48s]
[0m00:56:09.767660 [debug] [Thread-1 (]: Finished running node model.credit.fact_invoices
[0m00:56:09.774643 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:56:09.776179 [debug] [MainThread]: Connection 'model.credit.fact_invoices' was properly closed.
[0m00:56:09.777830 [info ] [MainThread]: 
[0m00:56:09.782363 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 28.22 seconds (28.22s).
[0m00:56:09.792011 [debug] [MainThread]: Command end result
[0m00:56:09.854984 [info ] [MainThread]: 
[0m00:56:09.857997 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:56:09.859999 [info ] [MainThread]: 
[0m00:56:09.862190 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m00:56:09.865176 [debug] [MainThread]: Command `dbt run` succeeded at 00:56:09.864596 after 39.13 seconds
[0m00:56:09.867353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52a4d96b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52a2a0cb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52a2967590>]}
[0m00:56:09.869418 [debug] [MainThread]: Flushing usage events
[0m00:57:51.133244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f711af97dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f711b4321b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f711b3ecad0>]}


============================== 00:57:51.138389 | 9dd8c44c-0d79-4f62-9dd4-cbc55f1d67f0 ==============================
[0m00:57:51.138389 [info ] [MainThread]: Running with dbt=1.6.18
[0m00:57:51.141004 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'static_parser': 'True', 'log_cache_events': 'False', 'no_print': 'None', 'fail_fast': 'False', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'indirect_selection': 'eager', 'log_path': '/usr/local/airflow/include/dbt/logs', 'write_json': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'printer_width': '80', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'warn_error': 'None', 'use_colors': 'True', 'log_format': 'default'}
[0m00:57:52.589155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9dd8c44c-0d79-4f62-9dd4-cbc55f1d67f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71192cbe90>]}
[0m00:57:52.645901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9dd8c44c-0d79-4f62-9dd4-cbc55f1d67f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71192c88c0>]}
[0m00:57:52.649418 [info ] [MainThread]: Registered adapter: bigquery=1.6.0
[0m00:57:52.742369 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m00:57:54.673504 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:57:54.675918 [debug] [MainThread]: Partial parsing: updated file: credit://models/transform/dim_customer.sql
[0m00:57:54.840134 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.Airflowcrtn
[0m00:57:54.857248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9dd8c44c-0d79-4f62-9dd4-cbc55f1d67f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7118ec01a0>]}
[0m00:57:54.925196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9dd8c44c-0d79-4f62-9dd4-cbc55f1d67f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7118f60bf0>]}
[0m00:57:54.927165 [info ] [MainThread]: Found 4 models, 1 source, 0 exposures, 0 metrics, 509 macros, 0 groups, 0 semantic models
[0m00:57:54.928896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9dd8c44c-0d79-4f62-9dd4-cbc55f1d67f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f711997e8d0>]}
[0m00:57:54.934820 [info ] [MainThread]: 
[0m00:57:54.939962 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:57:54.944511 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflowcrtn'
[0m00:57:54.946301 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:57:55.482337 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflowcrtn, now list_airflowcrtn_credit)
[0m00:57:55.484292 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:57:55.931541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9dd8c44c-0d79-4f62-9dd4-cbc55f1d67f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7119c89eb0>]}
[0m00:57:55.934688 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:57:55.936336 [info ] [MainThread]: 
[0m00:57:55.946207 [debug] [Thread-1 (]: Began running node model.credit.dim_customer
[0m00:57:55.948818 [info ] [Thread-1 (]: 1 of 4 START sql table model credit.dim_customer ............................... [RUN]
[0m00:57:55.951884 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflowcrtn_credit, now model.credit.dim_customer)
[0m00:57:55.953782 [debug] [Thread-1 (]: Began compiling node model.credit.dim_customer
[0m00:57:55.979708 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_customer"
[0m00:57:56.002868 [debug] [Thread-1 (]: Timing info for model.credit.dim_customer (compile): 00:57:55.955409 => 00:57:56.001614
[0m00:57:56.005322 [debug] [Thread-1 (]: Began executing node model.credit.dim_customer
[0m00:57:56.047701 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:57:56.605863 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_customer"
[0m00:57:56.626418 [debug] [Thread-1 (]: On model.credit.dim_customer: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_customer"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`dim_customer`
      
    
    

    OPTIONS()
    as (
      


SELECT DISTINCT
	    'Customer ID' as CustomerID,
	    'Years in Current Job' as YearsinCurrentJob,
         'Home Ownership' as HomeOwnership
	FROM  raw_invoices
	WHERE 'Customer ID' IS NOT NULL
    );
  
[0m00:57:56.886774 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:3a2227a8-a38c-4a6f-8eec-ba4bc72281dd&page=queryresults
[0m00:57:56.889358 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Table "raw_invoices" must be qualified with a dataset (e.g. dataset.table).; reason: invalid, location: raw_invoices, message: Table "raw_invoices" must be qualified with a dataset (e.g. dataset.table).')
[0m00:57:58.290808 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:02121021-dbc0-45f0-895a-c42e0eb07de9&page=queryresults
[0m00:57:58.293340 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:02121021-dbc0-45f0-895a-c42e0eb07de9&page=queryresults
[0m00:57:58.297953 [debug] [Thread-1 (]: Timing info for model.credit.dim_customer (execute): 00:57:56.006941 => 00:57:58.296377
[0m00:57:58.313945 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  Table "raw_invoices" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/credit/models/transform/dim_customer.sql
[0m00:57:58.316225 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9dd8c44c-0d79-4f62-9dd4-cbc55f1d67f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7118ecac30>]}
[0m00:57:58.318699 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model credit.dim_customer ...................... [[31mERROR[0m in 2.37s]
[0m00:57:58.321805 [debug] [Thread-1 (]: Finished running node model.credit.dim_customer
[0m00:57:58.324303 [debug] [Thread-1 (]: Began running node model.credit.dim_loanstatus
[0m00:57:58.328658 [info ] [Thread-1 (]: 2 of 4 START sql table model credit.dim_loanstatus ............................. [RUN]
[0m00:57:58.333437 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_customer, now model.credit.dim_loanstatus)
[0m00:57:58.336298 [debug] [Thread-1 (]: Began compiling node model.credit.dim_loanstatus
[0m00:57:58.395617 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_loanstatus"
[0m00:57:58.416244 [debug] [Thread-1 (]: Timing info for model.credit.dim_loanstatus (compile): 00:57:58.337684 => 00:57:58.415304
[0m00:57:58.418104 [debug] [Thread-1 (]: Began executing node model.credit.dim_loanstatus
[0m00:57:58.426813 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:57:58.371421 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_loanstatus"
[0m00:57:58.388507 [debug] [Thread-1 (]: On model.credit.dim_loanstatus: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_loanstatus"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`dim_loanstatus`
      
    
    

    OPTIONS()
    as (
      


SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast("Loan Status" as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Term as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as LoanStatusID,
	    "Loan Status" AS LoanStatus,
        'Term' AS Term

FROM `airflowcrtn`.`credit`.`raw_invoices`
WHERE "Loan Status" IS NOT NULL
    );
  
[0m00:57:59.012910 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:776aa9fd-4fa4-42af-ad01-a4d573e27e70&page=queryresults
[0m00:58:01.645417 [debug] [Thread-1 (]: Timing info for model.credit.dim_loanstatus (execute): 00:57:58.419447 => 00:58:01.644784
[0m00:58:01.648437 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9dd8c44c-0d79-4f62-9dd4-cbc55f1d67f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7118ed68a0>]}
[0m00:58:01.650660 [info ] [Thread-1 (]: 2 of 4 OK created sql table model credit.dim_loanstatus ........................ [[32mCREATE TABLE (2.0 rows, 1.1 MiB processed)[0m in 3.32s]
[0m00:58:01.653937 [debug] [Thread-1 (]: Finished running node model.credit.dim_loanstatus
[0m00:58:01.656297 [debug] [Thread-1 (]: Began running node model.credit.dim_purpose
[0m00:58:01.658352 [info ] [Thread-1 (]: 3 of 4 START sql table model credit.dim_purpose ................................ [RUN]
[0m00:58:01.661353 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_loanstatus, now model.credit.dim_purpose)
[0m00:58:01.663149 [debug] [Thread-1 (]: Began compiling node model.credit.dim_purpose
[0m00:58:01.678271 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_purpose"
[0m00:58:01.701761 [debug] [Thread-1 (]: Timing info for model.credit.dim_purpose (compile): 00:58:01.664685 => 00:58:01.700563
[0m00:58:01.703858 [debug] [Thread-1 (]: Began executing node model.credit.dim_purpose
[0m00:58:01.711871 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:58:02.142713 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_purpose"
[0m00:58:02.167203 [debug] [Thread-1 (]: On model.credit.dim_purpose: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_purpose"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`dim_purpose`
      
    
    

    OPTIONS()
    as (
      

SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast(Purpose as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as PurposeID,
		'Purpose' AS Purpose 
FROM `airflowcrtn`.`credit`.`raw_invoices`
WHERE Purpose  IS NOT NULL
    );
  
[0m00:58:02.726094 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:4a7d774b-8846-4910-b432-0dd75d0ee4ef&page=queryresults
[0m00:58:04.432200 [debug] [Thread-1 (]: Timing info for model.credit.dim_purpose (execute): 00:58:01.705300 => 00:58:04.431576
[0m00:58:04.435936 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9dd8c44c-0d79-4f62-9dd4-cbc55f1d67f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f711916d2e0>]}
[0m00:58:04.438289 [info ] [Thread-1 (]: 3 of 4 OK created sql table model credit.dim_purpose ........................... [[32mCREATE TABLE (16.0 rows, 1.7 MiB processed)[0m in 2.78s]
[0m00:58:04.441328 [debug] [Thread-1 (]: Finished running node model.credit.dim_purpose
[0m00:58:04.445356 [debug] [Thread-1 (]: Began running node model.credit.fact_invoices
[0m00:58:04.447154 [info ] [Thread-1 (]: 4 of 4 SKIP relation credit.fact_invoices ...................................... [[33mSKIP[0m]
[0m00:58:04.449117 [debug] [Thread-1 (]: Finished running node model.credit.fact_invoices
[0m00:58:04.455207 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:58:04.457070 [debug] [MainThread]: Connection 'model.credit.dim_purpose' was properly closed.
[0m00:58:04.459135 [info ] [MainThread]: 
[0m00:58:04.462558 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 9.52 seconds (9.52s).
[0m00:58:04.467800 [debug] [MainThread]: Command end result
[0m00:58:04.540454 [info ] [MainThread]: 
[0m00:58:04.542595 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:58:04.544553 [info ] [MainThread]: 
[0m00:58:04.546371 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  Table "raw_invoices" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/credit/models/transform/dim_customer.sql
[0m00:58:04.548032 [info ] [MainThread]: 
[0m00:58:04.550166 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m00:58:04.552788 [debug] [MainThread]: Command `dbt run` failed at 00:58:04.552336 after 14.76 seconds
[0m00:58:04.554681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f711b5be240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f711923ec90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f711913e1b0>]}
[0m00:58:04.556705 [debug] [MainThread]: Flushing usage events
[0m01:00:28.498839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb45496090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb459321b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb4598ec60>]}


============================== 01:00:28.503979 | 89be64a5-2fbd-4ae9-bb08-3d0c2c294f98 ==============================
[0m01:00:28.503979 [info ] [MainThread]: Running with dbt=1.6.18
[0m01:00:28.506301 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'use_colors': 'True', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'no_print': 'None', 'version_check': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'log_path': '/usr/local/airflow/include/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'log_cache_events': 'False', 'write_json': 'True', 'introspect': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'static_parser': 'True', 'cache_selected_only': 'False', 'printer_width': '80', 'profiles_dir': '/usr/local/airflow/include/dbt/'}
[0m01:00:29.930955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89be64a5-2fbd-4ae9-bb08-3d0c2c294f98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb437053d0>]}
[0m01:00:29.977236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89be64a5-2fbd-4ae9-bb08-3d0c2c294f98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb435d6420>]}
[0m01:00:29.979851 [info ] [MainThread]: Registered adapter: bigquery=1.6.0
[0m01:00:30.068688 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m01:00:32.511524 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:00:32.513750 [debug] [MainThread]: Partial parsing: updated file: credit://models/transform/dim_customer.sql
[0m01:00:32.658759 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.Airflowcrtn
[0m01:00:32.679414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '89be64a5-2fbd-4ae9-bb08-3d0c2c294f98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb435e7a70>]}
[0m01:00:32.751144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '89be64a5-2fbd-4ae9-bb08-3d0c2c294f98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb4361a870>]}
[0m01:00:32.753544 [info ] [MainThread]: Found 4 models, 1 source, 0 exposures, 0 metrics, 509 macros, 0 groups, 0 semantic models
[0m01:00:32.755166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89be64a5-2fbd-4ae9-bb08-3d0c2c294f98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb4361a3f0>]}
[0m01:00:32.761263 [info ] [MainThread]: 
[0m01:00:32.764633 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:00:32.768723 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflowcrtn'
[0m01:00:32.770447 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:00:33.356381 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflowcrtn, now list_airflowcrtn_credit)
[0m01:00:33.358494 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:00:33.769832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89be64a5-2fbd-4ae9-bb08-3d0c2c294f98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb4377af60>]}
[0m01:00:33.772989 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:00:33.774977 [info ] [MainThread]: 
[0m01:00:33.784921 [debug] [Thread-1 (]: Began running node model.credit.dim_customer
[0m01:00:33.787328 [info ] [Thread-1 (]: 1 of 4 START sql table model credit.dim_customer ............................... [RUN]
[0m01:00:33.790544 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflowcrtn_credit, now model.credit.dim_customer)
[0m01:00:33.792531 [debug] [Thread-1 (]: Began compiling node model.credit.dim_customer
[0m01:00:33.819390 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_customer"
[0m01:00:33.843700 [debug] [Thread-1 (]: Timing info for model.credit.dim_customer (compile): 01:00:33.794153 => 01:00:33.842661
[0m01:00:33.845596 [debug] [Thread-1 (]: Began executing node model.credit.dim_customer
[0m01:00:33.889265 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:00:34.335478 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_customer"
[0m01:00:34.357362 [debug] [Thread-1 (]: On model.credit.dim_customer: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_customer"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`dim_customer`
      
    
    

    OPTIONS()
    as (
      


SELECT DISTINCT
	    'Customer ID' as CustomerID,
	    'Years in Current Job' as YearsinCurrentJob,
         'Home Ownership' as HomeOwnership
	FROM  credit.raw_invoices
	WHERE 'Customer ID' IS NOT NULL
    );
  
[0m01:00:34.871941 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:2c2c49bf-cf7b-465b-a178-40b930c46749&page=queryresults
[0m01:00:37.700842 [debug] [Thread-1 (]: Timing info for model.credit.dim_customer (execute): 01:00:33.847358 => 01:00:37.700201
[0m01:00:37.703744 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89be64a5-2fbd-4ae9-bb08-3d0c2c294f98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb433f5eb0>]}
[0m01:00:37.706395 [info ] [Thread-1 (]: 1 of 4 OK created sql table model credit.dim_customer .......................... [[32mCREATE TABLE (1.0 rows, 0 processed)[0m in 3.91s]
[0m01:00:37.709598 [debug] [Thread-1 (]: Finished running node model.credit.dim_customer
[0m01:00:37.712136 [debug] [Thread-1 (]: Began running node model.credit.dim_loanstatus
[0m01:00:37.714622 [info ] [Thread-1 (]: 2 of 4 START sql table model credit.dim_loanstatus ............................. [RUN]
[0m01:00:37.717927 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_customer, now model.credit.dim_loanstatus)
[0m01:00:37.719871 [debug] [Thread-1 (]: Began compiling node model.credit.dim_loanstatus
[0m01:00:37.776820 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_loanstatus"
[0m01:00:37.795055 [debug] [Thread-1 (]: Timing info for model.credit.dim_loanstatus (compile): 01:00:37.721154 => 01:00:37.794038
[0m01:00:37.796884 [debug] [Thread-1 (]: Began executing node model.credit.dim_loanstatus
[0m01:00:37.804288 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:00:38.247860 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_loanstatus"
[0m01:00:38.266492 [debug] [Thread-1 (]: On model.credit.dim_loanstatus: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_loanstatus"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`dim_loanstatus`
      
    
    

    OPTIONS()
    as (
      


SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast("Loan Status" as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Term as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as LoanStatusID,
	    "Loan Status" AS LoanStatus,
        'Term' AS Term

FROM `airflowcrtn`.`credit`.`raw_invoices`
WHERE "Loan Status" IS NOT NULL
    );
  
[0m01:00:38.765466 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:4d450a9a-32fa-4879-9176-cb058d1ed894&page=queryresults
[0m01:00:40.716659 [debug] [Thread-1 (]: Timing info for model.credit.dim_loanstatus (execute): 01:00:37.798161 => 01:00:40.715868
[0m01:00:40.719582 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89be64a5-2fbd-4ae9-bb08-3d0c2c294f98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb433d7770>]}
[0m01:00:40.721872 [info ] [Thread-1 (]: 2 of 4 OK created sql table model credit.dim_loanstatus ........................ [[32mCREATE TABLE (2.0 rows, 1.1 MiB processed)[0m in 3.00s]
[0m01:00:40.726831 [debug] [Thread-1 (]: Finished running node model.credit.dim_loanstatus
[0m01:00:40.730547 [debug] [Thread-1 (]: Began running node model.credit.dim_purpose
[0m01:00:40.732506 [info ] [Thread-1 (]: 3 of 4 START sql table model credit.dim_purpose ................................ [RUN]
[0m01:00:40.736142 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_loanstatus, now model.credit.dim_purpose)
[0m01:00:40.738798 [debug] [Thread-1 (]: Began compiling node model.credit.dim_purpose
[0m01:00:40.756567 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_purpose"
[0m01:00:40.776580 [debug] [Thread-1 (]: Timing info for model.credit.dim_purpose (compile): 01:00:40.740049 => 01:00:40.775533
[0m01:00:40.778882 [debug] [Thread-1 (]: Began executing node model.credit.dim_purpose
[0m01:00:40.786589 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:00:41.227307 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_purpose"
[0m01:00:41.244814 [debug] [Thread-1 (]: On model.credit.dim_purpose: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_purpose"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`dim_purpose`
      
    
    

    OPTIONS()
    as (
      

SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast(Purpose as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as PurposeID,
		'Purpose' AS Purpose 
FROM `airflowcrtn`.`credit`.`raw_invoices`
WHERE Purpose  IS NOT NULL
    );
  
[0m01:00:41.977150 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:f449fbd1-daad-44e4-af03-22a14b43d64c&page=queryresults
[0m01:00:44.010198 [debug] [Thread-1 (]: Timing info for model.credit.dim_purpose (execute): 01:00:40.780421 => 01:00:44.009562
[0m01:00:44.013140 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89be64a5-2fbd-4ae9-bb08-3d0c2c294f98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb43483f50>]}
[0m01:00:44.015278 [info ] [Thread-1 (]: 3 of 4 OK created sql table model credit.dim_purpose ........................... [[32mCREATE TABLE (16.0 rows, 1.7 MiB processed)[0m in 3.28s]
[0m01:00:44.018924 [debug] [Thread-1 (]: Finished running node model.credit.dim_purpose
[0m01:00:44.023052 [debug] [Thread-1 (]: Began running node model.credit.fact_invoices
[0m01:00:44.025091 [info ] [Thread-1 (]: 4 of 4 START sql table model credit.fact_invoices .............................. [RUN]
[0m01:00:44.028195 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_purpose, now model.credit.fact_invoices)
[0m01:00:44.030080 [debug] [Thread-1 (]: Began compiling node model.credit.fact_invoices
[0m01:00:44.054628 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.fact_invoices"
[0m01:00:44.078650 [debug] [Thread-1 (]: Timing info for model.credit.fact_invoices (compile): 01:00:44.031504 => 01:00:44.077515
[0m01:00:44.080796 [debug] [Thread-1 (]: Began executing node model.credit.fact_invoices
[0m01:00:44.088588 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:00:44.554298 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.fact_invoices"
[0m01:00:44.575843 [debug] [Thread-1 (]: On model.credit.fact_invoices: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.fact_invoices"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`fact_invoices`
      
    
    

    OPTIONS()
    as (
      


WITH fct_invoices_cte AS (
    SELECT DISTINCT
        "Loan ID" AS LoanID,
        "Customer ID" AS CustomerID,
        to_hex(md5(cast(coalesce(cast("Loan Status" as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Term as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as LoanStatusID,
        to_hex(md5(cast(coalesce(cast(Purpose as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as PurposeID,
        "Current Loan Amount" AS CurrentLoanAmount,
        "Credit Score" AS CreditScore,
        "Annual Income" AS AnnualIncome,
        "Monthly Debt" AS MonthlyDebt,
        "Years of Credit History" AS YearsofCreditHistory,
        "Months since last delinquent" AS Monthssincelastdelinquent,
        "Number of Open Accounts" AS NumberofOpenAccounts,
        "Number of Credit Problems" AS NumberofCreditProblems,
        "Current Credit Balance" AS CurrentCreditBalance,
        "Maximum Open Credit" AS MaximumOpenCredit,
        "Bankruptcies" AS Bankruptcies,
        "Tax Liens" AS TaxLiens       
      
    FROM `airflowcrtn`.`credit`.`raw_invoices`
    
)
SELECT
   fi.*
FROM fct_invoices_cte fi
INNER JOIN `airflowcrtn`.`credit`.`dim_purpose` dt ON fi.PurposeID = dt.PurposeID
INNER JOIN `airflowcrtn`.`credit`.`dim_loanstatus` dp ON fi.LoanStatusID = dp.LoanStatusID
INNER JOIN `airflowcrtn`.`credit`.`dim_customer` dc ON fi.CustomerID = dc.CustomerID
    );
  
[0m01:00:45.190015 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:afad9b27-9889-426f-98b5-69087ca5b17d&page=queryresults
[0m01:00:48.733422 [debug] [Thread-1 (]: Timing info for model.credit.fact_invoices (execute): 01:00:44.082444 => 01:00:48.732581
[0m01:00:48.745948 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89be64a5-2fbd-4ae9-bb08-3d0c2c294f98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb4361a0f0>]}
[0m01:00:48.749310 [info ] [Thread-1 (]: 4 of 4 OK created sql table model credit.fact_invoices ......................... [[32mCREATE TABLE (32.0 rows, 2.9 MiB processed)[0m in 4.71s]
[0m01:00:48.753340 [debug] [Thread-1 (]: Finished running node model.credit.fact_invoices
[0m01:00:48.761719 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:00:48.763869 [debug] [MainThread]: Connection 'model.credit.fact_invoices' was properly closed.
[0m01:00:48.766257 [info ] [MainThread]: 
[0m01:00:48.768825 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 16.00 seconds (16.00s).
[0m01:00:48.781640 [debug] [MainThread]: Command end result
[0m01:00:48.859647 [info ] [MainThread]: 
[0m01:00:48.861490 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:00:48.863270 [info ] [MainThread]: 
[0m01:00:48.865096 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m01:00:48.867325 [debug] [MainThread]: Command `dbt run` succeeded at 01:00:48.866861 after 22.43 seconds
[0m01:00:48.869056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb459f3e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb4377af60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb4926cb60>]}
[0m01:00:48.870512 [debug] [MainThread]: Flushing usage events
[0m01:02:25.148681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7345ef8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7346eec60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7347fcbf0>]}


============================== 01:02:25.153777 | d562c256-b35c-437b-9bf7-539cd323a4f2 ==============================
[0m01:02:25.153777 [info ] [MainThread]: Running with dbt=1.6.18
[0m01:02:25.155837 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'indirect_selection': 'eager', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'log_cache_events': 'False', 'no_print': 'None', 'static_parser': 'True', 'use_colors': 'True', 'quiet': 'False', 'log_format': 'default', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'partial_parse': 'True', 'version_check': 'True', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'printer_width': '80', 'introspect': 'True', 'write_json': 'True'}
[0m01:02:26.573202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd562c256-b35c-437b-9bf7-539cd323a4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc732c6fc80>]}
[0m01:02:26.618014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd562c256-b35c-437b-9bf7-539cd323a4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7322a7cb0>]}
[0m01:02:26.620744 [info ] [MainThread]: Registered adapter: bigquery=1.6.0
[0m01:02:26.715604 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m01:02:28.969032 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:02:28.971583 [debug] [MainThread]: Partial parsing: updated file: credit://models/transform/dim_customer.sql
[0m01:02:28.634305 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.Airflowcrtn
[0m01:02:28.654588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd562c256-b35c-437b-9bf7-539cd323a4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7322d6a50>]}
[0m01:02:28.721547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd562c256-b35c-437b-9bf7-539cd323a4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc73231a2a0>]}
[0m01:02:28.723797 [info ] [MainThread]: Found 4 models, 1 source, 0 exposures, 0 metrics, 509 macros, 0 groups, 0 semantic models
[0m01:02:28.725609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd562c256-b35c-437b-9bf7-539cd323a4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7320c8080>]}
[0m01:02:28.733346 [info ] [MainThread]: 
[0m01:02:28.738361 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:02:28.744227 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflowcrtn'
[0m01:02:28.745966 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:02:29.243948 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflowcrtn, now list_airflowcrtn_credit)
[0m01:02:29.245889 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:02:29.682013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd562c256-b35c-437b-9bf7-539cd323a4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc73231b0e0>]}
[0m01:02:29.685167 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:02:29.687182 [info ] [MainThread]: 
[0m01:02:29.698246 [debug] [Thread-1 (]: Began running node model.credit.dim_customer
[0m01:02:29.700114 [info ] [Thread-1 (]: 1 of 4 START sql table model credit.dim_customer ............................... [RUN]
[0m01:02:29.703127 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflowcrtn_credit, now model.credit.dim_customer)
[0m01:02:29.704877 [debug] [Thread-1 (]: Began compiling node model.credit.dim_customer
[0m01:02:29.735616 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_customer"
[0m01:02:29.757074 [debug] [Thread-1 (]: Timing info for model.credit.dim_customer (compile): 01:02:29.705933 => 01:02:29.755850
[0m01:02:29.759313 [debug] [Thread-1 (]: Began executing node model.credit.dim_customer
[0m01:02:29.805691 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:02:30.302399 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_customer"
[0m01:02:30.321696 [debug] [Thread-1 (]: On model.credit.dim_customer: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_customer"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`dim_customer`
      
    
    

    OPTIONS()
    as (
      


SELECT 
	    'Customer ID' as CustomerID,
	    'Years in Current Job' as YearsinCurrentJob,
         'Home Ownership' as HomeOwnership
	FROM  credit.raw_invoices
    );
  
[0m01:02:31.150667 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:8e372ed9-fb34-46f8-8d8b-ea945aaaaabc&page=queryresults
[0m01:02:33.569760 [debug] [Thread-1 (]: Timing info for model.credit.dim_customer (execute): 01:02:29.760970 => 01:02:33.569017
[0m01:02:33.572639 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd562c256-b35c-437b-9bf7-539cd323a4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7320ae330>]}
[0m01:02:33.575030 [info ] [Thread-1 (]: 1 of 4 OK created sql table model credit.dim_customer .......................... [[32mCREATE TABLE (100.0k rows, 0 processed)[0m in 3.87s]
[0m01:02:33.580300 [debug] [Thread-1 (]: Finished running node model.credit.dim_customer
[0m01:02:33.583150 [debug] [Thread-1 (]: Began running node model.credit.dim_loanstatus
[0m01:02:33.585917 [info ] [Thread-1 (]: 2 of 4 START sql table model credit.dim_loanstatus ............................. [RUN]
[0m01:02:33.588886 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_customer, now model.credit.dim_loanstatus)
[0m01:02:33.590757 [debug] [Thread-1 (]: Began compiling node model.credit.dim_loanstatus
[0m01:02:33.644261 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_loanstatus"
[0m01:02:33.661854 [debug] [Thread-1 (]: Timing info for model.credit.dim_loanstatus (compile): 01:02:33.592152 => 01:02:33.660809
[0m01:02:33.663401 [debug] [Thread-1 (]: Began executing node model.credit.dim_loanstatus
[0m01:02:33.670554 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:02:33.608924 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_loanstatus"
[0m01:02:33.630647 [debug] [Thread-1 (]: On model.credit.dim_loanstatus: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_loanstatus"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`dim_loanstatus`
      
    
    

    OPTIONS()
    as (
      


SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast("Loan Status" as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Term as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as LoanStatusID,
	    "Loan Status" AS LoanStatus,
        'Term' AS Term

FROM `airflowcrtn`.`credit`.`raw_invoices`
WHERE "Loan Status" IS NOT NULL
    );
  
[0m01:02:34.260184 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:e7531313-b60e-4159-8f2a-6424166fade4&page=queryresults
[0m01:02:36.836203 [debug] [Thread-1 (]: Timing info for model.credit.dim_loanstatus (execute): 01:02:33.664495 => 01:02:36.835452
[0m01:02:36.838894 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd562c256-b35c-437b-9bf7-539cd323a4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7320f5160>]}
[0m01:02:36.840608 [info ] [Thread-1 (]: 2 of 4 OK created sql table model credit.dim_loanstatus ........................ [[32mCREATE TABLE (2.0 rows, 1.1 MiB processed)[0m in 3.25s]
[0m01:02:36.844493 [debug] [Thread-1 (]: Finished running node model.credit.dim_loanstatus
[0m01:02:36.847301 [debug] [Thread-1 (]: Began running node model.credit.dim_purpose
[0m01:02:36.849549 [info ] [Thread-1 (]: 3 of 4 START sql table model credit.dim_purpose ................................ [RUN]
[0m01:02:36.852268 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_loanstatus, now model.credit.dim_purpose)
[0m01:02:36.853696 [debug] [Thread-1 (]: Began compiling node model.credit.dim_purpose
[0m01:02:36.869689 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_purpose"
[0m01:02:36.890397 [debug] [Thread-1 (]: Timing info for model.credit.dim_purpose (compile): 01:02:36.854844 => 01:02:36.889468
[0m01:02:36.892095 [debug] [Thread-1 (]: Began executing node model.credit.dim_purpose
[0m01:02:36.900404 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:02:37.358914 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_purpose"
[0m01:02:37.381112 [debug] [Thread-1 (]: On model.credit.dim_purpose: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_purpose"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`dim_purpose`
      
    
    

    OPTIONS()
    as (
      

SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast(Purpose as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as PurposeID,
		'Purpose' AS Purpose 
FROM `airflowcrtn`.`credit`.`raw_invoices`
WHERE Purpose  IS NOT NULL
    );
  
[0m01:02:37.968522 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:06e96684-0548-43c1-aee2-14d6f51b49e9&page=queryresults
[0m01:02:39.955252 [debug] [Thread-1 (]: Timing info for model.credit.dim_purpose (execute): 01:02:36.893468 => 01:02:39.954658
[0m01:02:39.958148 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd562c256-b35c-437b-9bf7-539cd323a4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7320ae330>]}
[0m01:02:39.960416 [info ] [Thread-1 (]: 3 of 4 OK created sql table model credit.dim_purpose ........................... [[32mCREATE TABLE (16.0 rows, 1.7 MiB processed)[0m in 3.11s]
[0m01:02:39.963237 [debug] [Thread-1 (]: Finished running node model.credit.dim_purpose
[0m01:02:39.966905 [debug] [Thread-1 (]: Began running node model.credit.fact_invoices
[0m01:02:39.968571 [info ] [Thread-1 (]: 4 of 4 START sql table model credit.fact_invoices .............................. [RUN]
[0m01:02:39.971640 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_purpose, now model.credit.fact_invoices)
[0m01:02:39.973594 [debug] [Thread-1 (]: Began compiling node model.credit.fact_invoices
[0m01:02:39.997337 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.fact_invoices"
[0m01:02:40.017088 [debug] [Thread-1 (]: Timing info for model.credit.fact_invoices (compile): 01:02:39.974972 => 01:02:40.016232
[0m01:02:40.018958 [debug] [Thread-1 (]: Began executing node model.credit.fact_invoices
[0m01:02:40.026886 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:02:40.487456 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.fact_invoices"
[0m01:02:40.508605 [debug] [Thread-1 (]: On model.credit.fact_invoices: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.fact_invoices"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`fact_invoices`
      
    
    

    OPTIONS()
    as (
      


WITH fct_invoices_cte AS (
    SELECT DISTINCT
        "Loan ID" AS LoanID,
        "Customer ID" AS CustomerID,
        to_hex(md5(cast(coalesce(cast("Loan Status" as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Term as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as LoanStatusID,
        to_hex(md5(cast(coalesce(cast(Purpose as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as PurposeID,
        "Current Loan Amount" AS CurrentLoanAmount,
        "Credit Score" AS CreditScore,
        "Annual Income" AS AnnualIncome,
        "Monthly Debt" AS MonthlyDebt,
        "Years of Credit History" AS YearsofCreditHistory,
        "Months since last delinquent" AS Monthssincelastdelinquent,
        "Number of Open Accounts" AS NumberofOpenAccounts,
        "Number of Credit Problems" AS NumberofCreditProblems,
        "Current Credit Balance" AS CurrentCreditBalance,
        "Maximum Open Credit" AS MaximumOpenCredit,
        "Bankruptcies" AS Bankruptcies,
        "Tax Liens" AS TaxLiens       
      
    FROM `airflowcrtn`.`credit`.`raw_invoices`
    
)
SELECT
   fi.*
FROM fct_invoices_cte fi
INNER JOIN `airflowcrtn`.`credit`.`dim_purpose` dt ON fi.PurposeID = dt.PurposeID
INNER JOIN `airflowcrtn`.`credit`.`dim_loanstatus` dp ON fi.LoanStatusID = dp.LoanStatusID
INNER JOIN `airflowcrtn`.`credit`.`dim_customer` dc ON fi.CustomerID = dc.CustomerID
    );
  
[0m01:02:41.019393 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:b785334c-01bc-4448-858d-730fa5fcef1c&page=queryresults
[0m01:02:46.001985 [debug] [Thread-1 (]: Timing info for model.credit.fact_invoices (execute): 01:02:40.020214 => 01:02:46.001308
[0m01:02:46.004811 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd562c256-b35c-437b-9bf7-539cd323a4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc73231be90>]}
[0m01:02:46.006641 [info ] [Thread-1 (]: 4 of 4 OK created sql table model credit.fact_invoices ......................... [[32mCREATE TABLE (3.2m rows, 4.1 MiB processed)[0m in 6.03s]
[0m01:02:46.010439 [debug] [Thread-1 (]: Finished running node model.credit.fact_invoices
[0m01:02:46.017220 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:02:46.018718 [debug] [MainThread]: Connection 'model.credit.fact_invoices' was properly closed.
[0m01:02:46.020392 [info ] [MainThread]: 
[0m01:02:46.022282 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 17.28 seconds (17.28s).
[0m01:02:46.028603 [debug] [MainThread]: Command end result
[0m01:02:46.098509 [info ] [MainThread]: 
[0m01:02:46.100400 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:02:46.102710 [info ] [MainThread]: 
[0m01:02:46.104606 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m01:02:46.107310 [debug] [MainThread]: Command `dbt run` succeeded at 01:02:46.106859 after 23.02 seconds
[0m01:02:46.108981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc73525be00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6fa73fbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6fa73f830>]}
[0m01:02:46.110970 [debug] [MainThread]: Flushing usage events
[0m01:06:07.084153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efda1793dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efda1b28b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efda1c8bcb0>]}


============================== 01:06:07.088990 | 74ec6633-897e-4a5a-a917-2ea5bb3da47f ==============================
[0m01:06:07.088990 [info ] [MainThread]: Running with dbt=1.6.18
[0m01:06:07.091162 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'log_cache_events': 'False', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'log_path': '/usr/local/airflow/include/dbt/logs', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'use_experimental_parser': 'False', 'target_path': 'None', 'quiet': 'False', 'introspect': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'log_format': 'default', 'write_json': 'True', 'debug': 'False', 'static_parser': 'True', 'version_check': 'True', 'no_print': 'None'}
[0m01:06:08.510957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '74ec6633-897e-4a5a-a917-2ea5bb3da47f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd9f9a47d0>]}
[0m01:06:08.561486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '74ec6633-897e-4a5a-a917-2ea5bb3da47f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd9f8d1a30>]}
[0m01:06:08.563959 [info ] [MainThread]: Registered adapter: bigquery=1.6.0
[0m01:06:08.653531 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m01:06:10.260684 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:06:10.263106 [debug] [MainThread]: Partial parsing: updated file: credit://models/transform/dim_customer.sql
[0m01:06:10.421248 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.Airflowcrtn
[0m01:06:10.438524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '74ec6633-897e-4a5a-a917-2ea5bb3da47f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd9fb09bb0>]}
[0m01:06:10.517043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '74ec6633-897e-4a5a-a917-2ea5bb3da47f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd9f758c50>]}
[0m01:06:10.519303 [info ] [MainThread]: Found 4 models, 1 source, 0 exposures, 0 metrics, 509 macros, 0 groups, 0 semantic models
[0m01:06:10.520961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74ec6633-897e-4a5a-a917-2ea5bb3da47f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd9f7588c0>]}
[0m01:06:10.526715 [info ] [MainThread]: 
[0m01:06:10.529590 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:06:10.534385 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflowcrtn'
[0m01:06:10.536669 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:06:11.062763 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflowcrtn, now list_airflowcrtn_credit)
[0m01:06:11.064509 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:06:11.502138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74ec6633-897e-4a5a-a917-2ea5bb3da47f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd9f871ee0>]}
[0m01:06:11.505609 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:06:11.507269 [info ] [MainThread]: 
[0m01:06:11.517829 [debug] [Thread-1 (]: Began running node model.credit.dim_customer
[0m01:06:11.520040 [info ] [Thread-1 (]: 1 of 4 START sql table model credit.dim_customer ............................... [RUN]
[0m01:06:11.523634 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflowcrtn_credit, now model.credit.dim_customer)
[0m01:06:11.527054 [debug] [Thread-1 (]: Began compiling node model.credit.dim_customer
[0m01:06:11.557050 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_customer"
[0m01:06:11.580872 [debug] [Thread-1 (]: Timing info for model.credit.dim_customer (compile): 01:06:11.528800 => 01:06:11.579595
[0m01:06:11.583177 [debug] [Thread-1 (]: Began executing node model.credit.dim_customer
[0m01:06:11.625526 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:06:12.153721 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_customer"
[0m01:06:12.175480 [debug] [Thread-1 (]: On model.credit.dim_customer: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_customer"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`dim_customer`
      
    
    

    OPTIONS()
    as (
      


SELECT 
	    "Customer ID" as CustomerID,
	    "Years in Current Job" as YearsinCurrentJob,
         "Home Ownership" as HomeOwnership 
	FROM  credit.raw_invoices
    );
  
[0m01:06:12.771935 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:6eaf38a8-ca28-4ce0-9e31-92f024cfd6b4&page=queryresults
[0m01:06:15.345890 [debug] [Thread-1 (]: Timing info for model.credit.dim_customer (execute): 01:06:11.584548 => 01:06:15.345136
[0m01:06:15.349349 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74ec6633-897e-4a5a-a917-2ea5bb3da47f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd9fa6d100>]}
[0m01:06:15.351803 [info ] [Thread-1 (]: 1 of 4 OK created sql table model credit.dim_customer .......................... [[32mCREATE TABLE (100.0k rows, 0 processed)[0m in 3.83s]
[0m01:06:15.354858 [debug] [Thread-1 (]: Finished running node model.credit.dim_customer
[0m01:06:15.356947 [debug] [Thread-1 (]: Began running node model.credit.dim_loanstatus
[0m01:06:15.358624 [info ] [Thread-1 (]: 2 of 4 START sql table model credit.dim_loanstatus ............................. [RUN]
[0m01:06:15.361063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_customer, now model.credit.dim_loanstatus)
[0m01:06:15.362568 [debug] [Thread-1 (]: Began compiling node model.credit.dim_loanstatus
[0m01:06:15.421275 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_loanstatus"
[0m01:06:15.445502 [debug] [Thread-1 (]: Timing info for model.credit.dim_loanstatus (compile): 01:06:15.363738 => 01:06:15.444474
[0m01:06:15.447445 [debug] [Thread-1 (]: Began executing node model.credit.dim_loanstatus
[0m01:06:15.455680 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:06:15.975790 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_loanstatus"
[0m01:06:16.002988 [debug] [Thread-1 (]: On model.credit.dim_loanstatus: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_loanstatus"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`dim_loanstatus`
      
    
    

    OPTIONS()
    as (
      


SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast("Loan Status" as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Term as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as LoanStatusID,
	    "Loan Status" AS LoanStatus,
        'Term' AS Term

FROM `airflowcrtn`.`credit`.`raw_invoices`
WHERE "Loan Status" IS NOT NULL
    );
  
[0m01:06:16.537243 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:1cef96c2-fc04-4280-b64d-5a64b4909824&page=queryresults
[0m01:06:18.961801 [debug] [Thread-1 (]: Timing info for model.credit.dim_loanstatus (execute): 01:06:15.448819 => 01:06:18.961171
[0m01:06:18.964807 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74ec6633-897e-4a5a-a917-2ea5bb3da47f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd9f6f36b0>]}
[0m01:06:18.967079 [info ] [Thread-1 (]: 2 of 4 OK created sql table model credit.dim_loanstatus ........................ [[32mCREATE TABLE (2.0 rows, 1.1 MiB processed)[0m in 3.60s]
[0m01:06:18.970308 [debug] [Thread-1 (]: Finished running node model.credit.dim_loanstatus
[0m01:06:18.972392 [debug] [Thread-1 (]: Began running node model.credit.dim_purpose
[0m01:06:18.974246 [info ] [Thread-1 (]: 3 of 4 START sql table model credit.dim_purpose ................................ [RUN]
[0m01:06:18.977018 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_loanstatus, now model.credit.dim_purpose)
[0m01:06:18.978656 [debug] [Thread-1 (]: Began compiling node model.credit.dim_purpose
[0m01:06:18.993710 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_purpose"
[0m01:06:19.016622 [debug] [Thread-1 (]: Timing info for model.credit.dim_purpose (compile): 01:06:18.979977 => 01:06:19.015587
[0m01:06:19.018783 [debug] [Thread-1 (]: Began executing node model.credit.dim_purpose
[0m01:06:19.026813 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:06:28.460283 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_purpose"
[0m01:06:18.996579 [debug] [Thread-1 (]: On model.credit.dim_purpose: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_purpose"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`dim_purpose`
      
    
    

    OPTIONS()
    as (
      

SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast(Purpose as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as PurposeID,
		'Purpose' AS Purpose 
FROM `airflowcrtn`.`credit`.`raw_invoices`
WHERE Purpose  IS NOT NULL
    );
  
[0m01:06:19.516887 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:a0433937-c5c9-4302-ab5d-aea98b02aa32&page=queryresults
[0m01:06:22.490479 [debug] [Thread-1 (]: Timing info for model.credit.dim_purpose (execute): 01:06:19.020537 => 01:06:22.489797
[0m01:06:22.493300 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74ec6633-897e-4a5a-a917-2ea5bb3da47f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd9f6f2690>]}
[0m01:06:22.495205 [info ] [Thread-1 (]: 3 of 4 OK created sql table model credit.dim_purpose ........................... [[32mCREATE TABLE (16.0 rows, 1.7 MiB processed)[0m in 3.52s]
[0m01:06:22.499846 [debug] [Thread-1 (]: Finished running node model.credit.dim_purpose
[0m01:06:22.505769 [debug] [Thread-1 (]: Began running node model.credit.fact_invoices
[0m01:06:22.508210 [info ] [Thread-1 (]: 4 of 4 START sql table model credit.fact_invoices .............................. [RUN]
[0m01:06:22.511540 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_purpose, now model.credit.fact_invoices)
[0m01:06:22.514275 [debug] [Thread-1 (]: Began compiling node model.credit.fact_invoices
[0m01:06:22.544647 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.fact_invoices"
[0m01:06:22.566440 [debug] [Thread-1 (]: Timing info for model.credit.fact_invoices (compile): 01:06:22.516189 => 01:06:22.565538
[0m01:06:22.568314 [debug] [Thread-1 (]: Began executing node model.credit.fact_invoices
[0m01:06:22.575847 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:06:22.994726 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.fact_invoices"
[0m01:06:23.015698 [debug] [Thread-1 (]: On model.credit.fact_invoices: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.fact_invoices"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`fact_invoices`
      
    
    

    OPTIONS()
    as (
      


WITH fct_invoices_cte AS (
    SELECT DISTINCT
        "Loan ID" AS LoanID,
        "Customer ID" AS CustomerID,
        to_hex(md5(cast(coalesce(cast("Loan Status" as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Term as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as LoanStatusID,
        to_hex(md5(cast(coalesce(cast(Purpose as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as PurposeID,
        "Current Loan Amount" AS CurrentLoanAmount,
        "Credit Score" AS CreditScore,
        "Annual Income" AS AnnualIncome,
        "Monthly Debt" AS MonthlyDebt,
        "Years of Credit History" AS YearsofCreditHistory,
        "Months since last delinquent" AS Monthssincelastdelinquent,
        "Number of Open Accounts" AS NumberofOpenAccounts,
        "Number of Credit Problems" AS NumberofCreditProblems,
        "Current Credit Balance" AS CurrentCreditBalance,
        "Maximum Open Credit" AS MaximumOpenCredit,
        "Bankruptcies" AS Bankruptcies,
        "Tax Liens" AS TaxLiens       
      
    FROM `airflowcrtn`.`credit`.`raw_invoices`
    
)
SELECT
   fi.*
FROM fct_invoices_cte fi
INNER JOIN `airflowcrtn`.`credit`.`dim_purpose` dt ON fi.PurposeID = dt.PurposeID
INNER JOIN `airflowcrtn`.`credit`.`dim_loanstatus` dp ON fi.LoanStatusID = dp.LoanStatusID
INNER JOIN `airflowcrtn`.`credit`.`dim_customer` dc ON fi.CustomerID = dc.CustomerID
    );
  
[0m01:06:23.545288 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:67bf33b5-b2f0-4885-ae96-2befeca82d27&page=queryresults
[0m01:08:33.553073 [debug] [Thread-1 (]: Timing info for model.credit.fact_invoices (execute): 01:06:22.569543 => 01:08:33.550821
[0m01:08:33.557950 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74ec6633-897e-4a5a-a917-2ea5bb3da47f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd9c5561b0>]}
[0m01:08:33.561548 [info ] [Thread-1 (]: 4 of 4 OK created sql table model credit.fact_invoices ......................... [[32mCREATE TABLE (3.2m rows, 4.1 MiB processed)[0m in 131.05s]
[0m01:08:33.565123 [debug] [Thread-1 (]: Finished running node model.credit.fact_invoices
[0m01:08:33.576057 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:08:33.578453 [debug] [MainThread]: Connection 'model.credit.fact_invoices' was properly closed.
[0m01:08:33.580356 [info ] [MainThread]: 
[0m01:08:33.582510 [info ] [MainThread]: Finished running 4 table models in 0 hours 2 minutes and 23.05 seconds (143.05s).
[0m01:08:33.590714 [debug] [MainThread]: Command end result
[0m01:08:33.674622 [info ] [MainThread]: 
[0m01:08:33.676677 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:08:33.678565 [info ] [MainThread]: 
[0m01:08:33.681176 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m01:08:33.685511 [debug] [MainThread]: Command `dbt run` succeeded at 01:08:33.684961 after 161.19 seconds
[0m01:08:33.687687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efda1dba4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd9fa6d100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd9f8028a0>]}
[0m01:08:33.689584 [debug] [MainThread]: Flushing usage events
[0m01:09:04.129456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe240ff36b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe240ff3cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe240e1ac60>]}


============================== 01:09:04.134868 | 0cc65dae-91e6-4fe7-a9ff-d71bdbd7f95f ==============================
[0m01:09:04.134868 [info ] [MainThread]: Running with dbt=1.6.18
[0m01:09:04.139045 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'debug': 'False', 'introspect': 'True', 'partial_parse': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'static_parser': 'True', 'log_cache_events': 'False', 'quiet': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'cache_selected_only': 'False', 'use_colors': 'True', 'target_path': 'None', 'fail_fast': 'False', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'warn_error': 'None', 'printer_width': '80', 'version_check': 'True'}
[0m01:09:05.078629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0cc65dae-91e6-4fe7-a9ff-d71bdbd7f95f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe23edd6660>]}
[0m01:09:05.123891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0cc65dae-91e6-4fe7-a9ff-d71bdbd7f95f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe23f3acf50>]}
[0m01:09:05.126069 [info ] [MainThread]: Registered adapter: bigquery=1.6.0
[0m01:09:05.212448 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m01:09:05.274299 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m01:09:05.276321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0cc65dae-91e6-4fe7-a9ff-d71bdbd7f95f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe23ec35820>]}
[0m01:09:10.419597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0cc65dae-91e6-4fe7-a9ff-d71bdbd7f95f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe23ea71970>]}
[0m01:09:10.482523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0cc65dae-91e6-4fe7-a9ff-d71bdbd7f95f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe23ebc41a0>]}
[0m01:09:10.484302 [info ] [MainThread]: Found 4 models, 1 source, 0 exposures, 0 metrics, 509 macros, 0 groups, 0 semantic models
[0m01:09:10.486268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cc65dae-91e6-4fe7-a9ff-d71bdbd7f95f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe23ece0500>]}
[0m01:09:10.493810 [info ] [MainThread]: 
[0m01:09:10.501365 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:09:10.506282 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflowcrtn'
[0m01:09:10.508413 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:09:11.012188 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflowcrtn, now list_airflowcrtn_credit)
[0m01:09:11.014159 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:09:11.441826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cc65dae-91e6-4fe7-a9ff-d71bdbd7f95f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe23eea16a0>]}
[0m01:09:11.445019 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:09:11.446765 [info ] [MainThread]: 
[0m01:09:11.455392 [debug] [Thread-1 (]: Began running node model.credit.dim_customer
[0m01:09:11.457436 [info ] [Thread-1 (]: 1 of 4 START sql table model credit.dim_customer ............................... [RUN]
[0m01:09:11.460711 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflowcrtn_credit, now model.credit.dim_customer)
[0m01:09:11.462272 [debug] [Thread-1 (]: Began compiling node model.credit.dim_customer
[0m01:09:11.492101 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_customer"
[0m01:09:11.514804 [debug] [Thread-1 (]: Timing info for model.credit.dim_customer (compile): 01:09:11.463692 => 01:09:11.513577
[0m01:09:11.517088 [debug] [Thread-1 (]: Began executing node model.credit.dim_customer
[0m01:09:11.562614 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:09:12.074756 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_customer"
[0m01:09:12.095203 [debug] [Thread-1 (]: On model.credit.dim_customer: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_customer"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`dim_customer`
      
    
    

    OPTIONS()
    as (
      


SELECT 
	    "Customer ID" as CustomerID,
	    "Years in Current Job" as YearsinCurrentJob,
         "Home Ownership" as HomeOwnership 
	FROM  credit.raw_invoices
    );
  
[0m01:09:12.748961 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:4aeb65a2-e392-45bf-9ed3-026572711c37&page=queryresults
[0m01:09:15.114269 [debug] [Thread-1 (]: Timing info for model.credit.dim_customer (execute): 01:09:11.518795 => 01:09:15.113641
[0m01:09:15.117569 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cc65dae-91e6-4fe7-a9ff-d71bdbd7f95f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe23eb6b980>]}
[0m01:09:15.120045 [info ] [Thread-1 (]: 1 of 4 OK created sql table model credit.dim_customer .......................... [[32mCREATE TABLE (100.0k rows, 0 processed)[0m in 3.66s]
[0m01:09:15.123574 [debug] [Thread-1 (]: Finished running node model.credit.dim_customer
[0m01:09:15.125820 [debug] [Thread-1 (]: Began running node model.credit.dim_loanstatus
[0m01:09:15.127780 [info ] [Thread-1 (]: 2 of 4 START sql table model credit.dim_loanstatus ............................. [RUN]
[0m01:09:15.131113 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_customer, now model.credit.dim_loanstatus)
[0m01:09:15.134694 [debug] [Thread-1 (]: Began compiling node model.credit.dim_loanstatus
[0m01:09:15.154831 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_loanstatus"
[0m01:09:15.179091 [debug] [Thread-1 (]: Timing info for model.credit.dim_loanstatus (compile): 01:09:15.136373 => 01:09:15.178123
[0m01:09:15.181209 [debug] [Thread-1 (]: Began executing node model.credit.dim_loanstatus
[0m01:09:15.189796 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:09:15.640460 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_loanstatus"
[0m01:09:15.664125 [debug] [Thread-1 (]: On model.credit.dim_loanstatus: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_loanstatus"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`dim_loanstatus`
      
    
    

    OPTIONS()
    as (
      


SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast("Loan Status" as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Term as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as LoanStatusID,
	    "Loan Status" AS LoanStatus,
        'Term' AS Term

FROM `airflowcrtn`.`credit`.`raw_invoices`
WHERE "Loan Status" IS NOT NULL
    );
  
[0m01:09:16.306310 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:00aa9ea3-7e33-4061-9dac-fca8f9931add&page=queryresults
[0m01:09:18.912755 [debug] [Thread-1 (]: Timing info for model.credit.dim_loanstatus (execute): 01:09:15.182729 => 01:09:18.912126
[0m01:09:18.915830 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cc65dae-91e6-4fe7-a9ff-d71bdbd7f95f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe23d33d460>]}
[0m01:09:18.917911 [info ] [Thread-1 (]: 2 of 4 OK created sql table model credit.dim_loanstatus ........................ [[32mCREATE TABLE (2.0 rows, 1.1 MiB processed)[0m in 3.79s]
[0m01:09:18.922655 [debug] [Thread-1 (]: Finished running node model.credit.dim_loanstatus
[0m01:09:18.925085 [debug] [Thread-1 (]: Began running node model.credit.dim_purpose
[0m01:09:18.926907 [info ] [Thread-1 (]: 3 of 4 START sql table model credit.dim_purpose ................................ [RUN]
[0m01:09:18.929932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_loanstatus, now model.credit.dim_purpose)
[0m01:09:18.931767 [debug] [Thread-1 (]: Began compiling node model.credit.dim_purpose
[0m01:09:18.950576 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_purpose"
[0m01:09:18.974129 [debug] [Thread-1 (]: Timing info for model.credit.dim_purpose (compile): 01:09:18.933009 => 01:09:18.973071
[0m01:09:18.976111 [debug] [Thread-1 (]: Began executing node model.credit.dim_purpose
[0m01:09:18.992007 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:09:19.570816 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_purpose"
[0m01:09:19.591026 [debug] [Thread-1 (]: On model.credit.dim_purpose: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_purpose"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`dim_purpose`
      
    
    

    OPTIONS()
    as (
      

SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast(Purpose as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as PurposeID,
		'Purpose' AS Purpose 
FROM `airflowcrtn`.`credit`.`raw_invoices`
WHERE Purpose  IS NOT NULL
    );
  
[0m01:09:19.638765 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:8a3bc300-d89f-45b7-9d4e-248d0ceb4d98&page=queryresults
[0m01:09:22.447954 [debug] [Thread-1 (]: Timing info for model.credit.dim_purpose (execute): 01:09:18.977560 => 01:09:22.447315
[0m01:09:22.451353 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cc65dae-91e6-4fe7-a9ff-d71bdbd7f95f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe23d34be30>]}
[0m01:09:22.454072 [info ] [Thread-1 (]: 3 of 4 OK created sql table model credit.dim_purpose ........................... [[32mCREATE TABLE (16.0 rows, 1.7 MiB processed)[0m in 3.52s]
[0m01:09:22.462613 [debug] [Thread-1 (]: Finished running node model.credit.dim_purpose
[0m01:09:22.467061 [debug] [Thread-1 (]: Began running node model.credit.fact_invoices
[0m01:09:22.469300 [info ] [Thread-1 (]: 4 of 4 START sql table model credit.fact_invoices .............................. [RUN]
[0m01:09:22.473988 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_purpose, now model.credit.fact_invoices)
[0m01:09:22.476736 [debug] [Thread-1 (]: Began compiling node model.credit.fact_invoices
[0m01:09:22.512955 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.fact_invoices"
[0m01:09:22.532846 [debug] [Thread-1 (]: Timing info for model.credit.fact_invoices (compile): 01:09:22.479012 => 01:09:22.531854
[0m01:09:22.534690 [debug] [Thread-1 (]: Began executing node model.credit.fact_invoices
[0m01:09:22.542799 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:09:23.006557 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.fact_invoices"
[0m01:09:23.028140 [debug] [Thread-1 (]: On model.credit.fact_invoices: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.fact_invoices"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`fact_invoices`
      
    
    

    OPTIONS()
    as (
      


WITH fct_invoices_cte AS (
    SELECT DISTINCT
        "Loan ID" AS LoanID,
        "Customer ID" AS CustomerID,
        to_hex(md5(cast(coalesce(cast("Loan Status" as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Term as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as LoanStatusID,
        to_hex(md5(cast(coalesce(cast(Purpose as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as PurposeID,
        "Current Loan Amount" AS CurrentLoanAmount,
        "Credit Score" AS CreditScore,
        "Annual Income" AS AnnualIncome,
        "Monthly Debt" AS MonthlyDebt,
        "Years of Credit History" AS YearsofCreditHistory,
        "Months since last delinquent" AS Monthssincelastdelinquent,
        "Number of Open Accounts" AS NumberofOpenAccounts,
        "Number of Credit Problems" AS NumberofCreditProblems,
        "Current Credit Balance" AS CurrentCreditBalance,
        "Maximum Open Credit" AS MaximumOpenCredit,
        "Bankruptcies" AS Bankruptcies,
        "Tax Liens" AS TaxLiens       
      
    FROM `airflowcrtn`.`credit`.`raw_invoices`
    
)
SELECT
   fi.*
FROM fct_invoices_cte fi
INNER JOIN `airflowcrtn`.`credit`.`dim_purpose` dt ON fi.PurposeID = dt.PurposeID
INNER JOIN `airflowcrtn`.`credit`.`dim_loanstatus` dp ON fi.LoanStatusID = dp.LoanStatusID
INNER JOIN `airflowcrtn`.`credit`.`dim_customer` dc ON fi.CustomerID = dc.CustomerID
    );
  
[0m01:09:23.690865 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:2cd0641b-9546-4008-8afb-4b684ea5f78b&page=queryresults
[0m01:09:28.040306 [debug] [Thread-1 (]: Timing info for model.credit.fact_invoices (execute): 01:09:22.536148 => 01:09:28.039671
[0m01:09:28.043338 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cc65dae-91e6-4fe7-a9ff-d71bdbd7f95f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe23d34b3e0>]}
[0m01:09:28.045344 [info ] [Thread-1 (]: 4 of 4 OK created sql table model credit.fact_invoices ......................... [[32mCREATE TABLE (3.2m rows, 4.1 MiB processed)[0m in 5.57s]
[0m01:09:28.050976 [debug] [Thread-1 (]: Finished running node model.credit.fact_invoices
[0m01:09:28.057837 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:09:28.059267 [debug] [MainThread]: Connection 'model.credit.fact_invoices' was properly closed.
[0m01:09:28.060963 [info ] [MainThread]: 
[0m01:09:28.064104 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 17.56 seconds (17.56s).
[0m01:09:28.072175 [debug] [MainThread]: Command end result
[0m01:09:28.131226 [info ] [MainThread]: 
[0m01:09:28.133489 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:09:28.135571 [info ] [MainThread]: 
[0m01:09:28.138027 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m01:09:28.141593 [debug] [MainThread]: Command `dbt run` succeeded at 01:09:28.141097 after 26.59 seconds
[0m01:09:28.143437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe241134200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe23eb0d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe23ece3860>]}
[0m01:09:28.145471 [debug] [MainThread]: Flushing usage events
[0m01:17:10.779428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8fda88d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8fdab8140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8fdd2b950>]}


============================== 01:17:10.784475 | 0d549908-816a-4788-9844-85bfff2cbc24 ==============================
[0m01:17:10.784475 [info ] [MainThread]: Running with dbt=1.6.18
[0m01:17:10.786744 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'target_path': 'None', 'write_json': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'warn_error': 'None', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'cache_selected_only': 'False', 'introspect': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'static_parser': 'True', 'quiet': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'no_print': 'None'}
[0m01:17:12.186847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d549908-816a-4788-9844-85bfff2cbc24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8fc269c70>]}
[0m01:17:12.231789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d549908-816a-4788-9844-85bfff2cbc24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8fb922c60>]}
[0m01:17:12.234113 [info ] [MainThread]: Registered adapter: bigquery=1.6.0
[0m01:17:12.330327 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m01:17:14.378022 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m01:17:14.380508 [debug] [MainThread]: Partial parsing: updated file: credit://models/transform/dim_customer.sql
[0m01:17:14.382396 [debug] [MainThread]: Partial parsing: updated file: credit://models/transform/dim_loanstatus.sql
[0m01:17:14.620875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d549908-816a-4788-9844-85bfff2cbc24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8fb783aa0>]}
[0m01:17:14.683242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d549908-816a-4788-9844-85bfff2cbc24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8fb76c0b0>]}
[0m01:17:14.685191 [info ] [MainThread]: Found 4 models, 1 source, 0 exposures, 0 metrics, 509 macros, 0 groups, 0 semantic models
[0m01:17:14.687040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d549908-816a-4788-9844-85bfff2cbc24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8fb76dd00>]}
[0m01:17:14.692913 [info ] [MainThread]: 
[0m01:17:14.696575 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:17:14.701977 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflowcrtn'
[0m01:17:14.704084 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:17:15.221969 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflowcrtn, now list_airflowcrtn_credit)
[0m01:17:15.223947 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:17:15.156940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d549908-816a-4788-9844-85bfff2cbc24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8fc0a7b90>]}
[0m01:17:15.160898 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:17:15.163446 [info ] [MainThread]: 
[0m01:17:15.175370 [debug] [Thread-1 (]: Began running node model.credit.dim_customer
[0m01:17:15.177404 [info ] [Thread-1 (]: 1 of 4 START sql table model credit.dim_customer ............................... [RUN]
[0m01:17:15.180647 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflowcrtn_credit, now model.credit.dim_customer)
[0m01:17:15.182514 [debug] [Thread-1 (]: Began compiling node model.credit.dim_customer
[0m01:17:15.221199 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_customer"
[0m01:17:15.240956 [debug] [Thread-1 (]: Timing info for model.credit.dim_customer (compile): 01:17:15.184037 => 01:17:15.239435
[0m01:17:15.243147 [debug] [Thread-1 (]: Began executing node model.credit.dim_customer
[0m01:17:15.286941 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:17:15.789503 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_customer"
[0m01:17:15.806868 [debug] [Thread-1 (]: On model.credit.dim_customer: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_customer"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`dim_customer`
      
    
    

    OPTIONS()
    as (
      

SELECT 
	    "Customer ID" as CustomerID,
	    "Years in Current Job" as YearsinCurrentJob,
         "Home Ownership" as HomeOwnership 
FROM  credit.raw_invoices
    );
  
[0m01:17:16.509410 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:f6c597d8-3109-4ce0-a187-8cef4d0c6045&page=queryresults
[0m01:17:19.577127 [debug] [Thread-1 (]: Timing info for model.credit.dim_customer (execute): 01:17:15.244498 => 01:17:19.576486
[0m01:17:19.580207 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d549908-816a-4788-9844-85bfff2cbc24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8fb76d160>]}
[0m01:17:19.582552 [info ] [Thread-1 (]: 1 of 4 OK created sql table model credit.dim_customer .......................... [[32mCREATE TABLE (100.0k rows, 0 processed)[0m in 4.40s]
[0m01:17:19.585874 [debug] [Thread-1 (]: Finished running node model.credit.dim_customer
[0m01:17:19.588085 [debug] [Thread-1 (]: Began running node model.credit.dim_loanstatus
[0m01:17:19.590107 [info ] [Thread-1 (]: 2 of 4 START sql table model credit.dim_loanstatus ............................. [RUN]
[0m01:17:19.593663 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_customer, now model.credit.dim_loanstatus)
[0m01:17:19.595828 [debug] [Thread-1 (]: Began compiling node model.credit.dim_loanstatus
[0m01:17:19.613328 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_loanstatus"
[0m01:17:19.633801 [debug] [Thread-1 (]: Timing info for model.credit.dim_loanstatus (compile): 01:17:19.597270 => 01:17:19.632686
[0m01:17:19.635639 [debug] [Thread-1 (]: Began executing node model.credit.dim_loanstatus
[0m01:17:19.645223 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:17:20.087001 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_loanstatus"
[0m01:17:20.103226 [debug] [Thread-1 (]: On model.credit.dim_loanstatus: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_loanstatus"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`dim_loanstatus`
      
    
    

    OPTIONS()
    as (
      


SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast("Loan Status" as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Term as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as LoanStatusID,
	     LoanStatus,
         Term

FROM credit.raw_invoices
    );
  
[0m01:17:20.122663 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:c4019ae9-1a33-49e6-a92c-11a90f3aa45e&page=queryresults
[0m01:17:21.097937 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: LoanStatus; Did you mean Loan Status? at [18:14]; reason: invalidQuery, location: query, message: Unrecognized name: LoanStatus; Did you mean Loan Status? at [18:14]')
[0m01:17:21.861619 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:8a557db6-edf9-4af2-a260-ff6af4ab6d3a&page=queryresults
[0m01:17:22.090853 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:8a557db6-edf9-4af2-a260-ff6af4ab6d3a&page=queryresults
[0m01:17:22.094242 [debug] [Thread-1 (]: Timing info for model.credit.dim_loanstatus (execute): 01:17:19.637165 => 01:17:22.093266
[0m01:17:22.111251 [debug] [Thread-1 (]: Database Error in model dim_loanstatus (models/transform/dim_loanstatus.sql)
  Unrecognized name: LoanStatus; Did you mean Loan Status? at [18:14]
  compiled Code at target/run/credit/models/transform/dim_loanstatus.sql
[0m01:17:22.113306 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d549908-816a-4788-9844-85bfff2cbc24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8fb90c6e0>]}
[0m01:17:22.115547 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model credit.dim_loanstatus .................... [[31mERROR[0m in 2.52s]
[0m01:17:22.119463 [debug] [Thread-1 (]: Finished running node model.credit.dim_loanstatus
[0m01:17:22.122341 [debug] [Thread-1 (]: Began running node model.credit.dim_purpose
[0m01:17:22.126656 [info ] [Thread-1 (]: 3 of 4 START sql table model credit.dim_purpose ................................ [RUN]
[0m01:17:22.130231 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_loanstatus, now model.credit.dim_purpose)
[0m01:17:22.132073 [debug] [Thread-1 (]: Began compiling node model.credit.dim_purpose
[0m01:17:22.147521 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_purpose"
[0m01:17:22.171984 [debug] [Thread-1 (]: Timing info for model.credit.dim_purpose (compile): 01:17:22.133450 => 01:17:22.170802
[0m01:17:22.173938 [debug] [Thread-1 (]: Began executing node model.credit.dim_purpose
[0m01:17:22.182357 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:17:22.623309 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_purpose"
[0m01:17:22.643819 [debug] [Thread-1 (]: On model.credit.dim_purpose: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_purpose"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`dim_purpose`
      
    
    

    OPTIONS()
    as (
      

SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast(Purpose as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as PurposeID,
		'Purpose' AS Purpose 
FROM `airflowcrtn`.`credit`.`raw_invoices`
WHERE Purpose  IS NOT NULL
    );
  
[0m01:17:23.237688 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:bd14b996-8586-4b8f-ade3-e651e7441ed9&page=queryresults
[0m01:17:25.464833 [debug] [Thread-1 (]: Timing info for model.credit.dim_purpose (execute): 01:17:22.175440 => 01:17:25.464128
[0m01:17:25.469194 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d549908-816a-4788-9844-85bfff2cbc24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8f9d3d070>]}
[0m01:17:25.471666 [info ] [Thread-1 (]: 3 of 4 OK created sql table model credit.dim_purpose ........................... [[32mCREATE TABLE (16.0 rows, 1.7 MiB processed)[0m in 3.34s]
[0m01:17:25.474589 [debug] [Thread-1 (]: Finished running node model.credit.dim_purpose
[0m01:17:25.479866 [debug] [Thread-1 (]: Began running node model.credit.fact_invoices
[0m01:17:25.481815 [info ] [Thread-1 (]: 4 of 4 SKIP relation credit.fact_invoices ...................................... [[33mSKIP[0m]
[0m01:17:25.483795 [debug] [Thread-1 (]: Finished running node model.credit.fact_invoices
[0m01:17:25.491259 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:17:25.493164 [debug] [MainThread]: Connection 'model.credit.dim_purpose' was properly closed.
[0m01:17:25.495118 [info ] [MainThread]: 
[0m01:17:25.497205 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 10.80 seconds (10.80s).
[0m01:17:25.503348 [debug] [MainThread]: Command end result
[0m01:17:25.587460 [info ] [MainThread]: 
[0m01:17:25.589793 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:17:25.591627 [info ] [MainThread]: 
[0m01:17:25.593357 [error] [MainThread]:   Database Error in model dim_loanstatus (models/transform/dim_loanstatus.sql)
  Unrecognized name: LoanStatus; Did you mean Loan Status? at [18:14]
  compiled Code at target/run/credit/models/transform/dim_loanstatus.sql
[0m01:17:25.595034 [info ] [MainThread]: 
[0m01:17:25.597320 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m01:17:25.600252 [debug] [MainThread]: Command `dbt run` failed at 01:17:25.599768 after 16.39 seconds
[0m01:17:25.602333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8fdc96ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8fbadc620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8fba7bf20>]}
[0m01:17:25.604510 [debug] [MainThread]: Flushing usage events
[0m01:18:09.534976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fb5c94bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fb61f1970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fb5c95b80>]}


============================== 01:18:09.539929 | 49c13086-42e5-4988-bfde-2a00d80f2aff ==============================
[0m01:18:09.539929 [info ] [MainThread]: Running with dbt=1.6.18
[0m01:18:09.542849 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'version_check': 'True', 'partial_parse': 'True', 'static_parser': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'cache_selected_only': 'False', 'write_json': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'fail_fast': 'False', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'log_cache_events': 'False', 'warn_error': 'None', 'target_path': 'None', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'no_print': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:18:10.960077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49c13086-42e5-4988-bfde-2a00d80f2aff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fb3fcfe60>]}
[0m01:18:11.006447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49c13086-42e5-4988-bfde-2a00d80f2aff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fb3dd6120>]}
[0m01:18:11.009027 [info ] [MainThread]: Registered adapter: bigquery=1.6.0
[0m01:18:11.107561 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m01:18:13.329732 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:18:13.333527 [debug] [MainThread]: Partial parsing: updated file: credit://models/transform/dim_loanstatus.sql
[0m01:18:13.547687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49c13086-42e5-4988-bfde-2a00d80f2aff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fb4656420>]}
[0m01:18:13.611725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49c13086-42e5-4988-bfde-2a00d80f2aff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fb3c49790>]}
[0m01:18:13.613628 [info ] [MainThread]: Found 4 models, 1 source, 0 exposures, 0 metrics, 509 macros, 0 groups, 0 semantic models
[0m01:18:13.615494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49c13086-42e5-4988-bfde-2a00d80f2aff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fb4553ad0>]}
[0m01:18:13.624681 [info ] [MainThread]: 
[0m01:18:13.628255 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:18:13.633765 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflowcrtn'
[0m01:18:13.636062 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:18:14.111610 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflowcrtn, now list_airflowcrtn_credit)
[0m01:18:14.113449 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:18:14.542347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49c13086-42e5-4988-bfde-2a00d80f2aff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fb5c97140>]}
[0m01:18:14.545545 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:18:14.548288 [info ] [MainThread]: 
[0m01:18:14.561496 [debug] [Thread-1 (]: Began running node model.credit.dim_customer
[0m01:18:14.563825 [info ] [Thread-1 (]: 1 of 4 START sql table model credit.dim_customer ............................... [RUN]
[0m01:18:14.567012 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflowcrtn_credit, now model.credit.dim_customer)
[0m01:18:14.569361 [debug] [Thread-1 (]: Began compiling node model.credit.dim_customer
[0m01:18:14.605965 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_customer"
[0m01:18:14.626854 [debug] [Thread-1 (]: Timing info for model.credit.dim_customer (compile): 01:18:14.572243 => 01:18:14.625835
[0m01:18:14.628461 [debug] [Thread-1 (]: Began executing node model.credit.dim_customer
[0m01:18:14.672566 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:15.279876 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_customer"
[0m01:18:15.300132 [debug] [Thread-1 (]: On model.credit.dim_customer: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_customer"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`dim_customer`
      
    
    

    OPTIONS()
    as (
      

SELECT 
	    "Customer ID" as CustomerID,
	    "Years in Current Job" as YearsinCurrentJob,
         "Home Ownership" as HomeOwnership 
FROM  credit.raw_invoices
    );
  
[0m01:18:16.087621 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:8bd6c9d1-7777-4bcc-916e-2503daa2d4a1&page=queryresults
[0m01:18:18.638353 [debug] [Thread-1 (]: Timing info for model.credit.dim_customer (execute): 01:18:14.629867 => 01:18:18.637529
[0m01:18:18.641755 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49c13086-42e5-4988-bfde-2a00d80f2aff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fb3c485f0>]}
[0m01:18:18.644211 [info ] [Thread-1 (]: 1 of 4 OK created sql table model credit.dim_customer .......................... [[32mCREATE TABLE (100.0k rows, 0 processed)[0m in 4.08s]
[0m01:18:18.652843 [debug] [Thread-1 (]: Finished running node model.credit.dim_customer
[0m01:18:18.655784 [debug] [Thread-1 (]: Began running node model.credit.dim_loanstatus
[0m01:18:18.658171 [info ] [Thread-1 (]: 2 of 4 START sql table model credit.dim_loanstatus ............................. [RUN]
[0m01:18:18.661296 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_customer, now model.credit.dim_loanstatus)
[0m01:18:18.663546 [debug] [Thread-1 (]: Began compiling node model.credit.dim_loanstatus
[0m01:18:18.678264 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_loanstatus"
[0m01:18:18.699895 [debug] [Thread-1 (]: Timing info for model.credit.dim_loanstatus (compile): 01:18:18.665227 => 01:18:18.698648
[0m01:18:18.701970 [debug] [Thread-1 (]: Began executing node model.credit.dim_loanstatus
[0m01:18:18.710615 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:19.154258 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_loanstatus"
[0m01:18:19.169651 [debug] [Thread-1 (]: On model.credit.dim_loanstatus: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_loanstatus"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`dim_loanstatus`
      
    
    

    OPTIONS()
    as (
      


SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast("Loan Status" as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Term as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as LoanStatusID,
	     
         Term

FROM credit.raw_invoices
    );
  
[0m01:18:19.694468 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:5c96eb09-a157-47cd-bb0d-003d78dfc120&page=queryresults
[0m01:18:11.170682 [debug] [Thread-1 (]: Timing info for model.credit.dim_loanstatus (execute): 01:18:18.703597 => 01:18:11.169565
[0m01:18:11.174172 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49c13086-42e5-4988-bfde-2a00d80f2aff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fb3c09d90>]}
[0m01:18:11.176306 [info ] [Thread-1 (]: 2 of 4 OK created sql table model credit.dim_loanstatus ........................ [[32mCREATE TABLE (2.0 rows, 1.1 MiB processed)[0m in -7.49s]
[0m01:18:11.183339 [debug] [Thread-1 (]: Finished running node model.credit.dim_loanstatus
[0m01:18:11.188074 [debug] [Thread-1 (]: Began running node model.credit.dim_purpose
[0m01:18:11.193378 [info ] [Thread-1 (]: 3 of 4 START sql table model credit.dim_purpose ................................ [RUN]
[0m01:18:11.197536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_loanstatus, now model.credit.dim_purpose)
[0m01:18:11.199529 [debug] [Thread-1 (]: Began compiling node model.credit.dim_purpose
[0m01:18:11.217820 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_purpose"
[0m01:18:11.239112 [debug] [Thread-1 (]: Timing info for model.credit.dim_purpose (compile): 01:18:11.201522 => 01:18:11.238131
[0m01:18:11.241147 [debug] [Thread-1 (]: Began executing node model.credit.dim_purpose
[0m01:18:11.249841 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:11.669022 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_purpose"
[0m01:18:11.685900 [debug] [Thread-1 (]: On model.credit.dim_purpose: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_purpose"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`dim_purpose`
      
    
    

    OPTIONS()
    as (
      

SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast(Purpose as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as PurposeID,
		'Purpose' AS Purpose 
FROM `airflowcrtn`.`credit`.`raw_invoices`
WHERE Purpose  IS NOT NULL
    );
  
[0m01:18:12.405609 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:5495aba1-49ea-4828-bf15-112a48d46f44&page=queryresults
[0m01:18:14.796908 [debug] [Thread-1 (]: Timing info for model.credit.dim_purpose (execute): 01:18:11.242683 => 01:18:14.795677
[0m01:18:14.803353 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49c13086-42e5-4988-bfde-2a00d80f2aff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fb3bc9880>]}
[0m01:18:14.805956 [info ] [Thread-1 (]: 3 of 4 OK created sql table model credit.dim_purpose ........................... [[32mCREATE TABLE (16.0 rows, 1.7 MiB processed)[0m in 3.61s]
[0m01:18:14.809264 [debug] [Thread-1 (]: Finished running node model.credit.dim_purpose
[0m01:18:14.813899 [debug] [Thread-1 (]: Began running node model.credit.fact_invoices
[0m01:18:14.815922 [info ] [Thread-1 (]: 4 of 4 START sql table model credit.fact_invoices .............................. [RUN]
[0m01:18:14.819360 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_purpose, now model.credit.fact_invoices)
[0m01:18:14.821053 [debug] [Thread-1 (]: Began compiling node model.credit.fact_invoices
[0m01:18:14.848314 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.fact_invoices"
[0m01:18:14.871634 [debug] [Thread-1 (]: Timing info for model.credit.fact_invoices (compile): 01:18:14.822592 => 01:18:14.870533
[0m01:18:14.873641 [debug] [Thread-1 (]: Began executing node model.credit.fact_invoices
[0m01:18:14.881386 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:15.305987 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.fact_invoices"
[0m01:18:15.330360 [debug] [Thread-1 (]: On model.credit.fact_invoices: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.fact_invoices"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`fact_invoices`
      
    
    

    OPTIONS()
    as (
      


WITH fct_invoices_cte AS (
    SELECT DISTINCT
        "Loan ID" AS LoanID,
        "Customer ID" AS CustomerID,
        to_hex(md5(cast(coalesce(cast("Loan Status" as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Term as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as LoanStatusID,
        to_hex(md5(cast(coalesce(cast(Purpose as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as PurposeID,
        "Current Loan Amount" AS CurrentLoanAmount,
        "Credit Score" AS CreditScore,
        "Annual Income" AS AnnualIncome,
        "Monthly Debt" AS MonthlyDebt,
        "Years of Credit History" AS YearsofCreditHistory,
        "Months since last delinquent" AS Monthssincelastdelinquent,
        "Number of Open Accounts" AS NumberofOpenAccounts,
        "Number of Credit Problems" AS NumberofCreditProblems,
        "Current Credit Balance" AS CurrentCreditBalance,
        "Maximum Open Credit" AS MaximumOpenCredit,
        "Bankruptcies" AS Bankruptcies,
        "Tax Liens" AS TaxLiens       
      
    FROM `airflowcrtn`.`credit`.`raw_invoices`
    
)
SELECT
   fi.*
FROM fct_invoices_cte fi
INNER JOIN `airflowcrtn`.`credit`.`dim_purpose` dt ON fi.PurposeID = dt.PurposeID
INNER JOIN `airflowcrtn`.`credit`.`dim_loanstatus` dp ON fi.LoanStatusID = dp.LoanStatusID
INNER JOIN `airflowcrtn`.`credit`.`dim_customer` dc ON fi.CustomerID = dc.CustomerID
    );
  
[0m01:18:15.288905 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:cdc08887-ab01-44d2-bf9c-5a22bd868f01&page=queryresults
[0m01:18:20.097063 [debug] [Thread-1 (]: Timing info for model.credit.fact_invoices (execute): 01:18:14.875097 => 01:18:20.096441
[0m01:18:20.100379 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49c13086-42e5-4988-bfde-2a00d80f2aff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fb1a77d40>]}
[0m01:18:20.102976 [info ] [Thread-1 (]: 4 of 4 OK created sql table model credit.fact_invoices ......................... [[32mCREATE TABLE (3.2m rows, 4.1 MiB processed)[0m in 5.28s]
[0m01:18:20.108356 [debug] [Thread-1 (]: Finished running node model.credit.fact_invoices
[0m01:18:20.117785 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:18:20.120426 [debug] [MainThread]: Connection 'model.credit.fact_invoices' was properly closed.
[0m01:18:20.122165 [info ] [MainThread]: 
[0m01:18:20.127712 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 6.50 seconds (6.50s).
[0m01:18:20.137159 [debug] [MainThread]: Command end result
[0m01:18:20.212671 [info ] [MainThread]: 
[0m01:18:20.215303 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:18:20.217868 [info ] [MainThread]: 
[0m01:18:20.220269 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m01:18:20.227076 [debug] [MainThread]: Command `dbt run` succeeded at 01:18:20.226444 after 22.57 seconds
[0m01:18:20.229330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fb62be030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fb1a80260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fb1a819a0>]}
[0m01:18:20.231538 [debug] [MainThread]: Flushing usage events
[0m01:19:38.090172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50bc4cde20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50bd4b96a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50bd590bf0>]}


============================== 01:19:38.095577 | 04a230d2-8205-4a6b-bf95-8488dfe157a6 ==============================
[0m01:19:38.095577 [info ] [MainThread]: Running with dbt=1.6.18
[0m01:19:38.099734 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'use_experimental_parser': 'False', 'target_path': 'None', 'cache_selected_only': 'False', 'debug': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'write_json': 'True', 'log_cache_events': 'False', 'version_check': 'True', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'log_path': '/usr/local/airflow/include/dbt/logs', 'warn_error': 'None', 'indirect_selection': 'eager', 'use_colors': 'True', 'introspect': 'True', 'static_parser': 'True', 'partial_parse': 'True', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'quiet': 'False', 'printer_width': '80'}
[0m01:19:39.585770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '04a230d2-8205-4a6b-bf95-8488dfe157a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ba7a6630>]}
[0m01:19:39.645447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '04a230d2-8205-4a6b-bf95-8488dfe157a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ba60cc80>]}
[0m01:19:39.648288 [info ] [MainThread]: Registered adapter: bigquery=1.6.0
[0m01:19:39.739729 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m01:19:41.468226 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:19:41.470748 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:19:41.506379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '04a230d2-8205-4a6b-bf95-8488dfe157a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50bafc9cd0>]}
[0m01:19:41.585601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '04a230d2-8205-4a6b-bf95-8488dfe157a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ba452ff0>]}
[0m01:19:41.587863 [info ] [MainThread]: Found 4 models, 1 source, 0 exposures, 0 metrics, 509 macros, 0 groups, 0 semantic models
[0m01:19:41.590175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04a230d2-8205-4a6b-bf95-8488dfe157a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ba451310>]}
[0m01:19:41.598401 [info ] [MainThread]: 
[0m01:19:41.602827 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:19:41.614235 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflowcrtn'
[0m01:19:41.616230 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:19:42.097257 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflowcrtn, now list_airflowcrtn_credit)
[0m01:19:42.099154 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:19:42.516933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04a230d2-8205-4a6b-bf95-8488dfe157a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50badc2330>]}
[0m01:19:42.520500 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:19:42.523571 [info ] [MainThread]: 
[0m01:19:42.540803 [debug] [Thread-1 (]: Began running node model.credit.dim_customer
[0m01:19:42.543705 [info ] [Thread-1 (]: 1 of 4 START sql table model credit.dim_customer ............................... [RUN]
[0m01:19:42.547716 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflowcrtn_credit, now model.credit.dim_customer)
[0m01:19:42.549927 [debug] [Thread-1 (]: Began compiling node model.credit.dim_customer
[0m01:19:42.579058 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_customer"
[0m01:19:42.598508 [debug] [Thread-1 (]: Timing info for model.credit.dim_customer (compile): 01:19:42.551294 => 01:19:42.597217
[0m01:19:42.601192 [debug] [Thread-1 (]: Began executing node model.credit.dim_customer
[0m01:19:42.655047 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:19:43.180055 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_customer"
[0m01:19:43.202619 [debug] [Thread-1 (]: On model.credit.dim_customer: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_customer"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`dim_customer`
      
    
    

    OPTIONS()
    as (
      

SELECT 
	    "Customer ID" as CustomerID,
	    "Years in Current Job" as YearsinCurrentJob,
         "Home Ownership" as HomeOwnership 
FROM  credit.raw_invoices
    );
  
[0m01:19:44.087694 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:056dfffa-ede8-4fe3-9ad5-36e44fe01c1b&page=queryresults
[0m01:19:45.984179 [debug] [Thread-1 (]: Timing info for model.credit.dim_customer (execute): 01:19:42.602908 => 01:19:45.983522
[0m01:19:45.987271 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04a230d2-8205-4a6b-bf95-8488dfe157a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ba60cb30>]}
[0m01:19:45.989479 [info ] [Thread-1 (]: 1 of 4 OK created sql table model credit.dim_customer .......................... [[32mCREATE TABLE (100.0k rows, 0 processed)[0m in 3.44s]
[0m01:19:45.993646 [debug] [Thread-1 (]: Finished running node model.credit.dim_customer
[0m01:19:45.996049 [debug] [Thread-1 (]: Began running node model.credit.dim_loanstatus
[0m01:19:45.998067 [info ] [Thread-1 (]: 2 of 4 START sql table model credit.dim_loanstatus ............................. [RUN]
[0m01:19:46.001842 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_customer, now model.credit.dim_loanstatus)
[0m01:19:46.003845 [debug] [Thread-1 (]: Began compiling node model.credit.dim_loanstatus
[0m01:19:46.071785 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_loanstatus"
[0m01:19:46.095193 [debug] [Thread-1 (]: Timing info for model.credit.dim_loanstatus (compile): 01:19:46.005508 => 01:19:46.093747
[0m01:19:46.097687 [debug] [Thread-1 (]: Began executing node model.credit.dim_loanstatus
[0m01:19:46.106174 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:19:46.565861 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_loanstatus"
[0m01:19:46.587324 [debug] [Thread-1 (]: On model.credit.dim_loanstatus: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_loanstatus"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`dim_loanstatus`
      
    
    

    OPTIONS()
    as (
      


SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast("Loan Status" as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Term as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as LoanStatusID,
	     
         Term

FROM credit.raw_invoices
    );
  
[0m01:19:47.057290 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:8274a12b-a821-4d2f-8cd9-109c41ef45d5&page=queryresults
[0m01:19:49.551562 [debug] [Thread-1 (]: Timing info for model.credit.dim_loanstatus (execute): 01:19:46.099109 => 01:19:49.550976
[0m01:19:49.554245 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04a230d2-8205-4a6b-bf95-8488dfe157a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ba60f230>]}
[0m01:19:49.556631 [info ] [Thread-1 (]: 2 of 4 OK created sql table model credit.dim_loanstatus ........................ [[32mCREATE TABLE (2.0 rows, 1.1 MiB processed)[0m in 3.55s]
[0m01:19:49.560078 [debug] [Thread-1 (]: Finished running node model.credit.dim_loanstatus
[0m01:19:49.562707 [debug] [Thread-1 (]: Began running node model.credit.dim_purpose
[0m01:19:49.564649 [info ] [Thread-1 (]: 3 of 4 START sql table model credit.dim_purpose ................................ [RUN]
[0m01:19:49.567967 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_loanstatus, now model.credit.dim_purpose)
[0m01:19:49.569701 [debug] [Thread-1 (]: Began compiling node model.credit.dim_purpose
[0m01:19:49.588914 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_purpose"
[0m01:19:49.612299 [debug] [Thread-1 (]: Timing info for model.credit.dim_purpose (compile): 01:19:49.571801 => 01:19:49.611381
[0m01:19:49.614281 [debug] [Thread-1 (]: Began executing node model.credit.dim_purpose
[0m01:19:49.623182 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:19:50.044753 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_purpose"
[0m01:19:50.058759 [debug] [Thread-1 (]: On model.credit.dim_purpose: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_purpose"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`dim_purpose`
      
    
    

    OPTIONS()
    as (
      

SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast(Purpose as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as PurposeID,
		'Purpose' AS Purpose 
FROM `airflowcrtn`.`credit`.`raw_invoices`
WHERE Purpose  IS NOT NULL
    );
  
[0m01:19:50.566650 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:de9d5bf1-3ba5-4116-b570-026702779f1b&page=queryresults
[0m01:19:52.425416 [debug] [Thread-1 (]: Timing info for model.credit.dim_purpose (execute): 01:19:49.615821 => 01:19:52.424825
[0m01:19:52.428327 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04a230d2-8205-4a6b-bf95-8488dfe157a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ba60f230>]}
[0m01:19:52.430513 [info ] [Thread-1 (]: 3 of 4 OK created sql table model credit.dim_purpose ........................... [[32mCREATE TABLE (16.0 rows, 1.7 MiB processed)[0m in 2.86s]
[0m01:19:52.434550 [debug] [Thread-1 (]: Finished running node model.credit.dim_purpose
[0m01:19:52.438280 [debug] [Thread-1 (]: Began running node model.credit.fact_invoices
[0m01:19:52.440755 [info ] [Thread-1 (]: 4 of 4 START sql table model credit.fact_invoices .............................. [RUN]
[0m01:19:52.444840 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_purpose, now model.credit.fact_invoices)
[0m01:19:52.447048 [debug] [Thread-1 (]: Began compiling node model.credit.fact_invoices
[0m01:19:52.472944 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.fact_invoices"
[0m01:19:52.496138 [debug] [Thread-1 (]: Timing info for model.credit.fact_invoices (compile): 01:19:52.448795 => 01:19:52.494927
[0m01:19:52.498104 [debug] [Thread-1 (]: Began executing node model.credit.fact_invoices
[0m01:19:52.506294 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:19:52.938663 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.fact_invoices"
[0m01:19:52.959025 [debug] [Thread-1 (]: On model.credit.fact_invoices: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.fact_invoices"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`fact_invoices`
      
    
    

    OPTIONS()
    as (
      


WITH fct_invoices_cte AS (
    SELECT DISTINCT
        "Loan ID" AS LoanID,
        "Customer ID" AS CustomerID,
        to_hex(md5(cast(coalesce(cast("Loan Status" as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Term as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as LoanStatusID,
        to_hex(md5(cast(coalesce(cast(Purpose as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as PurposeID,
        "Current Loan Amount" AS CurrentLoanAmount,
        "Credit Score" AS CreditScore,
        "Annual Income" AS AnnualIncome,
        "Monthly Debt" AS MonthlyDebt,
        "Years of Credit History" AS YearsofCreditHistory,
        "Months since last delinquent" AS Monthssincelastdelinquent,
        "Number of Open Accounts" AS NumberofOpenAccounts,
        "Number of Credit Problems" AS NumberofCreditProblems,
        "Current Credit Balance" AS CurrentCreditBalance,
        "Maximum Open Credit" AS MaximumOpenCredit,
        "Bankruptcies" AS Bankruptcies,
        "Tax Liens" AS TaxLiens       
      
    FROM `airflowcrtn`.`credit`.`raw_invoices`
    
)
SELECT
   fi.*
FROM fct_invoices_cte fi
INNER JOIN `airflowcrtn`.`credit`.`dim_purpose` dt ON fi.PurposeID = dt.PurposeID
INNER JOIN `airflowcrtn`.`credit`.`dim_loanstatus` dp ON fi.LoanStatusID = dp.LoanStatusID
INNER JOIN `airflowcrtn`.`credit`.`dim_customer` dc ON fi.CustomerID = dc.CustomerID
    );
  
[0m01:19:53.539611 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:1624c6d1-b919-4536-81e0-8aeb569ae05c&page=queryresults
[0m01:19:57.410022 [debug] [Thread-1 (]: Timing info for model.credit.fact_invoices (execute): 01:19:52.499608 => 01:19:57.409263
[0m01:19:57.413950 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04a230d2-8205-4a6b-bf95-8488dfe157a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50b8293020>]}
[0m01:19:57.416567 [info ] [Thread-1 (]: 4 of 4 OK created sql table model credit.fact_invoices ......................... [[32mCREATE TABLE (3.2m rows, 4.1 MiB processed)[0m in 4.97s]
[0m01:19:57.420028 [debug] [Thread-1 (]: Finished running node model.credit.fact_invoices
[0m01:19:57.427671 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:19:57.429306 [debug] [MainThread]: Connection 'model.credit.fact_invoices' was properly closed.
[0m01:19:57.431327 [info ] [MainThread]: 
[0m01:19:57.433742 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 15.83 seconds (15.83s).
[0m01:19:57.439751 [debug] [MainThread]: Command end result
[0m01:19:57.506557 [info ] [MainThread]: 
[0m01:19:57.509259 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:19:57.511492 [info ] [MainThread]: 
[0m01:19:57.513510 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m01:19:57.516133 [debug] [MainThread]: Command `dbt run` succeeded at 01:19:57.515706 after 21.50 seconds
[0m01:19:57.517867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50bc804d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ba6de000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50bc4cf440>]}
[0m01:19:57.519830 [debug] [MainThread]: Flushing usage events
[0m01:27:01.464687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc803e2600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc80849c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc808ac830>]}


============================== 01:27:01.469940 | b88f1fef-8855-430e-a474-b587d36273f1 ==============================
[0m01:27:01.469940 [info ] [MainThread]: Running with dbt=1.6.18
[0m01:27:01.472080 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': '/usr/local/airflow/include/dbt/logs', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'log_cache_events': 'False', 'introspect': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'printer_width': '80', 'target_path': 'None', 'debug': 'False', 'quiet': 'False', 'use_colors': 'True', 'static_parser': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'no_print': 'None', 'version_check': 'True'}
[0m01:27:02.540524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b88f1fef-8855-430e-a474-b587d36273f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc7e4c1d60>]}
[0m01:27:02.594433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b88f1fef-8855-430e-a474-b587d36273f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc7e5373b0>]}
[0m01:27:02.597265 [info ] [MainThread]: Registered adapter: bigquery=1.6.0
[0m01:27:02.688004 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m01:27:04.632938 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:27:04.635088 [debug] [MainThread]: Partial parsing: updated file: credit://models/transform/dim_loanstatus.sql
[0m01:27:04.858703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b88f1fef-8855-430e-a474-b587d36273f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc7e34aa80>]}
[0m01:27:04.925064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b88f1fef-8855-430e-a474-b587d36273f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc7e395730>]}
[0m01:27:04.927251 [info ] [MainThread]: Found 4 models, 1 source, 0 exposures, 0 metrics, 509 macros, 0 groups, 0 semantic models
[0m01:27:04.928924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b88f1fef-8855-430e-a474-b587d36273f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc7e395310>]}
[0m01:27:04.935235 [info ] [MainThread]: 
[0m01:27:04.939360 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:27:04.943398 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflowcrtn'
[0m01:27:04.944819 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:27:05.473099 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflowcrtn, now list_airflowcrtn_credit)
[0m01:27:05.475189 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:27:05.890486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b88f1fef-8855-430e-a474-b587d36273f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc7f0e73b0>]}
[0m01:27:05.893897 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:27:05.895760 [info ] [MainThread]: 
[0m01:27:05.905956 [debug] [Thread-1 (]: Began running node model.credit.dim_customer
[0m01:27:05.908502 [info ] [Thread-1 (]: 1 of 4 START sql table model credit.dim_customer ............................... [RUN]
[0m01:27:05.911962 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflowcrtn_credit, now model.credit.dim_customer)
[0m01:27:05.914130 [debug] [Thread-1 (]: Began compiling node model.credit.dim_customer
[0m01:27:05.945788 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_customer"
[0m01:27:05.971470 [debug] [Thread-1 (]: Timing info for model.credit.dim_customer (compile): 01:27:05.915630 => 01:27:05.970452
[0m01:27:05.973658 [debug] [Thread-1 (]: Began executing node model.credit.dim_customer
[0m01:27:06.021269 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:27:06.574577 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_customer"
[0m01:27:06.592015 [debug] [Thread-1 (]: On model.credit.dim_customer: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_customer"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`dim_customer`
      
    
    

    OPTIONS()
    as (
      

SELECT 
	    "Customer ID" as CustomerID,
	    "Years in Current Job" as YearsinCurrentJob,
         "Home Ownership" as HomeOwnership 
FROM  credit.raw_invoices
    );
  
[0m01:27:06.637876 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:4ba6c3e8-99ad-4147-a9e5-e3dc94db6ee2&page=queryresults
[0m01:27:09.428724 [debug] [Thread-1 (]: Timing info for model.credit.dim_customer (execute): 01:27:05.975176 => 01:27:09.428017
[0m01:27:09.431586 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b88f1fef-8855-430e-a474-b587d36273f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc7e535d00>]}
[0m01:27:09.433674 [info ] [Thread-1 (]: 1 of 4 OK created sql table model credit.dim_customer .......................... [[32mCREATE TABLE (100.0k rows, 0 processed)[0m in 3.52s]
[0m01:27:09.437862 [debug] [Thread-1 (]: Finished running node model.credit.dim_customer
[0m01:27:09.440209 [debug] [Thread-1 (]: Began running node model.credit.dim_loanstatus
[0m01:27:09.442941 [info ] [Thread-1 (]: 2 of 4 START sql table model credit.dim_loanstatus ............................. [RUN]
[0m01:27:09.445694 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_customer, now model.credit.dim_loanstatus)
[0m01:27:09.447284 [debug] [Thread-1 (]: Began compiling node model.credit.dim_loanstatus
[0m01:27:09.465425 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_loanstatus"
[0m01:27:09.488120 [debug] [Thread-1 (]: Timing info for model.credit.dim_loanstatus (compile): 01:27:09.448697 => 01:27:09.487081
[0m01:27:09.490141 [debug] [Thread-1 (]: Began executing node model.credit.dim_loanstatus
[0m01:27:09.498435 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:27:09.964532 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_loanstatus"
[0m01:27:09.980936 [debug] [Thread-1 (]: On model.credit.dim_loanstatus: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_loanstatus"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`dim_loanstatus`
      
    
    

    OPTIONS()
    as (
      


SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast("Loan Status" as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Term as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as LoanStatusID,
	     Loan_Status,
         Term

FROM credit.raw_invoices
    );
  
[0m01:27:10.506309 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:e268c31b-b728-4a21-929f-8052b018dafd&page=queryresults
[0m01:27:10.720436 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: Loan_Status; Did you mean Loan Status? at [18:14]; reason: invalidQuery, location: query, message: Unrecognized name: Loan_Status; Did you mean Loan Status? at [18:14]')
[0m01:27:11.213977 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:26f6ccd2-5ba4-4d6f-9e22-8cfcfc897e3e&page=queryresults
[0m01:27:11.431589 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:26f6ccd2-5ba4-4d6f-9e22-8cfcfc897e3e&page=queryresults
[0m01:27:11.435565 [debug] [Thread-1 (]: Timing info for model.credit.dim_loanstatus (execute): 01:27:09.491898 => 01:27:11.434544
[0m01:27:11.452083 [debug] [Thread-1 (]: Database Error in model dim_loanstatus (models/transform/dim_loanstatus.sql)
  Unrecognized name: Loan_Status; Did you mean Loan Status? at [18:14]
  compiled Code at target/run/credit/models/transform/dim_loanstatus.sql
[0m01:27:11.456323 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b88f1fef-8855-430e-a474-b587d36273f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc7e521280>]}
[0m01:27:11.458380 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model credit.dim_loanstatus .................... [[31mERROR[0m in 2.01s]
[0m01:27:11.461374 [debug] [Thread-1 (]: Finished running node model.credit.dim_loanstatus
[0m01:27:11.463557 [debug] [Thread-1 (]: Began running node model.credit.dim_purpose
[0m01:27:11.467076 [info ] [Thread-1 (]: 3 of 4 START sql table model credit.dim_purpose ................................ [RUN]
[0m01:27:11.472950 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_loanstatus, now model.credit.dim_purpose)
[0m01:27:11.475167 [debug] [Thread-1 (]: Began compiling node model.credit.dim_purpose
[0m01:27:11.493087 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_purpose"
[0m01:27:11.513953 [debug] [Thread-1 (]: Timing info for model.credit.dim_purpose (compile): 01:27:11.477187 => 01:27:11.512705
[0m01:27:11.516220 [debug] [Thread-1 (]: Began executing node model.credit.dim_purpose
[0m01:27:11.525629 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:27:11.969303 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_purpose"
[0m01:27:11.984359 [debug] [Thread-1 (]: On model.credit.dim_purpose: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_purpose"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`dim_purpose`
      
    
    

    OPTIONS()
    as (
      

SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast(Purpose as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as PurposeID,
		'Purpose' AS Purpose 
FROM `airflowcrtn`.`credit`.`raw_invoices`
WHERE Purpose  IS NOT NULL
    );
  
[0m01:27:12.594091 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:e11fa561-d465-4e9a-a0fe-0813ae01a83c&page=queryresults
[0m01:27:15.516886 [debug] [Thread-1 (]: Timing info for model.credit.dim_purpose (execute): 01:27:11.517836 => 01:27:15.516266
[0m01:27:15.520444 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b88f1fef-8855-430e-a474-b587d36273f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc7e433cb0>]}
[0m01:27:15.522820 [info ] [Thread-1 (]: 3 of 4 OK created sql table model credit.dim_purpose ........................... [[32mCREATE TABLE (16.0 rows, 1.7 MiB processed)[0m in 4.05s]
[0m01:27:15.525462 [debug] [Thread-1 (]: Finished running node model.credit.dim_purpose
[0m01:27:15.529619 [debug] [Thread-1 (]: Began running node model.credit.fact_invoices
[0m01:27:15.531281 [info ] [Thread-1 (]: 4 of 4 SKIP relation credit.fact_invoices ...................................... [[33mSKIP[0m]
[0m01:27:15.533070 [debug] [Thread-1 (]: Finished running node model.credit.fact_invoices
[0m01:27:15.539605 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:27:15.541229 [debug] [MainThread]: Connection 'model.credit.dim_purpose' was properly closed.
[0m01:27:15.542902 [info ] [MainThread]: 
[0m01:27:15.545457 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 10.60 seconds (10.60s).
[0m01:27:15.552149 [debug] [MainThread]: Command end result
[0m01:27:15.628665 [info ] [MainThread]: 
[0m01:27:15.632148 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:27:15.634872 [info ] [MainThread]: 
[0m01:27:15.636554 [error] [MainThread]:   Database Error in model dim_loanstatus (models/transform/dim_loanstatus.sql)
  Unrecognized name: Loan_Status; Did you mean Loan Status? at [18:14]
  compiled Code at target/run/credit/models/transform/dim_loanstatus.sql
[0m01:27:15.638221 [info ] [MainThread]: 
[0m01:27:15.640350 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m01:27:15.642868 [debug] [MainThread]: Command `dbt run` failed at 01:27:15.642478 after 15.71 seconds
[0m01:27:15.645371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc808db860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc80e06b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc7e62d1c0>]}
[0m01:27:15.647615 [debug] [MainThread]: Flushing usage events
[0m01:32:04.782414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f703fb94d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f703fb948f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f703fb96ea0>]}


============================== 01:32:04.787711 | 739491f4-461b-4ba6-9b85-9e59347a5dd5 ==============================
[0m01:32:04.787711 [info ] [MainThread]: Running with dbt=1.6.18
[0m01:32:04.789945 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/usr/local/airflow/include/dbt/', 'quiet': 'False', 'introspect': 'True', 'version_check': 'True', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'printer_width': '80', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'warn_error': 'None', 'write_json': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'no_print': 'None', 'cache_selected_only': 'False'}
[0m01:32:06.159916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '739491f4-461b-4ba6-9b85-9e59347a5dd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f703de9fe60>]}
[0m01:32:06.210912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '739491f4-461b-4ba6-9b85-9e59347a5dd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f703dcd0d40>]}
[0m01:32:06.213409 [info ] [MainThread]: Registered adapter: bigquery=1.6.0
[0m01:32:06.310237 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m01:32:08.159160 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m01:32:08.161539 [debug] [MainThread]: Partial parsing: updated file: credit://models/transform/dim_customer.sql
[0m01:32:08.163584 [debug] [MainThread]: Partial parsing: updated file: credit://models/transform/dim_loanstatus.sql
[0m01:32:08.388471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '739491f4-461b-4ba6-9b85-9e59347a5dd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f703dd100b0>]}
[0m01:32:08.463959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '739491f4-461b-4ba6-9b85-9e59347a5dd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f703db54aa0>]}
[0m01:32:08.466117 [info ] [MainThread]: Found 4 models, 1 source, 0 exposures, 0 metrics, 509 macros, 0 groups, 0 semantic models
[0m01:32:08.467802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '739491f4-461b-4ba6-9b85-9e59347a5dd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f703db546e0>]}
[0m01:32:08.473402 [info ] [MainThread]: 
[0m01:32:08.477392 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:32:08.482678 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflowcrtn'
[0m01:32:08.484935 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:32:09.024751 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflowcrtn, now list_airflowcrtn_credit)
[0m01:32:09.026753 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:32:09.479801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '739491f4-461b-4ba6-9b85-9e59347a5dd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f703db566f0>]}
[0m01:32:09.483312 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:32:09.485068 [info ] [MainThread]: 
[0m01:32:09.494445 [debug] [Thread-1 (]: Began running node model.credit.dim_customer
[0m01:32:09.497262 [info ] [Thread-1 (]: 1 of 4 START sql table model credit.dim_customer ............................... [RUN]
[0m01:32:09.500587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflowcrtn_credit, now model.credit.dim_customer)
[0m01:32:09.502521 [debug] [Thread-1 (]: Began compiling node model.credit.dim_customer
[0m01:32:09.538056 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_customer"
[0m01:32:09.563448 [debug] [Thread-1 (]: Timing info for model.credit.dim_customer (compile): 01:32:09.504149 => 01:32:09.562470
[0m01:32:09.565567 [debug] [Thread-1 (]: Began executing node model.credit.dim_customer
[0m01:32:09.608207 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:32:10.122090 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_customer"
[0m01:32:10.144519 [debug] [Thread-1 (]: On model.credit.dim_customer: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_customer"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`dim_customer`
      
    
    

    OPTIONS()
    as (
      

SELECT
    "Customer ID" AS customer_id,
    "Years in Current Job" AS years_in_current_job,
    "Home Ownership" AS home_ownership
FROM `airflowcrtn`.`credit`.`raw_invoices`  -- Replace with your actual source
WHERE "Customer ID" IS NOT NULL
    );
  
[0m01:32:10.594779 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:202e61ad-aea4-48f0-90ec-57720cbbd675&page=queryresults
[0m01:32:12.891842 [debug] [Thread-1 (]: Timing info for model.credit.dim_customer (execute): 01:32:09.567161 => 01:32:12.891240
[0m01:32:12.894766 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '739491f4-461b-4ba6-9b85-9e59347a5dd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f703db56870>]}
[0m01:32:12.896920 [info ] [Thread-1 (]: 1 of 4 OK created sql table model credit.dim_customer .......................... [[32mCREATE TABLE (100.0k rows, 0 processed)[0m in 3.40s]
[0m01:32:12.900246 [debug] [Thread-1 (]: Finished running node model.credit.dim_customer
[0m01:32:12.902924 [debug] [Thread-1 (]: Began running node model.credit.dim_loanstatus
[0m01:32:12.905165 [info ] [Thread-1 (]: 2 of 4 START sql table model credit.dim_loanstatus ............................. [RUN]
[0m01:32:12.910751 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_customer, now model.credit.dim_loanstatus)
[0m01:32:12.913274 [debug] [Thread-1 (]: Began compiling node model.credit.dim_loanstatus
[0m01:32:12.932468 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_loanstatus"
[0m01:32:12.952949 [debug] [Thread-1 (]: Timing info for model.credit.dim_loanstatus (compile): 01:32:12.914989 => 01:32:12.952001
[0m01:32:12.955003 [debug] [Thread-1 (]: Began executing node model.credit.dim_loanstatus
[0m01:32:12.963625 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:32:13.400469 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_loanstatus"
[0m01:32:13.419604 [debug] [Thread-1 (]: On model.credit.dim_loanstatus: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_loanstatus"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`dim_loanstatus`
      
    
    

    OPTIONS()
    as (
      


SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast("Loan Status" as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Term as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as LoanStatusID,
	     "Loan Status" as LoanStatus,
         Term

FROM credit.raw_invoices
    );
  
[0m01:32:13.940415 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:0f77ea0a-537c-4d63-a165-0efbb6dc089b&page=queryresults
[0m01:32:16.644879 [debug] [Thread-1 (]: Timing info for model.credit.dim_loanstatus (execute): 01:32:12.956349 => 01:32:16.644070
[0m01:32:16.648094 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '739491f4-461b-4ba6-9b85-9e59347a5dd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f703db57050>]}
[0m01:32:16.650077 [info ] [Thread-1 (]: 2 of 4 OK created sql table model credit.dim_loanstatus ........................ [[32mCREATE TABLE (2.0 rows, 1.1 MiB processed)[0m in 3.74s]
[0m01:32:16.654036 [debug] [Thread-1 (]: Finished running node model.credit.dim_loanstatus
[0m01:32:16.656189 [debug] [Thread-1 (]: Began running node model.credit.dim_purpose
[0m01:32:16.657922 [info ] [Thread-1 (]: 3 of 4 START sql table model credit.dim_purpose ................................ [RUN]
[0m01:32:16.660932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_loanstatus, now model.credit.dim_purpose)
[0m01:32:16.663005 [debug] [Thread-1 (]: Began compiling node model.credit.dim_purpose
[0m01:32:16.678824 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_purpose"
[0m01:32:16.701807 [debug] [Thread-1 (]: Timing info for model.credit.dim_purpose (compile): 01:32:16.664582 => 01:32:16.700602
[0m01:32:16.704695 [debug] [Thread-1 (]: Began executing node model.credit.dim_purpose
[0m01:32:16.712449 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:32:26.191917 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_purpose"
[0m01:32:16.673520 [debug] [Thread-1 (]: On model.credit.dim_purpose: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_purpose"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`dim_purpose`
      
    
    

    OPTIONS()
    as (
      

SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast(Purpose as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as PurposeID,
		'Purpose' AS Purpose 
FROM `airflowcrtn`.`credit`.`raw_invoices`
WHERE Purpose  IS NOT NULL
    );
  
[0m01:32:17.263420 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:465e0153-a8c2-4783-8741-025871fe1f79&page=queryresults
[0m01:32:19.943962 [debug] [Thread-1 (]: Timing info for model.credit.dim_purpose (execute): 01:32:16.706258 => 01:32:19.943280
[0m01:32:19.947219 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '739491f4-461b-4ba6-9b85-9e59347a5dd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f703db542c0>]}
[0m01:32:19.949967 [info ] [Thread-1 (]: 3 of 4 OK created sql table model credit.dim_purpose ........................... [[32mCREATE TABLE (16.0 rows, 1.7 MiB processed)[0m in 3.29s]
[0m01:32:19.953068 [debug] [Thread-1 (]: Finished running node model.credit.dim_purpose
[0m01:32:19.957284 [debug] [Thread-1 (]: Began running node model.credit.fact_invoices
[0m01:32:19.959343 [info ] [Thread-1 (]: 4 of 4 START sql table model credit.fact_invoices .............................. [RUN]
[0m01:32:19.962264 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_purpose, now model.credit.fact_invoices)
[0m01:32:19.964183 [debug] [Thread-1 (]: Began compiling node model.credit.fact_invoices
[0m01:32:19.990406 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.fact_invoices"
[0m01:32:20.016337 [debug] [Thread-1 (]: Timing info for model.credit.fact_invoices (compile): 01:32:19.965678 => 01:32:20.015325
[0m01:32:20.018296 [debug] [Thread-1 (]: Began executing node model.credit.fact_invoices
[0m01:32:20.026215 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:32:20.492027 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.fact_invoices"
[0m01:32:20.508498 [debug] [Thread-1 (]: On model.credit.fact_invoices: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.fact_invoices"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`fact_invoices`
      
    
    

    OPTIONS()
    as (
      


WITH fct_invoices_cte AS (
    SELECT DISTINCT
        "Loan ID" AS LoanID,
        "Customer ID" AS CustomerID,
        to_hex(md5(cast(coalesce(cast("Loan Status" as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Term as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as LoanStatusID,
        to_hex(md5(cast(coalesce(cast(Purpose as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as PurposeID,
        "Current Loan Amount" AS CurrentLoanAmount,
        "Credit Score" AS CreditScore,
        "Annual Income" AS AnnualIncome,
        "Monthly Debt" AS MonthlyDebt,
        "Years of Credit History" AS YearsofCreditHistory,
        "Months since last delinquent" AS Monthssincelastdelinquent,
        "Number of Open Accounts" AS NumberofOpenAccounts,
        "Number of Credit Problems" AS NumberofCreditProblems,
        "Current Credit Balance" AS CurrentCreditBalance,
        "Maximum Open Credit" AS MaximumOpenCredit,
        "Bankruptcies" AS Bankruptcies,
        "Tax Liens" AS TaxLiens       
      
    FROM `airflowcrtn`.`credit`.`raw_invoices`
    
)
SELECT
   fi.*
FROM fct_invoices_cte fi
INNER JOIN `airflowcrtn`.`credit`.`dim_purpose` dt ON fi.PurposeID = dt.PurposeID
INNER JOIN `airflowcrtn`.`credit`.`dim_loanstatus` dp ON fi.LoanStatusID = dp.LoanStatusID
INNER JOIN `airflowcrtn`.`credit`.`dim_customer` dc ON fi.CustomerID = dc.CustomerID
    );
  
[0m01:32:20.969777 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:3fb823e5-90ae-4ca4-94b5-233d403cc3d8&page=queryresults
[0m01:32:21.167484 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name CustomerID not found inside dc at [43:75]; reason: invalidQuery, location: query, message: Name CustomerID not found inside dc at [43:75]')
[0m01:32:21.713788 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:c85d3fd3-12f7-4156-b52b-823ac938f29f&page=queryresults
[0m01:32:21.911118 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:c85d3fd3-12f7-4156-b52b-823ac938f29f&page=queryresults
[0m01:32:21.914344 [debug] [Thread-1 (]: Timing info for model.credit.fact_invoices (execute): 01:32:20.019785 => 01:32:21.913407
[0m01:32:21.931099 [debug] [Thread-1 (]: Database Error in model fact_invoices (models/transform/fact_invoices.sql)
  Name CustomerID not found inside dc at [43:75]
  compiled Code at target/run/credit/models/transform/fact_invoices.sql
[0m01:32:21.933058 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '739491f4-461b-4ba6-9b85-9e59347a5dd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f703c174800>]}
[0m01:32:21.935501 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model credit.fact_invoices ..................... [[31mERROR[0m in 1.97s]
[0m01:32:21.938501 [debug] [Thread-1 (]: Finished running node model.credit.fact_invoices
[0m01:32:21.948430 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:32:21.950916 [debug] [MainThread]: Connection 'model.credit.fact_invoices' was properly closed.
[0m01:32:21.953141 [info ] [MainThread]: 
[0m01:32:21.955042 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 13.48 seconds (13.48s).
[0m01:32:21.964491 [debug] [MainThread]: Command end result
[0m01:32:22.026677 [info ] [MainThread]: 
[0m01:32:22.028987 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:32:22.030847 [info ] [MainThread]: 
[0m01:32:22.032678 [error] [MainThread]:   Database Error in model fact_invoices (models/transform/fact_invoices.sql)
  Name CustomerID not found inside dc at [43:75]
  compiled Code at target/run/credit/models/transform/fact_invoices.sql
[0m01:32:22.034344 [info ] [MainThread]: 
[0m01:32:22.036235 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m01:32:22.039900 [debug] [MainThread]: Command `dbt run` failed at 01:32:22.039283 after 19.33 seconds
[0m01:32:22.042198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f703fb95040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f703dec4620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f703c183ad0>]}
[0m01:32:22.044025 [debug] [MainThread]: Flushing usage events
[0m11:55:48.600567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b284e7860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b2cfdb320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b28818ad0>]}


============================== 11:55:48.603773 | 98785522-15a0-4ef8-ae3a-49ef31b2fb97 ==============================
[0m11:55:48.603773 [info ] [MainThread]: Running with dbt=1.6.18
[0m11:55:48.604691 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'partial_parse': 'True', 'write_json': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'debug': 'False', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'target_path': 'None', 'no_print': 'None', 'printer_width': '80', 'log_format': 'default', 'fail_fast': 'False', 'cache_selected_only': 'False', 'introspect': 'True'}
[0m11:55:49.222791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '98785522-15a0-4ef8-ae3a-49ef31b2fb97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b274ee9f0>]}
[0m11:55:49.239726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '98785522-15a0-4ef8-ae3a-49ef31b2fb97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b266bfdd0>]}
[0m11:55:49.240720 [info ] [MainThread]: Registered adapter: bigquery=1.6.0
[0m11:55:49.269894 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m11:55:49.864859 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:55:49.866120 [debug] [MainThread]: Partial parsing: updated file: credit://models/transform/dim_customer.sql
[0m11:55:49.914520 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.credit.dim_customer' (models/transform/dim_customer.sql) depends on a node named 'raw_invoices' which was not found
[0m11:55:49.915821 [debug] [MainThread]: Command `dbt run` failed at 11:55:49.915625 after 1.33 seconds
[0m11:55:49.916557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b28f47860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b264602f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b264600b0>]}
[0m11:55:49.917148 [debug] [MainThread]: Flushing usage events
[0m12:02:49.359712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80b3be2150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80b3f17320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80b4049c70>]}


============================== 12:02:49.361936 | 91d6807a-a764-4c67-9487-0ac2d3c43a0f ==============================
[0m12:02:49.361936 [info ] [MainThread]: Running with dbt=1.6.18
[0m12:02:49.362821 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'version_check': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'use_colors': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'log_format': 'default', 'quiet': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'write_json': 'True', 'no_print': 'None', 'partial_parse': 'True', 'warn_error': 'None', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True'}
[0m12:02:49.983072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91d6807a-a764-4c67-9487-0ac2d3c43a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80b1d54290>]}
[0m12:02:50.001419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '91d6807a-a764-4c67-9487-0ac2d3c43a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80b1d1e0f0>]}
[0m12:02:50.002621 [info ] [MainThread]: Registered adapter: bigquery=1.6.0
[0m12:02:50.032729 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m12:02:50.594430 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:02:50.595500 [debug] [MainThread]: Partial parsing: updated file: credit://models/transform/dim_customer.sql
[0m12:02:50.660127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91d6807a-a764-4c67-9487-0ac2d3c43a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80b1d1d490>]}
[0m12:02:50.680291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91d6807a-a764-4c67-9487-0ac2d3c43a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80b1ba0c20>]}
[0m12:02:50.681004 [info ] [MainThread]: Found 4 models, 1 source, 0 exposures, 0 metrics, 509 macros, 0 groups, 0 semantic models
[0m12:02:50.681649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91d6807a-a764-4c67-9487-0ac2d3c43a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80b1c53500>]}
[0m12:02:50.684102 [info ] [MainThread]: 
[0m12:02:50.685334 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:02:50.687200 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflowcrtn'
[0m12:02:50.687783 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:02:51.335375 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflowcrtn, now list_airflowcrtn_credit)
[0m12:02:51.336470 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:02:51.709010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91d6807a-a764-4c67-9487-0ac2d3c43a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80b1eb9760>]}
[0m12:02:51.710388 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:02:51.711173 [info ] [MainThread]: 
[0m12:02:51.715066 [debug] [Thread-1 (]: Began running node model.credit.dim_customer
[0m12:02:51.715963 [info ] [Thread-1 (]: 1 of 4 START sql table model credit.dim_customer ............................... [RUN]
[0m12:02:51.717177 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflowcrtn_credit, now model.credit.dim_customer)
[0m12:02:51.717896 [debug] [Thread-1 (]: Began compiling node model.credit.dim_customer
[0m12:02:51.727013 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_customer"
[0m12:02:51.732558 [debug] [Thread-1 (]: Timing info for model.credit.dim_customer (compile): 12:02:51.718440 => 12:02:51.732225
[0m12:02:51.733200 [debug] [Thread-1 (]: Began executing node model.credit.dim_customer
[0m12:02:51.749648 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:02:52.189390 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_customer"
[0m12:02:52.194156 [debug] [Thread-1 (]: On model.credit.dim_customer: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_customer"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`dim_customer`
      
    
    

    OPTIONS()
    as (
      

SELECT distinct
    "Customer ID" AS customer_id,
    "Years in Current Job" AS years_in_current_job,
    "Home Ownership" AS home_ownership
FROM airflowcrtn.credit.raw_invoices--- Replace with your actual source
WHERE "Customer ID" IS NOT NULL
    );
  
[0m12:02:52.811594 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:3fccaa49-69bc-4b4d-a46a-1cdda5118e1a&page=queryresults
[0m12:02:55.387047 [debug] [Thread-1 (]: Timing info for model.credit.dim_customer (execute): 12:02:51.733655 => 12:02:55.386752
[0m12:02:55.388312 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91d6807a-a764-4c67-9487-0ac2d3c43a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80b1b0c3b0>]}
[0m12:02:55.389254 [info ] [Thread-1 (]: 1 of 4 OK created sql table model credit.dim_customer .......................... [[32mCREATE TABLE (1.0 rows, 0 processed)[0m in 3.67s]
[0m12:02:55.390267 [debug] [Thread-1 (]: Finished running node model.credit.dim_customer
[0m12:02:55.391076 [debug] [Thread-1 (]: Began running node model.credit.dim_loanstatus
[0m12:02:55.391753 [info ] [Thread-1 (]: 2 of 4 START sql table model credit.dim_loanstatus ............................. [RUN]
[0m12:02:55.392804 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_customer, now model.credit.dim_loanstatus)
[0m12:02:55.393400 [debug] [Thread-1 (]: Began compiling node model.credit.dim_loanstatus
[0m12:02:55.412844 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_loanstatus"
[0m12:02:55.420857 [debug] [Thread-1 (]: Timing info for model.credit.dim_loanstatus (compile): 12:02:55.393847 => 12:02:55.420397
[0m12:02:55.421692 [debug] [Thread-1 (]: Began executing node model.credit.dim_loanstatus
[0m12:02:55.424910 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:02:55.805894 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_loanstatus"
[0m12:02:55.812869 [debug] [Thread-1 (]: On model.credit.dim_loanstatus: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_loanstatus"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`dim_loanstatus`
      
    
    

    OPTIONS()
    as (
      


SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast("Loan Status" as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Term as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as LoanStatusID,
	     "Loan Status" as LoanStatus,
         Term

FROM credit.raw_invoices
    );
  
[0m12:02:56.306309 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:4a11eed9-6109-4633-a70e-36772afdb3e3&page=queryresults
[0m12:02:59.087238 [debug] [Thread-1 (]: Timing info for model.credit.dim_loanstatus (execute): 12:02:55.422227 => 12:02:59.086871
[0m12:02:59.088750 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91d6807a-a764-4c67-9487-0ac2d3c43a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80b1b0c260>]}
[0m12:02:59.089719 [info ] [Thread-1 (]: 2 of 4 OK created sql table model credit.dim_loanstatus ........................ [[32mCREATE TABLE (2.0 rows, 1.1 MiB processed)[0m in 3.70s]
[0m12:02:59.090867 [debug] [Thread-1 (]: Finished running node model.credit.dim_loanstatus
[0m12:02:59.091803 [debug] [Thread-1 (]: Began running node model.credit.dim_purpose
[0m12:02:59.092721 [info ] [Thread-1 (]: 3 of 4 START sql table model credit.dim_purpose ................................ [RUN]
[0m12:02:59.094007 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_loanstatus, now model.credit.dim_purpose)
[0m12:02:59.094682 [debug] [Thread-1 (]: Began compiling node model.credit.dim_purpose
[0m12:02:59.100779 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_purpose"
[0m12:02:59.106720 [debug] [Thread-1 (]: Timing info for model.credit.dim_purpose (compile): 12:02:59.095202 => 12:02:59.106228
[0m12:02:59.107476 [debug] [Thread-1 (]: Began executing node model.credit.dim_purpose
[0m12:02:59.110750 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:02:59.343126 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_purpose"
[0m12:02:59.356300 [debug] [Thread-1 (]: On model.credit.dim_purpose: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_purpose"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`dim_purpose`
      
    
    

    OPTIONS()
    as (
      

SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast(Purpose as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as PurposeID,
		'Purpose' AS Purpose 
FROM `airflowcrtn`.`credit`.`raw_invoices`
WHERE Purpose  IS NOT NULL
    );
  
[0m12:02:59.851019 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:6c3704a2-95fd-4822-930a-b878aeeedfe5&page=queryresults
[0m12:03:02.469820 [debug] [Thread-1 (]: Timing info for model.credit.dim_purpose (execute): 12:02:59.107884 => 12:03:02.469467
[0m12:03:02.471190 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91d6807a-a764-4c67-9487-0ac2d3c43a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80b1b0cfb0>]}
[0m12:03:02.472341 [info ] [Thread-1 (]: 3 of 4 OK created sql table model credit.dim_purpose ........................... [[32mCREATE TABLE (16.0 rows, 1.7 MiB processed)[0m in 3.38s]
[0m12:03:02.473472 [debug] [Thread-1 (]: Finished running node model.credit.dim_purpose
[0m12:03:02.475163 [debug] [Thread-1 (]: Began running node model.credit.fact_invoices
[0m12:03:02.475840 [info ] [Thread-1 (]: 4 of 4 START sql table model credit.fact_invoices .............................. [RUN]
[0m12:03:02.476981 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_purpose, now model.credit.fact_invoices)
[0m12:03:02.477677 [debug] [Thread-1 (]: Began compiling node model.credit.fact_invoices
[0m12:03:02.488164 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.fact_invoices"
[0m12:03:02.493754 [debug] [Thread-1 (]: Timing info for model.credit.fact_invoices (compile): 12:03:02.478175 => 12:03:02.493444
[0m12:03:02.494415 [debug] [Thread-1 (]: Began executing node model.credit.fact_invoices
[0m12:03:02.498248 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:03:02.993531 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.fact_invoices"
[0m12:03:02.999934 [debug] [Thread-1 (]: On model.credit.fact_invoices: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.fact_invoices"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`fact_invoices`
      
    
    

    OPTIONS()
    as (
      


WITH fct_invoices_cte AS (
    SELECT DISTINCT
        "Loan ID" AS LoanID,
        "Customer ID" AS CustomerID,
        to_hex(md5(cast(coalesce(cast("Loan Status" as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Term as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as LoanStatusID,
        to_hex(md5(cast(coalesce(cast(Purpose as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as PurposeID,
        "Current Loan Amount" AS CurrentLoanAmount,
        "Credit Score" AS CreditScore,
        "Annual Income" AS AnnualIncome,
        "Monthly Debt" AS MonthlyDebt,
        "Years of Credit History" AS YearsofCreditHistory,
        "Months since last delinquent" AS Monthssincelastdelinquent,
        "Number of Open Accounts" AS NumberofOpenAccounts,
        "Number of Credit Problems" AS NumberofCreditProblems,
        "Current Credit Balance" AS CurrentCreditBalance,
        "Maximum Open Credit" AS MaximumOpenCredit,
        "Bankruptcies" AS Bankruptcies,
        "Tax Liens" AS TaxLiens       
      
    FROM `airflowcrtn`.`credit`.`raw_invoices`
    
)
SELECT
   fi.*
FROM fct_invoices_cte fi
INNER JOIN `airflowcrtn`.`credit`.`dim_purpose` dt ON fi.PurposeID = dt.PurposeID
INNER JOIN `airflowcrtn`.`credit`.`dim_loanstatus` dp ON fi.LoanStatusID = dp.LoanStatusID
INNER JOIN `airflowcrtn`.`credit`.`dim_customer` dc ON fi.CustomerID = dc.CustomerID
    );
  
[0m12:03:03.780770 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:35a677de-4b36-4490-b7c2-03e15a96b488&page=queryresults
[0m12:03:04.028506 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name CustomerID not found inside dc at [43:75]; reason: invalidQuery, location: query, message: Name CustomerID not found inside dc at [43:75]')
[0m12:03:04.808357 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:7e8e0e8d-2f8c-4a34-9abf-84722c2d6bd7&page=queryresults
[0m12:03:05.046090 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:7e8e0e8d-2f8c-4a34-9abf-84722c2d6bd7&page=queryresults
[0m12:03:05.047598 [debug] [Thread-1 (]: Timing info for model.credit.fact_invoices (execute): 12:03:02.494933 => 12:03:05.047254
[0m12:03:05.053786 [debug] [Thread-1 (]: Database Error in model fact_invoices (models/transform/fact_invoices.sql)
  Name CustomerID not found inside dc at [43:75]
  compiled Code at target/run/credit/models/transform/fact_invoices.sql
[0m12:03:05.054666 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91d6807a-a764-4c67-9487-0ac2d3c43a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80b1a4b9b0>]}
[0m12:03:05.055707 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model credit.fact_invoices ..................... [[31mERROR[0m in 2.58s]
[0m12:03:05.057018 [debug] [Thread-1 (]: Finished running node model.credit.fact_invoices
[0m12:03:05.060690 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:03:05.061553 [debug] [MainThread]: Connection 'model.credit.fact_invoices' was properly closed.
[0m12:03:05.062298 [info ] [MainThread]: 
[0m12:03:05.063068 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 14.38 seconds (14.38s).
[0m12:03:05.065859 [debug] [MainThread]: Command end result
[0m12:03:05.092751 [info ] [MainThread]: 
[0m12:03:05.093683 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:03:05.094375 [info ] [MainThread]: 
[0m12:03:05.095094 [error] [MainThread]:   Database Error in model fact_invoices (models/transform/fact_invoices.sql)
  Name CustomerID not found inside dc at [43:75]
  compiled Code at target/run/credit/models/transform/fact_invoices.sql
[0m12:03:05.095709 [info ] [MainThread]: 
[0m12:03:05.096419 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m12:03:05.097634 [debug] [MainThread]: Command `dbt run` failed at 12:03:05.097405 after 17.26 seconds
[0m12:03:05.098642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80b40eaa80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80b407e030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80b1e15d00>]}
[0m12:03:05.099436 [debug] [MainThread]: Flushing usage events
[0m12:03:09.930478 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m12:04:41.103109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f827aace660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f827b466270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f827af984d0>]}


============================== 12:04:41.105199 | d9efc7b3-de6d-40fd-94e1-41eae555517c ==============================
[0m12:04:41.105199 [info ] [MainThread]: Running with dbt=1.6.18
[0m12:04:41.106080 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'use_colors': 'True', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'indirect_selection': 'eager', 'no_print': 'None', 'introspect': 'True', 'partial_parse': 'True', 'quiet': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': '/usr/local/airflow/include/dbt/logs', 'write_json': 'True', 'log_format': 'default', 'printer_width': '80', 'debug': 'False', 'log_cache_events': 'False', 'static_parser': 'True', 'target_path': 'None'}
[0m12:04:41.699678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd9efc7b3-de6d-40fd-94e1-41eae555517c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8278c7ef60>]}
[0m12:04:41.718712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd9efc7b3-de6d-40fd-94e1-41eae555517c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8278c1e7e0>]}
[0m12:04:41.720057 [info ] [MainThread]: Registered adapter: bigquery=1.6.0
[0m12:04:41.752562 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m12:04:42.308373 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:04:42.309269 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:04:42.317637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd9efc7b3-de6d-40fd-94e1-41eae555517c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8278c1ebd0>]}
[0m12:04:42.338025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd9efc7b3-de6d-40fd-94e1-41eae555517c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8278a81700>]}
[0m12:04:42.338711 [info ] [MainThread]: Found 4 models, 1 source, 0 exposures, 0 metrics, 509 macros, 0 groups, 0 semantic models
[0m12:04:42.339310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9efc7b3-de6d-40fd-94e1-41eae555517c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8278ddc680>]}
[0m12:04:42.341594 [info ] [MainThread]: 
[0m12:04:42.342936 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:04:42.344637 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflowcrtn'
[0m12:04:42.345193 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:04:42.784258 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflowcrtn, now list_airflowcrtn_credit)
[0m12:04:42.785214 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:04:43.142590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9efc7b3-de6d-40fd-94e1-41eae555517c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82795da540>]}
[0m12:04:43.143981 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:04:43.144635 [info ] [MainThread]: 
[0m12:04:43.149081 [debug] [Thread-1 (]: Began running node model.credit.dim_customer
[0m12:04:43.150063 [info ] [Thread-1 (]: 1 of 4 START sql table model credit.dim_customer ............................... [RUN]
[0m12:04:43.151466 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflowcrtn_credit, now model.credit.dim_customer)
[0m12:04:43.152179 [debug] [Thread-1 (]: Began compiling node model.credit.dim_customer
[0m12:04:43.162367 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_customer"
[0m12:04:43.168211 [debug] [Thread-1 (]: Timing info for model.credit.dim_customer (compile): 12:04:43.152825 => 12:04:43.167917
[0m12:04:43.168863 [debug] [Thread-1 (]: Began executing node model.credit.dim_customer
[0m12:04:43.188780 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:04:43.634911 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_customer"
[0m12:04:43.640361 [debug] [Thread-1 (]: On model.credit.dim_customer: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_customer"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`dim_customer`
      
    
    

    OPTIONS()
    as (
      

SELECT distinct
    "Customer ID" AS customer_id,
    "Years in Current Job" AS years_in_current_job,
    "Home Ownership" AS home_ownership
FROM airflowcrtn.credit.raw_invoices--- Replace with your actual source
WHERE "Customer ID" IS NOT NULL
    );
  
[0m12:04:44.225575 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:8ff8821b-97ef-4d6f-8a31-e7f65f6eed71&page=queryresults
[0m12:04:46.216894 [debug] [Thread-1 (]: Timing info for model.credit.dim_customer (execute): 12:04:43.169301 => 12:04:46.216628
[0m12:04:46.218337 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9efc7b3-de6d-40fd-94e1-41eae555517c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8278abe9f0>]}
[0m12:04:46.219477 [info ] [Thread-1 (]: 1 of 4 OK created sql table model credit.dim_customer .......................... [[32mCREATE TABLE (1.0 rows, 0 processed)[0m in 3.07s]
[0m12:04:46.220721 [debug] [Thread-1 (]: Finished running node model.credit.dim_customer
[0m12:04:46.221678 [debug] [Thread-1 (]: Began running node model.credit.dim_loanstatus
[0m12:04:46.222391 [info ] [Thread-1 (]: 2 of 4 START sql table model credit.dim_loanstatus ............................. [RUN]
[0m12:04:46.223369 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_customer, now model.credit.dim_loanstatus)
[0m12:04:46.223996 [debug] [Thread-1 (]: Began compiling node model.credit.dim_loanstatus
[0m12:04:46.242543 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_loanstatus"
[0m12:04:46.249241 [debug] [Thread-1 (]: Timing info for model.credit.dim_loanstatus (compile): 12:04:46.224415 => 12:04:46.248835
[0m12:04:46.249919 [debug] [Thread-1 (]: Began executing node model.credit.dim_loanstatus
[0m12:04:46.252887 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:04:46.717669 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_loanstatus"
[0m12:04:46.724637 [debug] [Thread-1 (]: On model.credit.dim_loanstatus: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_loanstatus"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`dim_loanstatus`
      
    
    

    OPTIONS()
    as (
      


SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast("Loan Status" as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Term as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as LoanStatusID,
	     "Loan Status" as LoanStatus,
         Term

FROM credit.raw_invoices
    );
  
[0m12:04:47.322051 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:a20e38f1-6e36-438f-ae72-107e25ba914b&page=queryresults
[0m12:04:49.323347 [debug] [Thread-1 (]: Timing info for model.credit.dim_loanstatus (execute): 12:04:46.250324 => 12:04:49.323043
[0m12:04:49.324722 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9efc7b3-de6d-40fd-94e1-41eae555517c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8278abdcd0>]}
[0m12:04:49.325827 [info ] [Thread-1 (]: 2 of 4 OK created sql table model credit.dim_loanstatus ........................ [[32mCREATE TABLE (2.0 rows, 1.1 MiB processed)[0m in 3.10s]
[0m12:04:49.327231 [debug] [Thread-1 (]: Finished running node model.credit.dim_loanstatus
[0m12:04:49.328139 [debug] [Thread-1 (]: Began running node model.credit.dim_purpose
[0m12:04:49.328921 [info ] [Thread-1 (]: 3 of 4 START sql table model credit.dim_purpose ................................ [RUN]
[0m12:04:49.330175 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_loanstatus, now model.credit.dim_purpose)
[0m12:04:49.330948 [debug] [Thread-1 (]: Began compiling node model.credit.dim_purpose
[0m12:04:49.337330 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_purpose"
[0m12:04:49.341682 [debug] [Thread-1 (]: Timing info for model.credit.dim_purpose (compile): 12:04:49.331469 => 12:04:49.341439
[0m12:04:49.342428 [debug] [Thread-1 (]: Began executing node model.credit.dim_purpose
[0m12:04:49.345480 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:04:49.740854 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_purpose"
[0m12:04:49.747196 [debug] [Thread-1 (]: On model.credit.dim_purpose: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_purpose"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`dim_purpose`
      
    
    

    OPTIONS()
    as (
      

SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast(Purpose as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as PurposeID,
		'Purpose' AS Purpose 
FROM `airflowcrtn`.`credit`.`raw_invoices`
WHERE Purpose  IS NOT NULL
    );
  
[0m12:04:50.234214 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:618ce1bf-41f5-40ed-ab57-97719c6c5dfc&page=queryresults
[0m12:04:53.061118 [debug] [Thread-1 (]: Timing info for model.credit.dim_purpose (execute): 12:04:49.342943 => 12:04:53.060816
[0m12:04:53.062577 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9efc7b3-de6d-40fd-94e1-41eae555517c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8278a83200>]}
[0m12:04:53.063561 [info ] [Thread-1 (]: 3 of 4 OK created sql table model credit.dim_purpose ........................... [[32mCREATE TABLE (16.0 rows, 1.7 MiB processed)[0m in 3.73s]
[0m12:04:53.064840 [debug] [Thread-1 (]: Finished running node model.credit.dim_purpose
[0m12:04:53.066336 [debug] [Thread-1 (]: Began running node model.credit.fact_invoices
[0m12:04:53.067156 [info ] [Thread-1 (]: 4 of 4 START sql table model credit.fact_invoices .............................. [RUN]
[0m12:04:53.068414 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_purpose, now model.credit.fact_invoices)
[0m12:04:53.069085 [debug] [Thread-1 (]: Began compiling node model.credit.fact_invoices
[0m12:04:53.077990 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.fact_invoices"
[0m12:04:53.083141 [debug] [Thread-1 (]: Timing info for model.credit.fact_invoices (compile): 12:04:53.069606 => 12:04:53.082878
[0m12:04:53.083659 [debug] [Thread-1 (]: Began executing node model.credit.fact_invoices
[0m12:04:53.086412 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:04:53.460980 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.fact_invoices"
[0m12:04:53.467841 [debug] [Thread-1 (]: On model.credit.fact_invoices: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.fact_invoices"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`fact_invoices`
      
    
    

    OPTIONS()
    as (
      


WITH fct_invoices_cte AS (
    SELECT DISTINCT
        "Loan ID" AS LoanID,
        "Customer ID" AS CustomerID,
        to_hex(md5(cast(coalesce(cast("Loan Status" as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Term as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as LoanStatusID,
        to_hex(md5(cast(coalesce(cast(Purpose as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as PurposeID,
        "Current Loan Amount" AS CurrentLoanAmount,
        "Credit Score" AS CreditScore,
        "Annual Income" AS AnnualIncome,
        "Monthly Debt" AS MonthlyDebt,
        "Years of Credit History" AS YearsofCreditHistory,
        "Months since last delinquent" AS Monthssincelastdelinquent,
        "Number of Open Accounts" AS NumberofOpenAccounts,
        "Number of Credit Problems" AS NumberofCreditProblems,
        "Current Credit Balance" AS CurrentCreditBalance,
        "Maximum Open Credit" AS MaximumOpenCredit,
        "Bankruptcies" AS Bankruptcies,
        "Tax Liens" AS TaxLiens       
      
    FROM `airflowcrtn`.`credit`.`raw_invoices`
    
)
SELECT
   fi.*
FROM fct_invoices_cte fi
INNER JOIN `airflowcrtn`.`credit`.`dim_purpose` dt ON fi.PurposeID = dt.PurposeID
INNER JOIN `airflowcrtn`.`credit`.`dim_loanstatus` dp ON fi.LoanStatusID = dp.LoanStatusID
INNER JOIN `airflowcrtn`.`credit`.`dim_customer` dc ON fi.CustomerID = dc.CustomerID
    );
  
[0m12:04:53.970065 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:bb21bfe5-03d7-44a0-b8d5-97ea9cfc680a&page=queryresults
[0m12:04:54.183930 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name CustomerID not found inside dc at [43:75]; reason: invalidQuery, location: query, message: Name CustomerID not found inside dc at [43:75]')
[0m12:04:54.770285 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:c0007c71-7e16-4eab-98e9-006f759d9728&page=queryresults
[0m12:04:54.974524 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:c0007c71-7e16-4eab-98e9-006f759d9728&page=queryresults
[0m12:04:54.975862 [debug] [Thread-1 (]: Timing info for model.credit.fact_invoices (execute): 12:04:53.084039 => 12:04:54.975505
[0m12:04:54.980783 [debug] [Thread-1 (]: Database Error in model fact_invoices (models/transform/fact_invoices.sql)
  Name CustomerID not found inside dc at [43:75]
  compiled Code at target/run/credit/models/transform/fact_invoices.sql
[0m12:04:54.981452 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9efc7b3-de6d-40fd-94e1-41eae555517c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f827808d5e0>]}
[0m12:04:54.982317 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model credit.fact_invoices ..................... [[31mERROR[0m in 1.91s]
[0m12:04:54.983297 [debug] [Thread-1 (]: Finished running node model.credit.fact_invoices
[0m12:04:54.986657 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:04:54.987380 [debug] [MainThread]: Connection 'model.credit.fact_invoices' was properly closed.
[0m12:04:54.987989 [info ] [MainThread]: 
[0m12:04:54.988696 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 12.65 seconds (12.65s).
[0m12:04:54.991080 [debug] [MainThread]: Command end result
[0m12:04:55.011874 [info ] [MainThread]: 
[0m12:04:55.012790 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:04:55.013440 [info ] [MainThread]: 
[0m12:04:55.014181 [error] [MainThread]:   Database Error in model fact_invoices (models/transform/fact_invoices.sql)
  Name CustomerID not found inside dc at [43:75]
  compiled Code at target/run/credit/models/transform/fact_invoices.sql
[0m12:04:55.014789 [info ] [MainThread]: 
[0m12:04:55.015519 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m12:04:55.016462 [debug] [MainThread]: Command `dbt run` failed at 12:04:55.016306 after 15.44 seconds
[0m12:04:55.017146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f827b466270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8279362c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8278e0aff0>]}
[0m12:04:55.017731 [debug] [MainThread]: Flushing usage events
[0m12:07:39.831759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7360f935f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7361328620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73613ee900>]}


============================== 12:07:39.834264 | ec5f3e6d-d775-490f-be9c-e4caa847d924 ==============================
[0m12:07:39.834264 [info ] [MainThread]: Running with dbt=1.6.18
[0m12:07:39.835079 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'version_check': 'True', 'printer_width': '80', 'target_path': 'None', 'cache_selected_only': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'introspect': 'True', 'fail_fast': 'False', 'static_parser': 'True', 'quiet': 'False', 'warn_error': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'write_json': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_colors': 'True', 'indirect_selection': 'eager', 'no_print': 'None'}
[0m12:07:40.033447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ec5f3e6d-d775-490f-be9c-e4caa847d924', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f735f9564e0>]}
[0m12:07:40.052469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ec5f3e6d-d775-490f-be9c-e4caa847d924', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f735f23cf50>]}
[0m12:07:40.053493 [info ] [MainThread]: Registered adapter: bigquery=1.6.0
[0m12:07:40.084254 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m12:07:40.657214 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:07:40.658380 [debug] [MainThread]: Partial parsing: updated file: credit://models/sources/sources.yml
[0m12:07:40.775757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec5f3e6d-d775-490f-be9c-e4caa847d924', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f735eecc4d0>]}
[0m12:07:40.796009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec5f3e6d-d775-490f-be9c-e4caa847d924', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f735ef84b00>]}
[0m12:07:40.796723 [info ] [MainThread]: Found 4 models, 1 source, 0 exposures, 0 metrics, 509 macros, 0 groups, 0 semantic models
[0m12:07:40.797343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec5f3e6d-d775-490f-be9c-e4caa847d924', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f735ef843e0>]}
[0m12:07:40.800156 [info ] [MainThread]: 
[0m12:07:40.801928 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:07:40.803924 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflowcrtn'
[0m12:07:40.804583 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:07:41.285713 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflowcrtn, now list_airflowcrtn_credit)
[0m12:07:41.286692 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:07:41.673459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec5f3e6d-d775-490f-be9c-e4caa847d924', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f735f1d27b0>]}
[0m12:07:41.674849 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:07:41.675592 [info ] [MainThread]: 
[0m12:07:41.679057 [debug] [Thread-1 (]: Began running node model.credit.dim_customer
[0m12:07:41.679958 [info ] [Thread-1 (]: 1 of 4 START sql table model credit.dim_customer ............................... [RUN]
[0m12:07:41.681260 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflowcrtn_credit, now model.credit.dim_customer)
[0m12:07:41.682020 [debug] [Thread-1 (]: Began compiling node model.credit.dim_customer
[0m12:07:41.693003 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_customer"
[0m12:07:41.699267 [debug] [Thread-1 (]: Timing info for model.credit.dim_customer (compile): 12:07:41.682655 => 12:07:41.698939
[0m12:07:41.700091 [debug] [Thread-1 (]: Began executing node model.credit.dim_customer
[0m12:07:41.717346 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:07:42.126236 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_customer"
[0m12:07:42.131338 [debug] [Thread-1 (]: On model.credit.dim_customer: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_customer"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`dim_customer`
      
    
    

    OPTIONS()
    as (
      

SELECT distinct
    "Customer ID" AS customer_id,
    "Years in Current Job" AS years_in_current_job,
    "Home Ownership" AS home_ownership
FROM airflowcrtn.credit.raw_invoices--- Replace with your actual source
WHERE "Customer ID" IS NOT NULL
    );
  
[0m12:07:42.750446 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:5c8342c4-1f38-46aa-9c0a-eac63d07e7f8&page=queryresults
[0m12:07:45.045002 [debug] [Thread-1 (]: Timing info for model.credit.dim_customer (execute): 12:07:41.700612 => 12:07:45.044688
[0m12:07:45.046346 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec5f3e6d-d775-490f-be9c-e4caa847d924', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f735ed52900>]}
[0m12:07:45.047112 [info ] [Thread-1 (]: 1 of 4 OK created sql table model credit.dim_customer .......................... [[32mCREATE TABLE (1.0 rows, 0 processed)[0m in 3.37s]
[0m12:07:45.048170 [debug] [Thread-1 (]: Finished running node model.credit.dim_customer
[0m12:07:45.048955 [debug] [Thread-1 (]: Began running node model.credit.dim_loanstatus
[0m12:07:45.049611 [info ] [Thread-1 (]: 2 of 4 START sql table model credit.dim_loanstatus ............................. [RUN]
[0m12:07:45.050624 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_customer, now model.credit.dim_loanstatus)
[0m12:07:45.051192 [debug] [Thread-1 (]: Began compiling node model.credit.dim_loanstatus
[0m12:07:45.056995 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_loanstatus"
[0m12:07:45.063360 [debug] [Thread-1 (]: Timing info for model.credit.dim_loanstatus (compile): 12:07:45.051628 => 12:07:45.063106
[0m12:07:45.063922 [debug] [Thread-1 (]: Began executing node model.credit.dim_loanstatus
[0m12:07:45.066709 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:07:45.450577 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_loanstatus"
[0m12:07:45.457047 [debug] [Thread-1 (]: On model.credit.dim_loanstatus: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_loanstatus"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`dim_loanstatus`
      
    
    

    OPTIONS()
    as (
      


SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast("Loan Status" as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Term as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as LoanStatusID,
	     "Loan Status" as LoanStatus,
         Term

FROM credit.raw_invoices
    );
  
[0m12:07:46.014472 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:0d01b991-26f3-41d5-9e81-e1bc5ce1f292&page=queryresults
[0m12:07:48.741688 [debug] [Thread-1 (]: Timing info for model.credit.dim_loanstatus (execute): 12:07:45.064360 => 12:07:48.741359
[0m12:07:48.743206 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec5f3e6d-d775-490f-be9c-e4caa847d924', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f735f0f8c20>]}
[0m12:07:48.744375 [info ] [Thread-1 (]: 2 of 4 OK created sql table model credit.dim_loanstatus ........................ [[32mCREATE TABLE (2.0 rows, 1.1 MiB processed)[0m in 3.69s]
[0m12:07:48.745779 [debug] [Thread-1 (]: Finished running node model.credit.dim_loanstatus
[0m12:07:48.746815 [debug] [Thread-1 (]: Began running node model.credit.dim_purpose
[0m12:07:48.747618 [info ] [Thread-1 (]: 3 of 4 START sql table model credit.dim_purpose ................................ [RUN]
[0m12:07:48.748787 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_loanstatus, now model.credit.dim_purpose)
[0m12:07:48.749543 [debug] [Thread-1 (]: Began compiling node model.credit.dim_purpose
[0m12:07:48.755615 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_purpose"
[0m12:07:48.761519 [debug] [Thread-1 (]: Timing info for model.credit.dim_purpose (compile): 12:07:48.750081 => 12:07:48.761114
[0m12:07:48.762322 [debug] [Thread-1 (]: Began executing node model.credit.dim_purpose
[0m12:07:48.765458 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:07:49.279929 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_purpose"
[0m12:07:49.293284 [debug] [Thread-1 (]: On model.credit.dim_purpose: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_purpose"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`dim_purpose`
      
    
    

    OPTIONS()
    as (
      

SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast(Purpose as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as PurposeID,
		'Purpose' AS Purpose 
FROM `airflowcrtn`.`raw_data`.`raw_invoices`
WHERE Purpose  IS NOT NULL
    );
  
[0m12:07:49.862295 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:ae15a74a-789c-48e5-aa03-7fecfb74deb1&page=queryresults
[0m12:07:49.863528 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_purpose"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`dim_purpose`
      
    
    

    OPTIONS()
    as (
      

SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast(Purpose as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as PurposeID,
		'Purpose' AS Purpose 
FROM `airflowcrtn`.`raw_data`.`raw_invoices`
WHERE Purpose  IS NOT NULL
    );
  
[0m12:07:49.864325 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Dataset airflowcrtn:raw_data was not found in location US; reason: notFound, message: Not found: Dataset airflowcrtn:raw_data was not found in location US

Location: US
Job ID: ae15a74a-789c-48e5-aa03-7fecfb74deb1

[0m12:07:49.865270 [debug] [Thread-1 (]: Timing info for model.credit.dim_purpose (execute): 12:07:48.762805 => 12:07:49.864973
[0m12:07:49.871494 [debug] [Thread-1 (]: Runtime Error in model dim_purpose (models/transform/dim_purpose.sql)
  404 Not found: Dataset airflowcrtn:raw_data was not found in location US; reason: notFound, message: Not found: Dataset airflowcrtn:raw_data was not found in location US
  
  Location: US
  Job ID: ae15a74a-789c-48e5-aa03-7fecfb74deb1
  
[0m12:07:49.872415 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec5f3e6d-d775-490f-be9c-e4caa847d924', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f735ef333e0>]}
[0m12:07:49.873368 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model credit.dim_purpose ....................... [[31mERROR[0m in 1.12s]
[0m12:07:49.874579 [debug] [Thread-1 (]: Finished running node model.credit.dim_purpose
[0m12:07:49.877132 [debug] [Thread-1 (]: Began running node model.credit.fact_invoices
[0m12:07:49.878168 [info ] [Thread-1 (]: 4 of 4 SKIP relation credit.fact_invoices ...................................... [[33mSKIP[0m]
[0m12:07:49.879121 [debug] [Thread-1 (]: Finished running node model.credit.fact_invoices
[0m12:07:49.881663 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:07:49.882297 [debug] [MainThread]: Connection 'model.credit.dim_purpose' was properly closed.
[0m12:07:49.882916 [info ] [MainThread]: 
[0m12:07:49.883564 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 9.08 seconds (9.08s).
[0m12:07:49.885596 [debug] [MainThread]: Command end result
[0m12:07:49.905252 [info ] [MainThread]: 
[0m12:07:49.906158 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:07:49.906789 [info ] [MainThread]: 
[0m12:07:49.907483 [error] [MainThread]:   Runtime Error in model dim_purpose (models/transform/dim_purpose.sql)
  404 Not found: Dataset airflowcrtn:raw_data was not found in location US; reason: notFound, message: Not found: Dataset airflowcrtn:raw_data was not found in location US
  
  Location: US
  Job ID: ae15a74a-789c-48e5-aa03-7fecfb74deb1
  
[0m12:07:49.908306 [info ] [MainThread]: 
[0m12:07:49.908989 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m12:07:49.909928 [debug] [MainThread]: Command `dbt run` failed at 12:07:49.909755 after 10.50 seconds
[0m12:07:49.910562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7361211520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f735ef21b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f735f0fa3c0>]}
[0m12:07:49.911208 [debug] [MainThread]: Flushing usage events
[0m12:08:05.415895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d63bceae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d6412b740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d63f643e0>]}


============================== 12:08:05.418283 | d8c02f1d-40f7-416a-9c84-ca0168f7d525 ==============================
[0m12:08:05.418283 [info ] [MainThread]: Running with dbt=1.6.18
[0m12:08:05.419592 [debug] [MainThread]: running dbt with arguments {'log_path': '/usr/local/airflow/include/dbt/logs', 'write_json': 'True', 'printer_width': '80', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'log_cache_events': 'False', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'quiet': 'False', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'debug': 'False', 'introspect': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'no_print': 'None', 'warn_error': 'None'}
[0m12:08:06.034901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd8c02f1d-40f7-416a-9c84-ca0168f7d525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d62718f80>]}
[0m12:08:06.052265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd8c02f1d-40f7-416a-9c84-ca0168f7d525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d61d22660>]}
[0m12:08:06.053333 [info ] [MainThread]: Registered adapter: bigquery=1.6.0
[0m12:08:06.082136 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m12:08:06.610069 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:08:06.611667 [debug] [MainThread]: Partial parsing: updated file: credit://models/sources/sources.yml
[0m12:08:06.736557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd8c02f1d-40f7-416a-9c84-ca0168f7d525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d61b2d9a0>]}
[0m12:08:06.756955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd8c02f1d-40f7-416a-9c84-ca0168f7d525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d61d2f7d0>]}
[0m12:08:06.757710 [info ] [MainThread]: Found 4 models, 1 source, 0 exposures, 0 metrics, 509 macros, 0 groups, 0 semantic models
[0m12:08:06.758270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8c02f1d-40f7-416a-9c84-ca0168f7d525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d61b14e00>]}
[0m12:08:06.760821 [info ] [MainThread]: 
[0m12:08:06.762116 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:08:06.763913 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflowcrtn'
[0m12:08:06.764538 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:08:07.208393 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflowcrtn, now list_airflowcrtn_credit)
[0m12:08:07.209365 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:08:07.585143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8c02f1d-40f7-416a-9c84-ca0168f7d525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d61b15730>]}
[0m12:08:07.586452 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:08:07.587286 [info ] [MainThread]: 
[0m12:08:07.591382 [debug] [Thread-1 (]: Began running node model.credit.dim_customer
[0m12:08:07.592274 [info ] [Thread-1 (]: 1 of 4 START sql table model credit.dim_customer ............................... [RUN]
[0m12:08:07.593523 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflowcrtn_credit, now model.credit.dim_customer)
[0m12:08:07.594164 [debug] [Thread-1 (]: Began compiling node model.credit.dim_customer
[0m12:08:07.604766 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_customer"
[0m12:08:07.611875 [debug] [Thread-1 (]: Timing info for model.credit.dim_customer (compile): 12:08:07.594592 => 12:08:07.611400
[0m12:08:07.612668 [debug] [Thread-1 (]: Began executing node model.credit.dim_customer
[0m12:08:07.630435 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:08.054593 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_customer"
[0m12:08:08.060758 [debug] [Thread-1 (]: On model.credit.dim_customer: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_customer"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`dim_customer`
      
    
    

    OPTIONS()
    as (
      

SELECT distinct
    "Customer ID" AS customer_id,
    "Years in Current Job" AS years_in_current_job,
    "Home Ownership" AS home_ownership
FROM airflowcrtn.credit.raw_invoices--- Replace with your actual source
WHERE "Customer ID" IS NOT NULL
    );
  
[0m12:08:09.020557 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:3b4aef7e-db20-43b0-922a-9d916c4666dc&page=queryresults
[0m12:08:11.640207 [debug] [Thread-1 (]: Timing info for model.credit.dim_customer (execute): 12:08:07.613146 => 12:08:11.639887
[0m12:08:11.641790 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8c02f1d-40f7-416a-9c84-ca0168f7d525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d619c6600>]}
[0m12:08:11.642787 [info ] [Thread-1 (]: 1 of 4 OK created sql table model credit.dim_customer .......................... [[32mCREATE TABLE (1.0 rows, 0 processed)[0m in 4.05s]
[0m12:08:11.644110 [debug] [Thread-1 (]: Finished running node model.credit.dim_customer
[0m12:08:11.644976 [debug] [Thread-1 (]: Began running node model.credit.dim_loanstatus
[0m12:08:11.645704 [info ] [Thread-1 (]: 2 of 4 START sql table model credit.dim_loanstatus ............................. [RUN]
[0m12:08:11.646679 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_customer, now model.credit.dim_loanstatus)
[0m12:08:11.647235 [debug] [Thread-1 (]: Began compiling node model.credit.dim_loanstatus
[0m12:08:11.653056 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_loanstatus"
[0m12:08:11.658952 [debug] [Thread-1 (]: Timing info for model.credit.dim_loanstatus (compile): 12:08:11.647679 => 12:08:11.658528
[0m12:08:11.659696 [debug] [Thread-1 (]: Began executing node model.credit.dim_loanstatus
[0m12:08:11.663441 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:12.079932 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_loanstatus"
[0m12:08:12.085739 [debug] [Thread-1 (]: On model.credit.dim_loanstatus: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_loanstatus"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`dim_loanstatus`
      
    
    

    OPTIONS()
    as (
      


SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast("Loan Status" as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Term as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as LoanStatusID,
	     "Loan Status" as LoanStatus,
         Term

FROM credit.raw_invoices
    );
  
[0m12:08:12.744339 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:b509cbb3-d424-464d-a558-223824dde030&page=queryresults
[0m12:08:14.779715 [debug] [Thread-1 (]: Timing info for model.credit.dim_loanstatus (execute): 12:08:11.660357 => 12:08:14.779410
[0m12:08:14.781302 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8c02f1d-40f7-416a-9c84-ca0168f7d525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d619c5a00>]}
[0m12:08:14.782222 [info ] [Thread-1 (]: 2 of 4 OK created sql table model credit.dim_loanstatus ........................ [[32mCREATE TABLE (2.0 rows, 1.1 MiB processed)[0m in 3.13s]
[0m12:08:14.783754 [debug] [Thread-1 (]: Finished running node model.credit.dim_loanstatus
[0m12:08:14.784741 [debug] [Thread-1 (]: Began running node model.credit.dim_purpose
[0m12:08:14.785558 [info ] [Thread-1 (]: 3 of 4 START sql table model credit.dim_purpose ................................ [RUN]
[0m12:08:14.786763 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_loanstatus, now model.credit.dim_purpose)
[0m12:08:14.787422 [debug] [Thread-1 (]: Began compiling node model.credit.dim_purpose
[0m12:08:14.794143 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_purpose"
[0m12:08:14.799033 [debug] [Thread-1 (]: Timing info for model.credit.dim_purpose (compile): 12:08:14.787963 => 12:08:14.798781
[0m12:08:14.799539 [debug] [Thread-1 (]: Began executing node model.credit.dim_purpose
[0m12:08:14.802237 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:15.290652 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_purpose"
[0m12:08:15.296717 [debug] [Thread-1 (]: On model.credit.dim_purpose: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_purpose"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`dim_purpose`
      
    
    

    OPTIONS()
    as (
      

SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast(Purpose as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as PurposeID,
		'Purpose' AS Purpose 
FROM `airflowcrtn`.`credit`.`raw_invoices`
WHERE Purpose  IS NOT NULL
    );
  
[0m12:08:15.851465 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:81d22c88-337f-4cc9-b660-b27df2feab9c&page=queryresults
[0m12:08:18.427392 [debug] [Thread-1 (]: Timing info for model.credit.dim_purpose (execute): 12:08:14.799931 => 12:08:18.427012
[0m12:08:18.428748 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8c02f1d-40f7-416a-9c84-ca0168f7d525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d619c6060>]}
[0m12:08:18.429821 [info ] [Thread-1 (]: 3 of 4 OK created sql table model credit.dim_purpose ........................... [[32mCREATE TABLE (16.0 rows, 1.7 MiB processed)[0m in 3.64s]
[0m12:08:18.431215 [debug] [Thread-1 (]: Finished running node model.credit.dim_purpose
[0m12:08:18.433142 [debug] [Thread-1 (]: Began running node model.credit.fact_invoices
[0m12:08:18.433925 [info ] [Thread-1 (]: 4 of 4 START sql table model credit.fact_invoices .............................. [RUN]
[0m12:08:18.435213 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_purpose, now model.credit.fact_invoices)
[0m12:08:18.435908 [debug] [Thread-1 (]: Began compiling node model.credit.fact_invoices
[0m12:08:18.444524 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.fact_invoices"
[0m12:08:18.450385 [debug] [Thread-1 (]: Timing info for model.credit.fact_invoices (compile): 12:08:18.436454 => 12:08:18.450074
[0m12:08:18.450966 [debug] [Thread-1 (]: Began executing node model.credit.fact_invoices
[0m12:08:18.453847 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:18.827958 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.fact_invoices"
[0m12:08:18.834412 [debug] [Thread-1 (]: On model.credit.fact_invoices: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.fact_invoices"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`fact_invoices`
      
    
    

    OPTIONS()
    as (
      


WITH fct_invoices_cte AS (
    SELECT DISTINCT
        "Loan ID" AS LoanID,
        "Customer ID" AS CustomerID,
        to_hex(md5(cast(coalesce(cast("Loan Status" as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Term as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as LoanStatusID,
        to_hex(md5(cast(coalesce(cast(Purpose as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as PurposeID,
        "Current Loan Amount" AS CurrentLoanAmount,
        "Credit Score" AS CreditScore,
        "Annual Income" AS AnnualIncome,
        "Monthly Debt" AS MonthlyDebt,
        "Years of Credit History" AS YearsofCreditHistory,
        "Months since last delinquent" AS Monthssincelastdelinquent,
        "Number of Open Accounts" AS NumberofOpenAccounts,
        "Number of Credit Problems" AS NumberofCreditProblems,
        "Current Credit Balance" AS CurrentCreditBalance,
        "Maximum Open Credit" AS MaximumOpenCredit,
        "Bankruptcies" AS Bankruptcies,
        "Tax Liens" AS TaxLiens       
      
    FROM `airflowcrtn`.`credit`.`raw_invoices`
    
)
SELECT
   fi.*
FROM fct_invoices_cte fi
INNER JOIN `airflowcrtn`.`credit`.`dim_purpose` dt ON fi.PurposeID = dt.PurposeID
INNER JOIN `airflowcrtn`.`credit`.`dim_loanstatus` dp ON fi.LoanStatusID = dp.LoanStatusID
INNER JOIN `airflowcrtn`.`credit`.`dim_customer` dc ON fi.CustomerID = dc.CustomerID
    );
  
[0m12:08:19.453524 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:207d3357-94c0-418f-8ec2-9ca1b39c07d8&page=queryresults
[0m12:08:25.708564 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name CustomerID not found inside dc at [43:75]; reason: invalidQuery, location: query, message: Name CustomerID not found inside dc at [43:75]')
[0m12:08:20.312065 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:5eb8d9a7-5245-4cbc-b230-aababaacc5d0&page=queryresults
[0m12:08:20.530063 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:5eb8d9a7-5245-4cbc-b230-aababaacc5d0&page=queryresults
[0m12:08:20.531647 [debug] [Thread-1 (]: Timing info for model.credit.fact_invoices (execute): 12:08:18.451391 => 12:08:20.531246
[0m12:08:20.538306 [debug] [Thread-1 (]: Database Error in model fact_invoices (models/transform/fact_invoices.sql)
  Name CustomerID not found inside dc at [43:75]
  compiled Code at target/run/credit/models/transform/fact_invoices.sql
[0m12:08:20.539119 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8c02f1d-40f7-416a-9c84-ca0168f7d525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d6198e360>]}
[0m12:08:20.540111 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model credit.fact_invoices ..................... [[31mERROR[0m in 2.10s]
[0m12:08:20.541656 [debug] [Thread-1 (]: Finished running node model.credit.fact_invoices
[0m12:08:20.546057 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:08:20.546760 [debug] [MainThread]: Connection 'model.credit.fact_invoices' was properly closed.
[0m12:08:20.547446 [info ] [MainThread]: 
[0m12:08:20.548321 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 13.79 seconds (13.79s).
[0m12:08:20.551269 [debug] [MainThread]: Command end result
[0m12:08:20.578217 [info ] [MainThread]: 
[0m12:08:20.579875 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:08:20.581126 [info ] [MainThread]: 
[0m12:08:20.582124 [error] [MainThread]:   Database Error in model fact_invoices (models/transform/fact_invoices.sql)
  Name CustomerID not found inside dc at [43:75]
  compiled Code at target/run/credit/models/transform/fact_invoices.sql
[0m12:08:20.583301 [info ] [MainThread]: 
[0m12:08:20.584630 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m12:08:20.586373 [debug] [MainThread]: Command `dbt run` failed at 12:08:20.586051 after 16.69 seconds
[0m12:08:20.587511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d641f7e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d619f4470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d619f43b0>]}
[0m12:08:20.588368 [debug] [MainThread]: Flushing usage events
[0m12:09:21.905606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92d21ca660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92d327cbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92d21cb860>]}


============================== 12:09:21.907861 | 844b0228-c8b0-4dee-b8e8-bbd6db489e84 ==============================
[0m12:09:21.907861 [info ] [MainThread]: Running with dbt=1.6.18
[0m12:09:21.908840 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'introspect': 'True', 'printer_width': '80', 'version_check': 'True', 'debug': 'False', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'log_path': '/usr/local/airflow/include/dbt/logs', 'fail_fast': 'False', 'log_format': 'default', 'partial_parse': 'True', 'no_print': 'None', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'use_colors': 'True', 'quiet': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'static_parser': 'True'}
[0m12:09:22.498801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '844b0228-c8b0-4dee-b8e8-bbd6db489e84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92d030a360>]}
[0m12:09:22.516021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '844b0228-c8b0-4dee-b8e8-bbd6db489e84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92d030ad20>]}
[0m12:09:22.517214 [info ] [MainThread]: Registered adapter: bigquery=1.6.0
[0m12:09:22.554742 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m12:09:22.840358 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:09:22.841480 [debug] [MainThread]: Partial parsing: updated file: credit://models/transform/dim_customer.sql
[0m12:09:22.905784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '844b0228-c8b0-4dee-b8e8-bbd6db489e84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92d030be30>]}
[0m12:09:22.925525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '844b0228-c8b0-4dee-b8e8-bbd6db489e84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92d0188ec0>]}
[0m12:09:22.926233 [info ] [MainThread]: Found 4 models, 1 source, 0 exposures, 0 metrics, 509 macros, 0 groups, 0 semantic models
[0m12:09:22.926814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '844b0228-c8b0-4dee-b8e8-bbd6db489e84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92d0188aa0>]}
[0m12:09:22.929284 [info ] [MainThread]: 
[0m12:09:22.930457 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:09:22.932095 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflowcrtn'
[0m12:09:22.932888 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:09:23.407935 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflowcrtn, now list_airflowcrtn_credit)
[0m12:09:23.409042 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:09:23.778064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '844b0228-c8b0-4dee-b8e8-bbd6db489e84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92d0340fb0>]}
[0m12:09:23.780093 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:09:23.780807 [info ] [MainThread]: 
[0m12:09:23.785829 [debug] [Thread-1 (]: Began running node model.credit.dim_customer
[0m12:09:23.786957 [info ] [Thread-1 (]: 1 of 4 START sql table model credit.dim_customer ............................... [RUN]
[0m12:09:23.788334 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflowcrtn_credit, now model.credit.dim_customer)
[0m12:09:23.789268 [debug] [Thread-1 (]: Began compiling node model.credit.dim_customer
[0m12:09:23.802363 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_customer"
[0m12:09:23.808975 [debug] [Thread-1 (]: Timing info for model.credit.dim_customer (compile): 12:09:23.789978 => 12:09:23.808539
[0m12:09:23.810053 [debug] [Thread-1 (]: Began executing node model.credit.dim_customer
[0m12:09:23.833837 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:24.273199 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_customer"
[0m12:09:24.279100 [debug] [Thread-1 (]: On model.credit.dim_customer: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_customer"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`dim_customer`
      
    
    

    OPTIONS()
    as (
      

SELECT
    `Customer ID` AS customer_id,  -- Example of selecting a column with spaces
    `Loan Status` AS loan_status,  -- Example of another column with spaces
    `Term` AS term,                -- Column with no spaces
    `Annual Income` AS annual_income
FROM `airflowcrtn`.`credit`.`raw_invoices`  -- Reference to the source defined in sources.yml
WHERE `Customer ID` IS NOT NULL
    );
  
[0m12:09:25.099819 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:3792c30a-6ed1-43f8-8941-dcf1210bb7f2&page=queryresults
[0m12:09:28.273102 [debug] [Thread-1 (]: Timing info for model.credit.dim_customer (execute): 12:09:23.810725 => 12:09:28.272824
[0m12:09:28.274362 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '844b0228-c8b0-4dee-b8e8-bbd6db489e84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92d011e6c0>]}
[0m12:09:28.275204 [info ] [Thread-1 (]: 1 of 4 OK created sql table model credit.dim_customer .......................... [[32mCREATE TABLE (100.0k rows, 6.5 MiB processed)[0m in 4.49s]
[0m12:09:28.276537 [debug] [Thread-1 (]: Finished running node model.credit.dim_customer
[0m12:09:28.277460 [debug] [Thread-1 (]: Began running node model.credit.dim_loanstatus
[0m12:09:28.278218 [info ] [Thread-1 (]: 2 of 4 START sql table model credit.dim_loanstatus ............................. [RUN]
[0m12:09:28.279190 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_customer, now model.credit.dim_loanstatus)
[0m12:09:28.279791 [debug] [Thread-1 (]: Began compiling node model.credit.dim_loanstatus
[0m12:09:28.297675 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_loanstatus"
[0m12:09:28.303397 [debug] [Thread-1 (]: Timing info for model.credit.dim_loanstatus (compile): 12:09:28.280246 => 12:09:28.303080
[0m12:09:28.304095 [debug] [Thread-1 (]: Began executing node model.credit.dim_loanstatus
[0m12:09:28.307091 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:28.704637 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_loanstatus"
[0m12:09:28.712631 [debug] [Thread-1 (]: On model.credit.dim_loanstatus: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_loanstatus"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`dim_loanstatus`
      
    
    

    OPTIONS()
    as (
      


SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast("Loan Status" as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Term as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as LoanStatusID,
	     "Loan Status" as LoanStatus,
         Term

FROM credit.raw_invoices
    );
  
[0m12:09:29.225209 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:fbffd1a1-2640-4412-a278-3057676a2488&page=queryresults
[0m12:09:31.253045 [debug] [Thread-1 (]: Timing info for model.credit.dim_loanstatus (execute): 12:09:28.304545 => 12:09:31.252730
[0m12:09:31.254449 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '844b0228-c8b0-4dee-b8e8-bbd6db489e84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92d2db2c90>]}
[0m12:09:31.255498 [info ] [Thread-1 (]: 2 of 4 OK created sql table model credit.dim_loanstatus ........................ [[32mCREATE TABLE (2.0 rows, 1.1 MiB processed)[0m in 2.98s]
[0m12:09:31.256830 [debug] [Thread-1 (]: Finished running node model.credit.dim_loanstatus
[0m12:09:31.257850 [debug] [Thread-1 (]: Began running node model.credit.dim_purpose
[0m12:09:31.258784 [info ] [Thread-1 (]: 3 of 4 START sql table model credit.dim_purpose ................................ [RUN]
[0m12:09:31.259973 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_loanstatus, now model.credit.dim_purpose)
[0m12:09:31.260662 [debug] [Thread-1 (]: Began compiling node model.credit.dim_purpose
[0m12:09:31.266729 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_purpose"
[0m12:09:31.272018 [debug] [Thread-1 (]: Timing info for model.credit.dim_purpose (compile): 12:09:31.261250 => 12:09:31.271650
[0m12:09:31.272631 [debug] [Thread-1 (]: Began executing node model.credit.dim_purpose
[0m12:09:31.275586 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:31.668188 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_purpose"
[0m12:09:31.674476 [debug] [Thread-1 (]: On model.credit.dim_purpose: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_purpose"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`dim_purpose`
      
    
    

    OPTIONS()
    as (
      

SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast(Purpose as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as PurposeID,
		'Purpose' AS Purpose 
FROM `airflowcrtn`.`credit`.`raw_invoices`
WHERE Purpose  IS NOT NULL
    );
  
[0m12:09:32.092660 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:125d3c7d-3994-4b8f-a46e-b22c61345e9a&page=queryresults
[0m12:09:34.616745 [debug] [Thread-1 (]: Timing info for model.credit.dim_purpose (execute): 12:09:31.273069 => 12:09:34.616434
[0m12:09:34.618288 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '844b0228-c8b0-4dee-b8e8-bbd6db489e84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92d0135340>]}
[0m12:09:34.619311 [info ] [Thread-1 (]: 3 of 4 OK created sql table model credit.dim_purpose ........................... [[32mCREATE TABLE (16.0 rows, 1.7 MiB processed)[0m in 3.36s]
[0m12:09:34.620586 [debug] [Thread-1 (]: Finished running node model.credit.dim_purpose
[0m12:09:34.622609 [debug] [Thread-1 (]: Began running node model.credit.fact_invoices
[0m12:09:34.623503 [info ] [Thread-1 (]: 4 of 4 START sql table model credit.fact_invoices .............................. [RUN]
[0m12:09:34.624701 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_purpose, now model.credit.fact_invoices)
[0m12:09:34.625399 [debug] [Thread-1 (]: Began compiling node model.credit.fact_invoices
[0m12:09:34.635154 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.fact_invoices"
[0m12:09:34.641177 [debug] [Thread-1 (]: Timing info for model.credit.fact_invoices (compile): 12:09:34.625932 => 12:09:34.640780
[0m12:09:34.641824 [debug] [Thread-1 (]: Began executing node model.credit.fact_invoices
[0m12:09:34.644833 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:34.558128 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.fact_invoices"
[0m12:09:34.563662 [debug] [Thread-1 (]: On model.credit.fact_invoices: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.fact_invoices"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`fact_invoices`
      
    
    

    OPTIONS()
    as (
      


WITH fct_invoices_cte AS (
    SELECT DISTINCT
        "Loan ID" AS LoanID,
        "Customer ID" AS CustomerID,
        to_hex(md5(cast(coalesce(cast("Loan Status" as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Term as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as LoanStatusID,
        to_hex(md5(cast(coalesce(cast(Purpose as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as PurposeID,
        "Current Loan Amount" AS CurrentLoanAmount,
        "Credit Score" AS CreditScore,
        "Annual Income" AS AnnualIncome,
        "Monthly Debt" AS MonthlyDebt,
        "Years of Credit History" AS YearsofCreditHistory,
        "Months since last delinquent" AS Monthssincelastdelinquent,
        "Number of Open Accounts" AS NumberofOpenAccounts,
        "Number of Credit Problems" AS NumberofCreditProblems,
        "Current Credit Balance" AS CurrentCreditBalance,
        "Maximum Open Credit" AS MaximumOpenCredit,
        "Bankruptcies" AS Bankruptcies,
        "Tax Liens" AS TaxLiens       
      
    FROM `airflowcrtn`.`credit`.`raw_invoices`
    
)
SELECT
   fi.*
FROM fct_invoices_cte fi
INNER JOIN `airflowcrtn`.`credit`.`dim_purpose` dt ON fi.PurposeID = dt.PurposeID
INNER JOIN `airflowcrtn`.`credit`.`dim_loanstatus` dp ON fi.LoanStatusID = dp.LoanStatusID
INNER JOIN `airflowcrtn`.`credit`.`dim_customer` dc ON fi.CustomerID = dc.CustomerID
    );
  
[0m12:09:35.022829 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:0b23b915-ef0a-4826-8bca-5962a1e7c678&page=queryresults
[0m12:09:35.231274 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name CustomerID not found inside dc at [43:75]; reason: invalidQuery, location: query, message: Name CustomerID not found inside dc at [43:75]')
[0m12:09:36.212854 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:28480974-e742-4b9b-9826-00e575531a47&page=queryresults
[0m12:09:36.489412 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:28480974-e742-4b9b-9826-00e575531a47&page=queryresults
[0m12:09:36.491276 [debug] [Thread-1 (]: Timing info for model.credit.fact_invoices (execute): 12:09:34.642226 => 12:09:36.490865
[0m12:09:36.497997 [debug] [Thread-1 (]: Database Error in model fact_invoices (models/transform/fact_invoices.sql)
  Name CustomerID not found inside dc at [43:75]
  compiled Code at target/run/credit/models/transform/fact_invoices.sql
[0m12:09:36.498851 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '844b0228-c8b0-4dee-b8e8-bbd6db489e84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92ce7abfb0>]}
[0m12:09:36.500370 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model credit.fact_invoices ..................... [[31mERROR[0m in 1.87s]
[0m12:09:36.501673 [debug] [Thread-1 (]: Finished running node model.credit.fact_invoices
[0m12:09:36.505795 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:09:36.506491 [debug] [MainThread]: Connection 'model.credit.fact_invoices' was properly closed.
[0m12:09:36.507027 [info ] [MainThread]: 
[0m12:09:36.507654 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 13.58 seconds (13.58s).
[0m12:09:36.509939 [debug] [MainThread]: Command end result
[0m12:09:36.534574 [info ] [MainThread]: 
[0m12:09:36.535415 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:09:36.536058 [info ] [MainThread]: 
[0m12:09:36.536645 [error] [MainThread]:   Database Error in model fact_invoices (models/transform/fact_invoices.sql)
  Name CustomerID not found inside dc at [43:75]
  compiled Code at target/run/credit/models/transform/fact_invoices.sql
[0m12:09:36.537342 [info ] [MainThread]: 
[0m12:09:36.538090 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m12:09:36.539381 [debug] [MainThread]: Command `dbt run` failed at 12:09:36.539105 after 16.16 seconds
[0m12:09:36.540189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92d2668b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92d0269010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92d03da4e0>]}
[0m12:09:36.541047 [debug] [MainThread]: Flushing usage events
[0m12:15:52.972038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2839caae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa283c2a5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa283c52d20>]}


============================== 12:15:52.974069 | fe1861c7-cd4d-4065-91f0-db91696439fc ==============================
[0m12:15:52.974069 [info ] [MainThread]: Running with dbt=1.6.18
[0m12:15:52.974960 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'introspect': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'target_path': 'None', 'log_cache_events': 'False', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'fail_fast': 'False', 'printer_width': '80', 'static_parser': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'partial_parse': 'True', 'debug': 'False', 'write_json': 'True', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'version_check': 'True'}
[0m12:15:53.569896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe1861c7-cd4d-4065-91f0-db91696439fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa28246a630>]}
[0m12:15:53.586905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fe1861c7-cd4d-4065-91f0-db91696439fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa281b1d7c0>]}
[0m12:15:53.587932 [info ] [MainThread]: Registered adapter: bigquery=1.6.0
[0m12:15:53.617354 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m12:15:54.182901 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m12:15:54.183920 [debug] [MainThread]: Partial parsing: updated file: credit://models/transform/dim_customer.sql
[0m12:15:54.184674 [debug] [MainThread]: Partial parsing: updated file: credit://models/transform/dim_purpose.sql
[0m12:15:54.185367 [debug] [MainThread]: Partial parsing: updated file: credit://models/transform/fact_invoices.sql
[0m12:15:54.186017 [debug] [MainThread]: Partial parsing: updated file: credit://models/transform/dim_loanstatus.sql
[0m12:15:54.296771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe1861c7-cd4d-4065-91f0-db91696439fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa281b0a450>]}
[0m12:15:54.320447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe1861c7-cd4d-4065-91f0-db91696439fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa28192bf80>]}
[0m12:15:54.321385 [info ] [MainThread]: Found 4 models, 1 source, 0 exposures, 0 metrics, 509 macros, 0 groups, 0 semantic models
[0m12:15:54.322108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe1861c7-cd4d-4065-91f0-db91696439fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2818f9490>]}
[0m12:15:54.324671 [info ] [MainThread]: 
[0m12:15:54.325959 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:15:54.327935 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflowcrtn'
[0m12:15:54.328601 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:15:54.924996 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflowcrtn, now list_airflowcrtn_credit)
[0m12:15:54.925992 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:15:55.321980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe1861c7-cd4d-4065-91f0-db91696439fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2818fa750>]}
[0m12:15:55.323375 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:15:55.324134 [info ] [MainThread]: 
[0m12:15:55.328053 [debug] [Thread-1 (]: Began running node model.credit.dim_customer
[0m12:15:55.328947 [info ] [Thread-1 (]: 1 of 4 START sql table model credit.dim_customer ............................... [RUN]
[0m12:15:55.330179 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflowcrtn_credit, now model.credit.dim_customer)
[0m12:15:55.330827 [debug] [Thread-1 (]: Began compiling node model.credit.dim_customer
[0m12:15:55.341024 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_customer"
[0m12:15:55.346526 [debug] [Thread-1 (]: Timing info for model.credit.dim_customer (compile): 12:15:55.331421 => 12:15:55.346219
[0m12:15:55.347118 [debug] [Thread-1 (]: Began executing node model.credit.dim_customer
[0m12:15:55.363986 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:15:55.265948 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_customer"
[0m12:15:55.271829 [debug] [Thread-1 (]: On model.credit.dim_customer: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_customer"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`dim_customer`
      
    
    

    OPTIONS()
    as (
      

SELECT
    `Customer ID` AS customerid,
    `Years in Current Job` AS years_in_current_job,
    `Home Ownership` AS home_ownership
FROM `airflowcrtn`.`credit`.`raw_invoices`  -- Reference to the source defined in sources.yml
WHERE `Customer ID` IS NOT NULL
    );
  
[0m12:15:55.884582 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:c5fd50d2-54a4-4726-894b-8fb319959aea&page=queryresults
[0m12:15:59.345611 [debug] [Thread-1 (]: Timing info for model.credit.dim_customer (execute): 12:15:55.347554 => 12:15:59.345266
[0m12:15:59.347127 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe1861c7-cd4d-4065-91f0-db91696439fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa28192b6e0>]}
[0m12:15:59.348159 [info ] [Thread-1 (]: 1 of 4 OK created sql table model credit.dim_customer .......................... [[32mCREATE TABLE (100.0k rows, 5.5 MiB processed)[0m in 4.02s]
[0m12:15:59.349341 [debug] [Thread-1 (]: Finished running node model.credit.dim_customer
[0m12:15:59.350438 [debug] [Thread-1 (]: Began running node model.credit.dim_loanstatus
[0m12:15:59.351301 [info ] [Thread-1 (]: 2 of 4 START sql table model credit.dim_loanstatus ............................. [RUN]
[0m12:15:59.352410 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_customer, now model.credit.dim_loanstatus)
[0m12:15:59.352985 [debug] [Thread-1 (]: Began compiling node model.credit.dim_loanstatus
[0m12:15:59.360084 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_loanstatus"
[0m12:15:59.367716 [debug] [Thread-1 (]: Timing info for model.credit.dim_loanstatus (compile): 12:15:59.353548 => 12:15:59.367189
[0m12:15:59.368634 [debug] [Thread-1 (]: Began executing node model.credit.dim_loanstatus
[0m12:15:59.372436 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:15:59.810597 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_loanstatus"
[0m12:15:59.817475 [debug] [Thread-1 (]: On model.credit.dim_loanstatus: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_loanstatus"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`dim_loanstatus`
      
    
    

    OPTIONS()
    as (
      


SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast(`Loan Status` as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Term as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as LoanStatusID,
	     `Loan Status` as LoanStatus,
         Term

FROM `airflowcrtn`.`credit`.`raw_invoices`
    );
  
[0m12:16:00.364404 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:98c2c54a-40e1-4cc6-8cdc-64a81acd248c&page=queryresults
[0m12:16:02.895128 [debug] [Thread-1 (]: Timing info for model.credit.dim_loanstatus (execute): 12:15:59.369219 => 12:16:02.894750
[0m12:16:02.896760 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe1861c7-cd4d-4065-91f0-db91696439fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa26bf84cb0>]}
[0m12:16:02.897941 [info ] [Thread-1 (]: 2 of 4 OK created sql table model credit.dim_loanstatus ........................ [[32mCREATE TABLE (4.0 rows, 2.3 MiB processed)[0m in 3.54s]
[0m12:16:02.899518 [debug] [Thread-1 (]: Finished running node model.credit.dim_loanstatus
[0m12:16:02.900593 [debug] [Thread-1 (]: Began running node model.credit.dim_purpose
[0m12:16:02.901466 [info ] [Thread-1 (]: 3 of 4 START sql table model credit.dim_purpose ................................ [RUN]
[0m12:16:02.902755 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_loanstatus, now model.credit.dim_purpose)
[0m12:16:02.903591 [debug] [Thread-1 (]: Began compiling node model.credit.dim_purpose
[0m12:16:02.911171 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_purpose"
[0m12:16:02.916515 [debug] [Thread-1 (]: Timing info for model.credit.dim_purpose (compile): 12:16:02.904097 => 12:16:02.916223
[0m12:16:02.917138 [debug] [Thread-1 (]: Began executing node model.credit.dim_purpose
[0m12:16:02.920139 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:03.319870 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_purpose"
[0m12:16:03.325840 [debug] [Thread-1 (]: On model.credit.dim_purpose: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_purpose"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`dim_purpose`
      
    
    

    OPTIONS()
    as (
      

SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast(Purpose as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as PurposeID,
		Purpose AS Purpose 
FROM `airflowcrtn`.`credit`.`raw_invoices`
WHERE Purpose  IS NOT NULL
    );
  
[0m12:16:04.068741 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:2a3bdde5-bcd8-47ba-a832-6c9fa9a79a7c&page=queryresults
[0m12:16:06.447251 [debug] [Thread-1 (]: Timing info for model.credit.dim_purpose (execute): 12:16:02.917537 => 12:16:06.446947
[0m12:16:06.449098 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe1861c7-cd4d-4065-91f0-db91696439fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa26bfa8380>]}
[0m12:16:06.450295 [info ] [Thread-1 (]: 3 of 4 OK created sql table model credit.dim_purpose ........................... [[32mCREATE TABLE (16.0 rows, 1.7 MiB processed)[0m in 3.55s]
[0m12:16:06.451902 [debug] [Thread-1 (]: Finished running node model.credit.dim_purpose
[0m12:16:06.453784 [debug] [Thread-1 (]: Began running node model.credit.fact_invoices
[0m12:16:06.454577 [info ] [Thread-1 (]: 4 of 4 START sql table model credit.fact_invoices .............................. [RUN]
[0m12:16:06.456033 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_purpose, now model.credit.fact_invoices)
[0m12:16:06.456887 [debug] [Thread-1 (]: Began compiling node model.credit.fact_invoices
[0m12:16:06.466529 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.fact_invoices"
[0m12:16:06.471894 [debug] [Thread-1 (]: Timing info for model.credit.fact_invoices (compile): 12:16:06.457448 => 12:16:06.471618
[0m12:16:06.472502 [debug] [Thread-1 (]: Began executing node model.credit.fact_invoices
[0m12:16:06.475353 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:06.865927 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.fact_invoices"
[0m12:16:06.872066 [debug] [Thread-1 (]: On model.credit.fact_invoices: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.fact_invoices"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`fact_invoices`
      
    
    

    OPTIONS()
    as (
      


WITH fct_invoices_cte AS (
    SELECT DISTINCT
        `Loan ID` AS LoanID,
        `Customer ID` AS CustomerID,
        to_hex(md5(cast(coalesce(cast(`Loan Status` as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Term as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as LoanStatusID,
        to_hex(md5(cast(coalesce(cast(Purpose as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as PurposeID,
        `Current Loan Amount` AS CurrentLoanAmount,
        `Credit Score` AS CreditScore,
        `Annual Income` AS AnnualIncome,
        `Monthly Debt` AS MonthlyDebt,
        `Years of Credit History` AS YearsofCreditHistory,
        `Months since last delinquent` AS Monthssincelastdelinquent,
        `Number of Open Accounts` AS NumberofOpenAccounts,
        `Number of Credit Problems` AS NumberofCreditProblems,
        `Current Credit Balance` AS CurrentCreditBalance,
        `Maximum Open Credit` AS MaximumOpenCredit,
        `Bankruptcies` AS Bankruptcies,
        `Tax Liens` AS TaxLiens       
      
    FROM `airflowcrtn`.`credit`.`raw_invoices`
    
)
SELECT
   fi.*
FROM fct_invoices_cte fi
INNER JOIN `airflowcrtn`.`credit`.`dim_purpose` dt ON fi.PurposeID = dt.PurposeID
INNER JOIN `airflowcrtn`.`credit`.`dim_loanstatus` dp ON fi.LoanStatusID = dp.LoanStatusID
INNER JOIN `airflowcrtn`.`credit`.`dim_customer` dc ON fi.CustomerID = dc.CustomerID
    );
  
[0m12:16:07.398829 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:bc818112-d498-4161-af25-ae05ee0ec5cb&page=queryresults
[0m12:16:12.060853 [debug] [Thread-1 (]: Timing info for model.credit.fact_invoices (execute): 12:16:06.472927 => 12:16:12.060549
[0m12:16:12.062616 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe1861c7-cd4d-4065-91f0-db91696439fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa26bf86ab0>]}
[0m12:16:12.063583 [info ] [Thread-1 (]: 4 of 4 OK created sql table model credit.fact_invoices ......................... [[32mCREATE TABLE (115.6k rows, 23.4 MiB processed)[0m in 5.61s]
[0m12:16:12.064848 [debug] [Thread-1 (]: Finished running node model.credit.fact_invoices
[0m12:16:12.067821 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:16:12.068460 [debug] [MainThread]: Connection 'model.credit.fact_invoices' was properly closed.
[0m12:16:12.069128 [info ] [MainThread]: 
[0m12:16:12.069888 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 17.74 seconds (17.74s).
[0m12:16:12.072095 [debug] [MainThread]: Command end result
[0m12:16:12.093038 [info ] [MainThread]: 
[0m12:16:12.093809 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:16:12.094445 [info ] [MainThread]: 
[0m12:16:12.095108 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m12:16:12.096128 [debug] [MainThread]: Command `dbt run` succeeded at 12:16:12.095927 after 21.32 seconds
[0m12:16:12.096868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa284d1b920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa281b1f440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa28246a660>]}
[0m12:16:12.097498 [debug] [MainThread]: Flushing usage events
[0m12:32:34.353994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5009a21e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd501355ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5013556a0>]}


============================== 12:32:34.356967 | e9af62b4-ffb8-4135-a815-63a34749376c ==============================
[0m12:32:34.356967 [info ] [MainThread]: Running with dbt=1.6.18
[0m12:32:34.357955 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'debug': 'False', 'log_cache_events': 'False', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'version_check': 'True', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': '/usr/local/airflow/include/dbt/logs', 'use_experimental_parser': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error': 'None', 'introspect': 'True', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'no_print': 'None', 'target_path': 'None', 'cache_selected_only': 'False', 'write_json': 'True', 'use_colors': 'True'}
[0m12:32:35.368467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e9af62b4-ffb8-4135-a815-63a34749376c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4fea80ad0>]}
[0m12:32:35.386013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e9af62b4-ffb8-4135-a815-63a34749376c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4feae18b0>]}
[0m12:32:35.387729 [info ] [MainThread]: Registered adapter: bigquery=1.6.0
[0m12:32:35.419573 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m12:32:36.049974 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:32:36.050902 [debug] [MainThread]: Partial parsing: updated file: credit://models/transform/dim_customer.sql
[0m12:32:36.115251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e9af62b4-ffb8-4135-a815-63a34749376c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4fe8d0200>]}
[0m12:32:36.136480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e9af62b4-ffb8-4135-a815-63a34749376c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4fe970a40>]}
[0m12:32:36.137235 [info ] [MainThread]: Found 4 models, 1 source, 0 exposures, 0 metrics, 509 macros, 0 groups, 0 semantic models
[0m12:32:36.137865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9af62b4-ffb8-4135-a815-63a34749376c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4feb4f200>]}
[0m12:32:36.140164 [info ] [MainThread]: 
[0m12:32:36.141415 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:32:36.143032 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflowcrtn'
[0m12:32:36.143640 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:32:36.625581 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflowcrtn, now list_airflowcrtn_credit)
[0m12:32:36.626533 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:32:36.787819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9af62b4-ffb8-4135-a815-63a34749376c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd500e0f8f0>]}
[0m12:32:36.789191 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:32:36.789999 [info ] [MainThread]: 
[0m12:32:36.795182 [debug] [Thread-1 (]: Began running node model.credit.dim_customer
[0m12:32:36.796242 [info ] [Thread-1 (]: 1 of 4 START sql table model credit.dim_customer ............................... [RUN]
[0m12:32:36.797472 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflowcrtn_credit, now model.credit.dim_customer)
[0m12:32:36.798196 [debug] [Thread-1 (]: Began compiling node model.credit.dim_customer
[0m12:32:36.808341 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_customer"
[0m12:32:36.813223 [debug] [Thread-1 (]: Timing info for model.credit.dim_customer (compile): 12:32:36.798800 => 12:32:36.812858
[0m12:32:36.813847 [debug] [Thread-1 (]: Began executing node model.credit.dim_customer
[0m12:32:36.831200 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:32:37.273787 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_customer"
[0m12:32:37.279307 [debug] [Thread-1 (]: On model.credit.dim_customer: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_customer"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`dim_customer`
      
    
    

    OPTIONS()
    as (
      

SELECT distinct
    `Customer ID` AS customerid,
    `Years in Current Job` AS years_in_current_job,
    `Home Ownership` AS home_ownership
FROM `airflowcrtn`.`credit`.`raw_invoices`  -- Reference to the source defined in sources.yml
WHERE `Customer ID` IS NOT NULL
    );
  
[0m12:32:38.395859 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:3eafc1fb-c9d0-431b-9b60-5843492b3858&page=queryresults
[0m12:32:41.244754 [debug] [Thread-1 (]: Timing info for model.credit.dim_customer (execute): 12:32:36.814252 => 12:32:41.244487
[0m12:32:41.245919 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9af62b4-ffb8-4135-a815-63a34749376c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4fe903410>]}
[0m12:32:41.246732 [info ] [Thread-1 (]: 1 of 4 OK created sql table model credit.dim_customer .......................... [[32mCREATE TABLE (82.0k rows, 5.5 MiB processed)[0m in 4.45s]
[0m12:32:41.247969 [debug] [Thread-1 (]: Finished running node model.credit.dim_customer
[0m12:32:41.248807 [debug] [Thread-1 (]: Began running node model.credit.dim_loanstatus
[0m12:32:41.249645 [info ] [Thread-1 (]: 2 of 4 START sql table model credit.dim_loanstatus ............................. [RUN]
[0m12:32:41.250719 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_customer, now model.credit.dim_loanstatus)
[0m12:32:41.251278 [debug] [Thread-1 (]: Began compiling node model.credit.dim_loanstatus
[0m12:32:41.269343 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_loanstatus"
[0m12:32:41.274595 [debug] [Thread-1 (]: Timing info for model.credit.dim_loanstatus (compile): 12:32:41.251724 => 12:32:41.274225
[0m12:32:41.275202 [debug] [Thread-1 (]: Began executing node model.credit.dim_loanstatus
[0m12:32:41.278146 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:32:41.692337 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_loanstatus"
[0m12:32:41.698526 [debug] [Thread-1 (]: On model.credit.dim_loanstatus: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_loanstatus"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`dim_loanstatus`
      
    
    

    OPTIONS()
    as (
      


SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast(`Loan Status` as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Term as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as LoanStatusID,
	     `Loan Status` as LoanStatus,
         Term

FROM `airflowcrtn`.`credit`.`raw_invoices`
    );
  
[0m12:32:41.828876 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:50a4683d-4b2a-4bdb-a93c-f9dfff0c8001&page=queryresults
[0m12:32:44.306799 [debug] [Thread-1 (]: Timing info for model.credit.dim_loanstatus (execute): 12:32:41.275596 => 12:32:44.306512
[0m12:32:44.308017 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9af62b4-ffb8-4135-a815-63a34749376c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4fe9024e0>]}
[0m12:32:44.308836 [info ] [Thread-1 (]: 2 of 4 OK created sql table model credit.dim_loanstatus ........................ [[32mCREATE TABLE (4.0 rows, 2.3 MiB processed)[0m in 3.06s]
[0m12:32:44.309946 [debug] [Thread-1 (]: Finished running node model.credit.dim_loanstatus
[0m12:32:44.310831 [debug] [Thread-1 (]: Began running node model.credit.dim_purpose
[0m12:32:44.311575 [info ] [Thread-1 (]: 3 of 4 START sql table model credit.dim_purpose ................................ [RUN]
[0m12:32:44.312599 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_loanstatus, now model.credit.dim_purpose)
[0m12:32:44.313179 [debug] [Thread-1 (]: Began compiling node model.credit.dim_purpose
[0m12:32:44.318962 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.dim_purpose"
[0m12:32:44.324137 [debug] [Thread-1 (]: Timing info for model.credit.dim_purpose (compile): 12:32:44.313732 => 12:32:44.323813
[0m12:32:44.324764 [debug] [Thread-1 (]: Began executing node model.credit.dim_purpose
[0m12:32:44.328124 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:32:44.731741 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.dim_purpose"
[0m12:32:44.739215 [debug] [Thread-1 (]: On model.credit.dim_purpose: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.dim_purpose"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`dim_purpose`
      
    
    

    OPTIONS()
    as (
      

SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast(Purpose as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as PurposeID,
		Purpose AS Purpose 
FROM `airflowcrtn`.`credit`.`raw_invoices`
WHERE Purpose  IS NOT NULL
    );
  
[0m12:32:45.324864 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:62c84f74-85c7-4910-b1ea-624c9f89f5ab&page=queryresults
[0m12:32:48.910706 [debug] [Thread-1 (]: Timing info for model.credit.dim_purpose (execute): 12:32:44.325207 => 12:32:48.910392
[0m12:32:48.912156 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9af62b4-ffb8-4135-a815-63a34749376c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4eef11a90>]}
[0m12:32:48.913276 [info ] [Thread-1 (]: 3 of 4 OK created sql table model credit.dim_purpose ........................... [[32mCREATE TABLE (16.0 rows, 1.7 MiB processed)[0m in 4.60s]
[0m12:32:48.914663 [debug] [Thread-1 (]: Finished running node model.credit.dim_purpose
[0m12:32:48.916320 [debug] [Thread-1 (]: Began running node model.credit.fact_invoices
[0m12:32:48.917141 [info ] [Thread-1 (]: 4 of 4 START sql table model credit.fact_invoices .............................. [RUN]
[0m12:32:48.918496 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.credit.dim_purpose, now model.credit.fact_invoices)
[0m12:32:48.919231 [debug] [Thread-1 (]: Began compiling node model.credit.fact_invoices
[0m12:32:48.928440 [debug] [Thread-1 (]: Writing injected SQL for node "model.credit.fact_invoices"
[0m12:32:48.934704 [debug] [Thread-1 (]: Timing info for model.credit.fact_invoices (compile): 12:32:48.919743 => 12:32:48.934291
[0m12:32:48.935430 [debug] [Thread-1 (]: Began executing node model.credit.fact_invoices
[0m12:32:48.939149 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:32:49.545806 [debug] [Thread-1 (]: Writing runtime sql for node "model.credit.fact_invoices"
[0m12:32:49.551181 [debug] [Thread-1 (]: On model.credit.fact_invoices: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "credit", "target_name": "dev", "node_id": "model.credit.fact_invoices"} */

  
    

    create or replace table `airflowcrtn`.`credit`.`fact_invoices`
      
    
    

    OPTIONS()
    as (
      


WITH fct_invoices_cte AS (
    SELECT DISTINCT
        `Loan ID` AS LoanID,
        `Customer ID` AS CustomerID,
        to_hex(md5(cast(coalesce(cast(`Loan Status` as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Term as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as LoanStatusID,
        to_hex(md5(cast(coalesce(cast(Purpose as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as PurposeID,
        `Current Loan Amount` AS CurrentLoanAmount,
        `Credit Score` AS CreditScore,
        `Annual Income` AS AnnualIncome,
        `Monthly Debt` AS MonthlyDebt,
        `Years of Credit History` AS YearsofCreditHistory,
        `Months since last delinquent` AS Monthssincelastdelinquent,
        `Number of Open Accounts` AS NumberofOpenAccounts,
        `Number of Credit Problems` AS NumberofCreditProblems,
        `Current Credit Balance` AS CurrentCreditBalance,
        `Maximum Open Credit` AS MaximumOpenCredit,
        `Bankruptcies` AS Bankruptcies,
        `Tax Liens` AS TaxLiens       
      
    FROM `airflowcrtn`.`credit`.`raw_invoices`
    
)
SELECT
   fi.*
FROM fct_invoices_cte fi
INNER JOIN `airflowcrtn`.`credit`.`dim_purpose` dt ON fi.PurposeID = dt.PurposeID
INNER JOIN `airflowcrtn`.`credit`.`dim_loanstatus` dp ON fi.LoanStatusID = dp.LoanStatusID
INNER JOIN `airflowcrtn`.`credit`.`dim_customer` dc ON fi.CustomerID = dc.CustomerID
    );
  
[0m12:32:50.052912 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflowcrtn&j=bq:US:ac1613c3-7c2e-4f9e-8803-b909d587713a&page=queryresults
[0m12:32:55.398075 [debug] [Thread-1 (]: Timing info for model.credit.fact_invoices (execute): 12:32:48.935947 => 12:32:55.397450
[0m12:32:55.400208 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9af62b4-ffb8-4135-a815-63a34749376c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4eef28230>]}
[0m12:32:55.401612 [info ] [Thread-1 (]: 4 of 4 OK created sql table model credit.fact_invoices ......................... [[32mCREATE TABLE (89.8k rows, 22.7 MiB processed)[0m in 6.48s]
[0m12:32:55.403247 [debug] [Thread-1 (]: Finished running node model.credit.fact_invoices
[0m12:32:55.407724 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:32:55.408384 [debug] [MainThread]: Connection 'model.credit.fact_invoices' was properly closed.
[0m12:32:55.409270 [info ] [MainThread]: 
[0m12:32:55.410478 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 19.27 seconds (19.27s).
[0m12:32:55.413732 [debug] [MainThread]: Command end result
[0m12:32:55.447346 [info ] [MainThread]: 
[0m12:32:55.448360 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:32:55.449267 [info ] [MainThread]: 
[0m12:32:55.450172 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m12:32:55.451710 [debug] [MainThread]: Command `dbt run` succeeded at 12:32:55.451406 after 22.87 seconds
[0m12:32:55.452584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd50533eed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4feb4f200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd500e41df0>]}
[0m12:32:55.453360 [debug] [MainThread]: Flushing usage events
